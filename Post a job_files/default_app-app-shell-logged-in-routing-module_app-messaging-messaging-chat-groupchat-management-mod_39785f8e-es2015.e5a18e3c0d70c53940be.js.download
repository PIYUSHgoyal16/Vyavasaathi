(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{"1YM7":function(e,t,i){"use strict";i.d(t,"a",function(){return V});var n=i("8Y7J"),a=i("riYv"),s=i("HsDr"),o=i("lDT0"),r=i("9Aot"),c=i("Rnop"),l=i("o9eT"),d=i("71eJ"),h=i("dJr3"),g=i("2UyU"),u=i("tsv4"),b=i("n0rP"),f=i("puO/"),p=i("SVse"),m=i("w13q"),C=i("DSso");function M(e,t){if(1&e){const e=n.Zb();n.Yb(0,"fl-icon",4),n.nc("click",function(){return n.Qc(e),n.rc(2).toggleSize.emit()}),n.Xb()}if(2&e){const e=n.rc(2);n.zc("flMarginRight",e.Margin.XSMALL)("name","ui-sort")("color",e.iconColor)}}function S(e,t){if(1&e&&n.Tb(0,"fl-icon",7),2&e){const e=n.rc(3);n.zc("flMarginRight",e.Margin.XSMALL)("name","ui-video-camera-v2")("color",e.iconColor)}}function x(e,t){if(1&e&&n.Tb(0,"fl-icon",8),2&e){const e=n.rc(3);n.zc("flMarginRight",e.Margin.XSMALL)("name","ui-phone-alt")("color",e.iconColor)}}function y(e,t){if(1&e&&(n.Wb(0),n.ad(1,S,1,3,"fl-icon",5),n.ad(2,x,1,3,"fl-icon",6),n.Vb()),2&e){const e=n.rc(2);n.Gb(1),n.zc("ngIf",!e.chatboxMode&&(null==e.callsEnabled?null:e.callsEnabled.video.enabled)),n.Gb(1),n.zc("ngIf",!e.chatboxMode)}}function T(e,t){if(1&e){const e=n.Zb();n.Wb(0),n.ad(1,M,1,3,"fl-icon",2),n.ad(2,y,3,2,"ng-container",0),n.Yb(3,"fl-icon",3),n.nc("click",function(t){n.Qc(e);const i=n.rc();return t.stopPropagation(),i.showChatDetails.emit()}),n.Xb(),n.Vb()}if(2&e){const e=n.rc();n.Gb(1),n.zc("ngIf",e.chatboxMode),n.Gb(1),n.zc("ngIf",null==e.callsEnabled?null:e.callsEnabled.audio.enabled),n.Gb(1),n.zc("flMarginRight",e.chatboxMode?e.Margin.XSMALL:e.Margin.NONE)("name","ui-info-v2")("color",e.iconColor)}}function I(e,t){if(1&e){const e=n.Zb();n.Yb(0,"fl-icon",9),n.nc("click",function(){return n.Qc(e),n.rc().closeChat.emit()}),n.Xb()}if(2&e){const e=n.rc();n.zc("name","ui-close")("color",e.iconColor)}}let O=(()=>{class e{constructor(){this.Margin=r.a,this.isMinimised=!1,this.isOnboarding=!1,this.closeChat=new n.n,this.showChatDetails=new n.n,this.toggleSize=new n.n}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=n.Mb({type:e,selectors:[["app-messaging-header-controls"]],inputs:{callsEnabled:"callsEnabled",chatboxMode:"chatboxMode",iconColor:"iconColor",isMinimised:"isMinimised",isOnboarding:"isOnboarding"},outputs:{closeChat:"closeChat",showChatDetails:"showChatDetails",toggleSize:"toggleSize"},decls:2,vars:2,consts:[[4,"ngIf"],["flTrackingLabel","CloseChatBox",3,"name","color","click",4,"ngIf"],["flTrackingLabel","ToggleChatBoxSize",3,"flMarginRight","name","color","click",4,"ngIf"],["flTrackingLabel","OpenSettingsChatBox",3,"flMarginRight","name","color","click"],["flTrackingLabel","ToggleChatBoxSize",3,"flMarginRight","name","color","click"],["flTrackingLabel","VideoChatUser",3,"flMarginRight","name","color",4,"ngIf"],["flTrackingLabel","CallUser",3,"flMarginRight","name","color",4,"ngIf"],["flTrackingLabel","VideoChatUser",3,"flMarginRight","name","color"],["flTrackingLabel","CallUser",3,"flMarginRight","name","color"],["flTrackingLabel","CloseChatBox",3,"name","color","click"]],template:function(e,t){1&e&&(n.ad(0,T,4,5,"ng-container",0),n.ad(1,I,1,2,"fl-icon",1)),2&e&&(n.zc("ngIf",!t.isMinimised&&!t.isOnboarding),n.Gb(1),n.zc("ngIf",t.chatboxMode))},directives:[p.q,s.d,C.a,r.b],styles:["[_nghost-%COMP%]{display:flex}"],changeDetection:0}),e})();function v(e,t){1&e&&(n.Wb(0),n.cc(1,11),n.Vb())}function A(e,t){if(1&e&&(n.Yb(0,"fl-link",14),n.nc("click",function(e){return e.stopPropagation()}),n.cd(1),n.Xb()),2&e){const e=n.rc(4);n.zc("color",e.LinkColor.INHERIT)("hoverColor",e.chatboxMode?e.LinkHoverColor.LIGHT:e.LinkHoverColor.DEFAULT)("queryParams",e.headerDetails.titleLinkParams)("link",e.headerDetails.titleLink)("size",e.TextSize.INHERIT),n.Gb(1),n.ed(" ",e.headerDetails.title," ")}}function w(e,t){if(1&e&&n.cd(0),2&e){const e=n.rc(4);n.dd(e.headerDetails.title)}}function k(e,t){if(1&e&&(n.ad(0,A,2,6,"fl-link",12),n.ad(1,w,1,1,"ng-template",null,13,n.bd)),2&e){const e=n.Nc(2),t=n.rc(3);n.zc("ngIf",null==t.headerDetails?null:t.headerDetails.titleLink)("ngIfElse",e)}}function z(e,t){if(1&e&&(n.Yb(0,"fl-text",9),n.ad(1,v,2,0,"ng-container",0),n.ad(2,k,3,2,"ng-template",null,10,n.bd),n.Xb()),2&e){const e=n.Nc(3),t=n.rc(2);n.zc("color",t.chatboxMode?t.FontColor.LIGHT:t.FontColor.DARK)("maxLines",1)("size",t.chatboxMode?t.TextSize.XSMALL:t.TextSize.SMALL)("weight",t.FontWeight.BOLD),n.Gb(1),n.zc("ngIf",t.headerDetails.titleType===t.TitleType.DEFAULT)("ngIfElse",e)}}function E(e,t){if(1&e&&(n.Yb(0,"fl-username",15),n.nc("click",function(e){return e.stopPropagation()}),n.Xb()),2&e){const e=n.rc(2);n.zc("displayName",null==e.headerDetails.user?null:e.headerDetails.user.displayName)("username",null==e.headerDetails.user?null:e.headerDetails.user.username)("link",e.headerDetails.titleLink)("queryParams",e.headerDetails.titleLinkParams)("size",e.UsernameSize.LARGE)}}function L(e,t){if(1&e&&(n.Wb(0),n.cc(1,22),n.Vb()),2&e){const e=n.rc(4);n.Gb(1),n.gc(e.headerDetails.secondaryTitle),n.dc(1)}}function _(e,t){1&e&&(n.Wb(0),n.cc(1,23),n.Vb())}function j(e,t){1&e&&(n.Wb(0),n.cc(1,24),n.Vb())}function P(e,t){if(1&e&&(n.Yb(0,"fl-link",19),n.nc("click",function(e){return e.stopPropagation()}),n.Wb(1,20),n.ad(2,L,2,1,"ng-container",21),n.ad(3,_,2,0,"ng-container",21),n.ad(4,j,2,0,"ng-container",21),n.Vb(),n.Xb()),2&e){const e=n.rc(3);n.zc("color",e.LinkColor.INHERIT)("hoverColor",e.chatboxMode?e.LinkHoverColor.LIGHT:e.LinkHoverColor.DEFAULT)("link",e.headerDetails.secondaryTitleLink)("size",e.TextSize.INHERIT),n.Gb(1),n.zc("ngSwitch",e.headerDetails.secondaryTitleType),n.Gb(1),n.zc("ngSwitchCase",e.SecondaryTitleType.CUSTOM),n.Gb(1),n.zc("ngSwitchCase",e.SecondaryTitleType.GENERIC_AGENT_TITLE),n.Gb(1),n.zc("ngSwitchCase",e.SecondaryTitleType.TEAM_CHAT)}}function R(e,t){if(1&e&&(n.Wb(0),n.cc(1,25),n.Vb()),2&e){const e=n.rc(4);n.Gb(1),n.gc(e.headerDetails.secondaryTitle),n.dc(1)}}function B(e,t){1&e&&(n.Wb(0),n.cc(1,26),n.Vb())}function $(e,t){1&e&&(n.Wb(0),n.cc(1,27),n.Vb())}function U(e,t){if(1&e&&(n.Wb(0,20),n.ad(1,R,2,1,"ng-container",21),n.ad(2,B,2,0,"ng-container",21),n.ad(3,$,2,0,"ng-container",21),n.Vb()),2&e){const e=n.rc(3);n.zc("ngSwitch",e.headerDetails.secondaryTitleType),n.Gb(1),n.zc("ngSwitchCase",e.SecondaryTitleType.CUSTOM),n.Gb(1),n.zc("ngSwitchCase",e.SecondaryTitleType.GENERIC_AGENT_TITLE),n.Gb(1),n.zc("ngSwitchCase",e.SecondaryTitleType.TEAM_CHAT)}}function G(e,t){if(1&e&&(n.Yb(0,"fl-text",16),n.ad(1,P,5,8,"fl-link",17),n.ad(2,U,4,4,"ng-template",null,18,n.bd),n.Xb()),2&e){const e=n.Nc(3),t=n.rc(2);n.zc("color",t.chatboxMode?t.FontColor.LIGHT:t.FontColor.DARK)("maxLines",1)("size",t.chatboxMode?t.TextSize.XSMALL:t.TextSize.SMALL),n.Gb(1),n.zc("ngIf",null==t.headerDetails?null:t.headerDetails.secondaryTitleLink)("ngIfElse",e)}}function N(e,t){if(1&e){const e=n.Zb();n.Wb(0),n.Yb(1,"fl-bit",2),n.Tb(2,"fl-user-avatar",3),n.Yb(3,"fl-bit",4),n.ad(4,z,4,6,"fl-text",5),n.ad(5,E,1,5,"ng-template",null,6,n.bd),n.ad(7,G,4,5,"fl-text",7),n.Xb(),n.Xb(),n.Yb(8,"app-messaging-header-controls",8),n.nc("click",function(e){return e.stopPropagation()})("showChatDetails",function(){return n.Qc(e),n.rc().showChatDetails.emit()})("closeChat",function(){return n.Qc(e),n.rc().closeChat.emit()})("toggleSize",function(){return n.Qc(e),n.rc().toggleSize.emit()}),n.Xb(),n.Vb()}if(2&e){const e=n.Nc(6),t=n.rc();n.Gb(1),n.zc("flMarginRight",t.Margin.MID),n.Gb(1),n.zc("flMarginRight",t.Margin.XSMALL)("isOnline",t.isOnline)("size",t.chatboxMode?t.AvatarSize.SMALL:t.AvatarSize.MID)("users",t.otherMembers),n.Gb(2),n.zc("ngIf",t.chatboxMode||t.headerDetails.titleType!==t.TitleType.USER)("ngIfElse",e),n.Gb(3),n.zc("ngIf",t.headerDetails.secondaryTitleType!==t.SecondaryTitleType.NONE),n.Gb(1),n.zc("callsEnabled",t.callsEnabled)("chatboxMode",t.chatboxMode)("iconColor",t.chatboxMode?t.IconColor.LIGHT:t.IconColor.INHERIT)("isMinimised",t.isMinimised)("isOnboarding",t.isOnboarding)}}function F(e,t){if(1&e){const e=n.Zb();n.Yb(0,"fl-bit",29),n.Yb(1,"fl-icon",30),n.nc("click",function(t){n.Qc(e);const i=n.rc(2);return t.stopPropagation(),i.hideChatDetails.emit()}),n.Xb(),n.Yb(2,"fl-text",31),n.cc(3,32),n.Xb(),n.Xb()}if(2&e){const e=n.rc(2);n.zc("flMarginRight",e.Margin.MID),n.Gb(1),n.zc("color",e.IconColor.LIGHT)("size",e.IconSize.SMALL)("flMarginRight",e.Margin.SMALL)("name","ui-arrow-left-alt"),n.Gb(1),n.zc("color",e.FontColor.LIGHT)("size",e.TextSize.SMALL)}}function D(e,t){if(1&e){const e=n.Zb();n.Yb(0,"fl-bit",29),n.Yb(1,"fl-icon",33),n.nc("click",function(t){n.Qc(e);const i=n.rc(2);return t.stopPropagation(),i.hideAddPeopleScreen.emit()}),n.Xb(),n.Yb(2,"fl-text",31),n.cc(3,34),n.Xb(),n.Xb()}if(2&e){const e=n.rc(2);n.zc("flMarginRight",e.Margin.MID),n.Gb(1),n.zc("color",e.IconColor.LIGHT)("size",e.IconSize.SMALL)("flMarginRight",e.Margin.SMALL)("name","ui-arrow-left-alt"),n.Gb(1),n.zc("color",e.FontColor.LIGHT)("size",e.TextSize.SMALL)}}function X(e,t){if(1&e&&(n.Wb(0,20),n.ad(1,F,4,7,"fl-bit",28),n.ad(2,D,4,7,"fl-bit",28),n.Vb()),2&e){const e=n.rc();n.zc("ngSwitch",e.currentScreen),n.Gb(1),n.zc("ngSwitchCase",e.CurrentScreen.CHAT_DETAILS),n.Gb(1),n.zc("ngSwitchCase",e.CurrentScreen.ADD_PEOPLE)}}var Y=function(e){return e[e.CUSTOM=0]="CUSTOM",e[e.DEFAULT=1]="DEFAULT",e[e.USER=2]="USER",e}({}),H=function(e){return e[e.CUSTOM=0]="CUSTOM",e[e.GENERIC_AGENT_TITLE=1]="GENERIC_AGENT_TITLE",e[e.NONE=2]="NONE",e[e.TEAM_CHAT=3]="TEAM_CHAT",e}({});let V=(()=>{class e{constructor(){this.AvatarSize=d.a,this.FontColor=c.a,this.FontWeight=l.c,this.IconColor=s.c,this.IconSize=s.e,this.LinkColor=o.a,this.LinkHoverColor=o.c,this.Margin=r.a,this.TextSize=l.f,this.UsernameSize=h.c,this.CurrentScreen=f.a,this.SecondaryTitleType=H,this.SupportTypeApi=b.SupportTypeApi,this.TitleType=Y,this.isOnboarding=!1,this.isMinimised=!1,this.closeChat=new n.n,this.hideChatDetails=new n.n,this.hideAddPeopleScreen=new n.n,this.showChatDetails=new n.n,this.toggleSize=new n.n,this.chatboxMode=!0,this.isFocused=!1}ngOnChanges(e){this.otherMembers&&this.loggedInUser&&this.membersActivityStatus&&("membersActivityStatus"in e||"loggedInUser"in e||"otherMembers"in e)&&(this.isOnline=1===this.otherMembers.length?this.membersActivityStatus.filter(e=>e.id!==this.loggedInUser.id).map(e=>e.status).includes(a.OnlineOfflineStatusApi.ONLINE):void 0),("contextBoxState"in e||"loggedInUser"in e||"otherMembers"in e||"supportAgent"in e||"team"in e||"thread"in e)&&(this.headerDetails=this.getHeaderDetails())}getHeaderDetails(){var e,t,i,n,a,s,o,r,c;if(!this.otherMembers||0===this.otherMembers.length||!this.loggedInUser)return{titleType:Y.DEFAULT,secondaryTitleType:H.NONE};const[l]=this.otherMembers;if(this.thread.threadType===u.ThreadTypeApi.GROUP||this.thread.threadType===u.ThreadTypeApi.TEAM){const a=this.otherMembers.map(e=>e.displayName).join(", ");return(null===(e=this.contextBoxState)||void 0===e?void 0:e.linkText)&&(null===(t=this.contextBoxState)||void 0===t?void 0:t.linkUrl)?{titleType:Y.CUSTOM,title:null===(i=this.contextBoxState)||void 0===i?void 0:i.linkText,titleLink:null===(n=this.contextBoxState)||void 0===n?void 0:n.linkUrl,secondaryTitleType:H.CUSTOM,secondaryTitle:a}:{titleType:Y.CUSTOM,title:a,secondaryTitleType:H.NONE}}if(this.thread.threadType===u.ThreadTypeApi.ADMIN_PREFERRED_CHAT&&this.supportAgent){if(this.loggedInUser.id===this.supportAgent.userId)return{titleType:Y.USER,title:l.displayName,titleLink:l.profileUrl,user:l,secondaryTitleType:H.CUSTOM,secondaryTitle:l.username===l.displayName?this.getSupportQueueTitle(this.supportAgent):`(${l.username})`};const e=this.otherMembers.find(e=>{var t;return(null===(t=this.supportAgent)||void 0===t?void 0:t.userId)===e.id});if(e)return{titleType:Y.USER,title:e.displayName,titleLink:e.profileUrl,user:e,secondaryTitleType:H.GENERIC_AGENT_TITLE}}return this.thread.threadType===u.ThreadTypeApi.TEAM_OFFICIAL&&this.team?{titleType:Y.CUSTOM,title:this.team.name,titleLink:`/teams/${this.team.id}`,secondaryTitleType:H.TEAM_CHAT}:{titleType:Y.USER,title:l.displayName,titleLink:l.profileUrl,user:l,titleLinkParams:this.thread.context.type===g.ContextTypeApi.PROJECT&&(null===(a=this.contextBoxState)||void 0===a?void 0:a.contextId)?{ref_project_id:this.contextBoxState.contextId}:void 0,secondaryTitleType:(null===(s=this.contextBoxState)||void 0===s?void 0:s.linkText)&&(null===(o=this.contextBoxState)||void 0===o?void 0:o.linkUrl)?H.CUSTOM:H.NONE,secondaryTitle:null===(r=this.contextBoxState)||void 0===r?void 0:r.linkText,secondaryTitleLink:null===(c=this.contextBoxState)||void 0===c?void 0:c.linkUrl}}getSupportQueueTitle(e){switch(e.type){case b.SupportTypeApi.RECRUITER:return"Recruiter Chat";case b.SupportTypeApi.GENERAL:return"General Chat";case b.SupportTypeApi.LOCAL:return"Local Jobs";default:return e.type.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=n.Mb({type:e,selectors:[["app-messaging-header"]],hostVars:4,hostBindings:function(e,t){2&e&&n.Kb("ChatboxMode",t.chatboxMode)("IsFocused",t.isFocused)},inputs:{callsEnabled:"callsEnabled",contextBoxState:"contextBoxState",currentScreen:"currentScreen",isOnboarding:"isOnboarding",isMinimised:"isMinimised",loggedInUser:"loggedInUser",membersActivityStatus:"membersActivityStatus",otherMembers:"otherMembers",supportAgent:"supportAgent",team:"team",thread:"thread",chatboxMode:"chatboxMode",isFocused:"isFocused"},outputs:{closeChat:"closeChat",hideChatDetails:"hideChatDetails",hideAddPeopleScreen:"hideAddPeopleScreen",showChatDetails:"showChatDetails",toggleSize:"toggleSize"},features:[n.Eb],decls:3,vars:2,consts:function(){let e,t,i,n,a,s,o,r,c;return e=" Private Chat ",t=" " + "\ufffd0\ufffd" + " ",i=" Freelancer Staff ",n=" Official Group Chat ",a=" " + "\ufffd0\ufffd" + " ",s=" Freelancer Staff ",o=" Official Group Chat ",r=" Chat Details ",c=" Add People ",[[4,"ngIf","ngIfElse"],["alternateHeader",""],[1,"Header-details",3,"flMarginRight"],[3,"flMarginRight","isOnline","size","users"],[1,"Header-details-text"],[3,"color","maxLines","size","weight",4,"ngIf","ngIfElse"],["username",""],[3,"color","maxLines","size",4,"ngIf"],[3,"callsEnabled","chatboxMode","iconColor","isMinimised","isOnboarding","click","showChatDetails","closeChat","toggleSize"],[3,"color","maxLines","size","weight"],["customTitle",""],e,["flTrackingLabel","ChatboxHeaderTitle",3,"color","hoverColor","queryParams","link","size","click",4,"ngIf","ngIfElse"],["plainTitle",""],["flTrackingLabel","ChatboxHeaderTitle",3,"color","hoverColor","queryParams","link","size","click"],["flTrackingLabel","ChatboxHeaderTitle",3,"displayName","username","link","queryParams","size","click"],[3,"color","maxLines","size"],["flTrackingLabel","ChatboxHeaderSecondaryTitle",3,"color","hoverColor","link","size","click",4,"ngIf","ngIfElse"],["plainSecondaryTitle",""],["flTrackingLabel","ChatboxHeaderSecondaryTitle",3,"color","hoverColor","link","size","click"],[3,"ngSwitch"],[4,"ngSwitchCase"],t,i,n,a,s,o,["class","Header-details Header-chatDetails",3,"flMarginRight",4,"ngSwitchCase"],[1,"Header-details","Header-chatDetails",3,"flMarginRight"],["flTrackingLabel","ChatDetailsHeaderBackCta",3,"color","size","flMarginRight","name","click"],[3,"color","size"],r,["flTrackingLabel","AddPeopleHeaderBackCta",3,"color","size","flMarginRight","name","click"],c]},template:function(e,t){if(1&e&&(n.ad(0,N,9,13,"ng-container",0),n.ad(1,X,3,3,"ng-template",null,1,n.bd)),2&e){const e=n.Nc(2);n.zc("ngIf",!t.chatboxMode||t.currentScreen===t.CurrentScreen.THREAD_VIEW||t.isMinimised)("ngIfElse",e)}},directives:[p.q,m.a,r.b,d.b,O,l.e,o.b,C.a,h.b,p.s,p.t,s.d],styles:["[_nghost-%COMP%]{align-items:center;cursor:pointer;display:flex;justify-content:space-between;padding:16px 24px}.ChatboxMode[_nghost-%COMP%]{background-color:#4d525b;height:56px;padding:8px 16px;transition:background-color .3s linear}.ChatboxMode.IsFocused[_nghost-%COMP%]{background-color:#0e1724}.Header-details[_ngcontent-%COMP%]{align-items:center;display:flex;overflow:hidden}.Header-details-text[_ngcontent-%COMP%]{overflow:hidden}.Header-chatDetails[_ngcontent-%COMP%]{padding:16px 0}"],changeDetection:0}),e})()},"23iI":function(e,t,i){"use strict";i.d(t,"a",function(){return ce});var n=i("8Y7J"),a=i("HsDr"),s=i("lDT0"),o=i("9Aot"),r=i("Rnop"),c=i("o9eT"),l=i("tsv4"),d=i("eCtd"),h=i("iInd"),g=i("HLWz"),u=i("KUXl"),b=i("SVse"),f=i("71eJ"),p=i("dJr3"),m=i("w13q"),C=i("DSso");const M=function(e){return{"ChatMembers-username--fullInbox":e}};function S(e,t){if(1&e&&(n.Yb(0,"fl-bit",5),n.Tb(1,"fl-username",6),n.Yb(2,"fl-text",7),n.cc(3,8),n.Xb(),n.Xb()),2&e){const e=n.rc();n.Gb(1),n.zc("ngClass",n.Ec(6,M,!e.chatboxMode))("displayName",e.otherMembers[0].displayName)("flMarginBottom",e.chatboxMode?e.Margin.NONE:e.Margin.XXSMALL)("username",e.otherMembers[0].username)("size",e.UsernameSize.LARGE),n.Gb(1),n.zc("color",e.FontColor.MID)}}function x(e,t){if(1&e&&(n.Yb(0,"fl-bit",9),n.Yb(1,"fl-text",10),n.cc(2,11),n.Xb(),n.Yb(3,"fl-text",7),n.cc(4,12),n.Xb(),n.Xb()),2&e){const e=n.rc();n.zc("flMarginRight",e.Margin.SMALL),n.Gb(1),n.zc("flMarginBottom",e.chatboxMode?e.Margin.NONE:e.Margin.XXSMALL)("size",e.TextSize.SMALL)("weight",e.FontWeight.BOLD),n.Gb(1),n.gc(e.otherMembers[0].displayName)(e.otherMembers.length-1),n.dc(2),n.Gb(1),n.zc("color",e.FontColor.MID),n.Gb(1),n.gc(e.otherMembers.length),n.dc(4)}}function y(e,t){if(1&e){const e=n.Zb();n.Yb(0,"fl-link",13),n.nc("click",function(){return n.Qc(e),n.rc().seeMembers()}),n.cc(1,14),n.Xb()}if(2&e){const e=n.rc();n.zc("size",e.TextSize.XXSMALL)}}const T=function(e){return{"ChatMembers--fullInbox":e}},I=function(e){return{"ChatMembers-avatar--fullInbox":e}};let O=(()=>{class e{constructor(){this.AvatarSize=f.a,this.FontColor=r.a,this.FontWeight=c.c,this.IconColor=a.c,this.LinkColor=s.a,this.LinkWeight=s.f,this.Margin=o.a,this.TextSize=c.f,this.UsernameSize=p.c,this.isGroupChat=!1}ngOnChanges(e){e.otherMembers&&this.otherMembers&&(this.isGroupChat=this.otherMembers.length>1)}seeMembers(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=n.Mb({type:e,selectors:[["app-messaging-chat-details-members-summary"]],inputs:{chatboxMode:"chatboxMode",otherMembers:"otherMembers"},features:[n.Eb],decls:6,vars:14,consts:function(){let e,t,i,n;return e=" Active 3 hours ago ",t=" " + "\ufffd0\ufffd" + " + " + "\ufffd1\ufffd" + " More ",i=" " + "\ufffd0\ufffd" + " members ",n=" SEE MEMBERS ",[[1,"ChatMembers",3,"ngClass"],[3,"ngClass","flMarginBottom","flMarginRight","isOnline","size","users"],["class","ChatMembers-title",4,"ngIf","ngIfElse"],["groupChatTitle",""],["class","ChatMembers-link","flTrackingLabel","SeeMembers",3,"size","click",4,"ngIf"],[1,"ChatMembers-title"],[3,"ngClass","displayName","flMarginBottom","username","size"],[3,"color"],e,[1,"ChatMembers-title",3,"flMarginRight"],[3,"flMarginBottom","size","weight"],t,i,["flTrackingLabel","SeeMembers",1,"ChatMembers-link",3,"size","click"],n]},template:function(e,t){if(1&e&&(n.Yb(0,"fl-bit",0),n.Tb(1,"fl-user-avatar",1),n.ad(2,S,4,8,"fl-bit",2),n.Xb(),n.ad(3,x,5,8,"ng-template",null,3,n.bd),n.ad(5,y,2,1,"fl-link",4)),2&e){const e=n.Nc(4);n.zc("ngClass",n.Ec(10,T,!t.chatboxMode)),n.Gb(1),n.zc("ngClass",n.Ec(12,I,!t.chatboxMode))("flMarginBottom",t.chatboxMode?t.Margin.NONE:t.Margin.SMALL)("flMarginRight",t.chatboxMode?t.Margin.SMALL:t.Margin.NONE)("isOnline",!0)("size",t.chatboxMode?t.AvatarSize.MID:t.AvatarSize.XLARGE)("users",t.otherMembers),n.Gb(1),n.zc("ngIf",!t.isGroupChat)("ngIfElse",e),n.Gb(3),n.zc("ngIf",t.isGroupChat&&t.chatboxMode)}},directives:[m.a,b.o,f.b,o.b,b.q,p.b,c.e,s.b,C.a],styles:["[_nghost-%COMP%]{padding:16px 8px}.ChatMembers[_ngcontent-%COMP%], [_nghost-%COMP%]{display:flex}.ChatMembers-title[_ngcontent-%COMP%]{display:flex;flex:1;flex-direction:column;justify-content:space-between}.ChatMembers-link[_ngcontent-%COMP%], .ChatMembers-title[_ngcontent-%COMP%]{word-break:break-word;word-wrap:break-word}.ChatMembers-link[_ngcontent-%COMP%]{margin-top:6px;max-width:30%}.ChatMembers-avatar--fullInbox[_ngcontent-%COMP%], .ChatMembers-username--fullInbox[_ngcontent-%COMP%]{justify-content:center}.ChatMembers--fullInbox[_ngcontent-%COMP%]{align-items:center;flex-direction:column;justify-content:center;text-align:center;width:100%}"],changeDetection:0}),e})();var v=i("SMHo"),A=i("tbiQ"),w=i("eiII"),k=i("ni7p");function z(e,t){if(1&e){const e=n.Zb();n.Yb(0,"fl-link",10),n.nc("click",function(t){return n.Qc(e),n.rc(3).handleVideoCallClick(t)}),n.ic(1,11),n.Yb(2,"fl-bit",8),n.Tb(3,"fl-icon",9),n.Xb(),n.fc(),n.Xb()}if(2&e){const e=n.rc(3);n.Gb(3),n.zc("name","ui-video-camera-v2")("color",e.IconColor.PRIMARY)("flMarginBottom",e.chatboxMode?e.Margin.NONE:e.Margin.XSMALL)("flMarginRight",e.chatboxMode?e.Margin.XSMALL:e.Margin.NONE)}}function E(e,t){if(1&e){const e=n.Zb();n.Wb(0),n.Yb(1,"fl-col",4),n.ad(2,z,4,4,"fl-link",5),n.Xb(),n.Yb(3,"fl-col",4),n.Yb(4,"fl-link",6),n.nc("click",function(t){n.Qc(e);const i=n.rc(2);return i.handleAudioCallClick(t,null==i.callsEnabled?null:i.callsEnabled.audio.recorded)}),n.ic(5,7),n.Yb(6,"fl-bit",8),n.Tb(7,"fl-icon",9),n.Xb(),n.fc(),n.Xb(),n.Xb(),n.Vb()}if(2&e){const e=n.rc(2);n.Gb(1),n.zc("col",4),n.Gb(1),n.zc("ngIf",null==e.callsEnabled?null:e.callsEnabled.video.enabled),n.Gb(1),n.zc("col",4),n.Gb(4),n.zc("name","ui-phone")("color",e.IconColor.PRIMARY)("flMarginBottom",e.chatboxMode?e.Margin.NONE:e.Margin.XSMALL)("flMarginRight",e.chatboxMode?e.Margin.XSMALL:e.Margin.NONE)}}const L=function(e){return{ChatActionContainer:e}};function _(e,t){if(1&e){const e=n.Zb();n.Yb(0,"fl-col",12),n.Yb(1,"fl-link",13),n.nc("click",function(){return n.Qc(e),n.rc(2).showAddPeopleScreen.emit()}),n.ic(2,14),n.Yb(3,"fl-bit",8),n.Tb(4,"fl-icon",9),n.Xb(),n.fc(),n.Xb(),n.Xb()}if(2&e){const e=n.rc(2);n.zc("col",null!=e.callsEnabled&&e.callsEnabled.audio.enabled?4:12)("ngClass",n.Ec(6,L,!e.chatboxMode&&(null==e.callsEnabled?null:e.callsEnabled.audio.enabled))),n.Gb(4),n.zc("name","ui-plus-thin")("color",e.IconColor.PRIMARY)("flMarginBottom",e.chatboxMode?e.Margin.NONE:e.Margin.XSMALL)("flMarginRight",e.chatboxMode?e.Margin.XSMALL:e.Margin.NONE)}}const j=function(e){return{"ChatAction--fullInbox":e}};function P(e,t){if(1&e&&(n.Yb(0,"fl-grid",1),n.ad(1,E,8,7,"ng-container",2),n.ad(2,_,5,8,"fl-col",3),n.Xb()),2&e){const e=n.rc();n.zc("ngClass",n.Ec(4,j,!e.chatboxMode))("flMarginBottom",e.Margin.SMALL),n.Gb(1),n.zc("ngIf",null==e.callsEnabled?null:e.callsEnabled.audio.enabled),n.Gb(1),n.zc("ngIf",e.showAddPeopleCta)}}let R=(()=>{class e{constructor(e){this.videochat=e,this.IconColor=a.c,this.Margin=o.a,this.makingCall=new n.n,this.showAddPeopleScreen=new n.n}handleAudioCallClick(e,t){e.stopPropagation(),this.startCall(A.a.AUDIO,t),this.makingCall.emit(!0)}handleVideoCallClick(e){e.stopPropagation(),this.startCall(A.a.VIDEO),this.makingCall.emit(!0)}startCall(e,t=!1){this.videochat.openCallWindow({action:e,threadId:this.thread.id,accepting:!1,recorded:t})}}return e.\u0275fac=function(t){return new(t||e)(n.Sb(A.b))},e.\u0275cmp=n.Mb({type:e,selectors:[["app-messaging-chat-details-actions"]],inputs:{callsEnabled:"callsEnabled",showAddPeopleCta:"showAddPeopleCta",chatboxMode:"chatboxMode",thread:"thread"},outputs:{makingCall:"makingCall",showAddPeopleScreen:"showAddPeopleScreen"},decls:1,vars:1,consts:function(){let e,t,i;return e="" + "\ufffd#6\ufffd" + "" + "\ufffd#7\ufffd" + "" + "\ufffd/#7\ufffd" + " Call " + "\ufffd/#6\ufffd" + "",t="" + "\ufffd#2\ufffd" + "" + "\ufffd#3\ufffd" + "" + "\ufffd/#3\ufffd" + " Video " + "\ufffd/#2\ufffd" + "",i="" + "\ufffd#3\ufffd" + "" + "\ufffd#4\ufffd" + "" + "\ufffd/#4\ufffd" + " Add People " + "\ufffd/#3\ufffd" + "",[["class","ChatAction",3,"ngClass","flMarginBottom",4,"ngIf"],[1,"ChatAction",3,"ngClass","flMarginBottom"],[4,"ngIf"],[3,"col","ngClass",4,"ngIf"],[1,"ChatActionContainer",3,"col"],["flTrackingLabel","VideoCallCta",3,"click",4,"ngIf"],["flTrackingLabel","AudioCallCta",3,"click"],e,[1,"ChatActionLink"],[3,"name","color","flMarginBottom","flMarginRight"],["flTrackingLabel","VideoCallCta",3,"click"],t,[3,"col","ngClass"],["flTrackingLabel","AddPeopleCta",3,"click"],i]},template:function(e,t){1&e&&n.ad(0,P,3,6,"fl-grid",0),2&e&&n.zc("ngIf",(null==t.callsEnabled?null:t.callsEnabled.audio.enabled)||t.showAddPeopleCta)},directives:[b.q,w.a,b.o,o.b,k.a,s.b,C.a,m.a,a.d],styles:["[_nghost-%COMP%]{display:block}.ChatAction[_ngcontent-%COMP%]{padding:0 8px}.ChatAction--fullInbox[_ngcontent-%COMP%]{padding:0 24px}.ChatAction--fullInbox[_ngcontent-%COMP%]   .ChatActionLink[_ngcontent-%COMP%]{flex-direction:column;text-align:center}.ChatAction--fullInbox[_ngcontent-%COMP%]   .ChatActionContainer[_ngcontent-%COMP%]{text-align:center}.ChatActionLink[_ngcontent-%COMP%]{word-break:break-word;word-wrap:break-word;align-items:center;display:flex}"],changeDetection:0}),e})();var B=i("wZbG"),$=i("s7LF"),U=i("3cJa"),G=i("a293");function N(e,t){if(1&e&&(n.Yb(0,"fl-generic-error",13),n.cc(1,14),n.Xb()),2&e){const e=n.rc();n.zc("error",e.archiveError)}}function F(e,t){if(1&e&&(n.Yb(0,"fl-generic-error",13),n.cc(1,15),n.Xb()),2&e){const e=n.rc();n.zc("error",e.muteError)}}function D(e,t){if(1&e&&(n.Yb(0,"fl-generic-error",22),n.cc(1,23),n.Xb()),2&e){const e=n.rc(2);n.zc("error",e.blockError)}}function X(e,t){if(1&e&&(n.Wb(0),n.Tb(1,"fl-hr"),n.Yb(2,"fl-bit",0),n.Yb(3,"fl-bit",1),n.Yb(4,"fl-text",16),n.cc(5,17),n.Xb(),n.Yb(6,"fl-text",4),n.cc(7,18),n.Xb(),n.Xb(),n.Tb(8,"fl-toggle",19),n.Xb(),n.Yb(9,"fl-bit",20),n.ad(10,D,2,1,"fl-generic-error",21),n.Xb(),n.Vb()),2&e){const e=n.rc();n.Gb(4),n.zc("weight",e.FontWeight.BOLD)("color",e.FontColor.ERROR),n.Gb(2),n.zc("color",e.FontColor.MID),n.Gb(2),n.zc("busy",e.isBlockToggleBusy)("control",e.blockControl)("size",e.ToggleSize.MID),n.Gb(2),n.zc("ngIf",!!e.blockError)}}let Y=(()=>{class e{constructor(){this.FontColor=r.a,this.FontWeight=c.c,this.Margin=o.a,this.ToggleSize=U.b,this.archiveControl=new $.f,this.muteControl=new $.f,this.blockControl=new $.f,this.toggleArchive=new n.n,this.toggleMute=new n.n,this.toggleBlock=new n.n}ngOnInit(){this.archiveControl.setValue(this.archived),this.blockControl.setValue(this.blocked),this.muteControl.setValue(this.muted),this.archiveControlSubscription$=this.archiveControl.valueChanges.subscribe(e=>{e!==this.archived&&this.toggleArchive.emit(e)}),this.blockControlSubscription$=this.blockControl.valueChanges.subscribe(e=>{e!==this.blocked&&this.toggleBlock.emit(e)}),this.muteControlSubscription$=this.muteControl.valueChanges.subscribe(e=>{e!==this.muted&&this.toggleMute.emit(e)})}ngOnDestroy(){var e,t,i;null===(e=this.archiveControlSubscription$)||void 0===e||e.unsubscribe(),null===(t=this.blockControlSubscription$)||void 0===t||t.unsubscribe(),null===(i=this.muteControlSubscription$)||void 0===i||i.unsubscribe()}ngOnChanges(e){(e.archived||e.archiveError)&&this.archiveControl.value!==this.archived&&this.archiveControl.setValue(this.archived),(e.muted||e.muteError)&&this.muteControl.value!==this.muted&&this.muteControl.setValue(this.muted),(e.blocked||e.blockError)&&this.blockControl.value!==this.blocked&&this.blockControl.setValue(this.blocked)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=n.Mb({type:e,selectors:[["app-messaging-chat-details-settings"]],inputs:{archived:"archived",blocked:"blocked",muted:"muted",isBlockSettingEnabled:"isBlockSettingEnabled",isArchiveToggleBusy:"isArchiveToggleBusy",isBlockToggleBusy:"isBlockToggleBusy",isMuteToggleBusy:"isMuteToggleBusy",archiveError:"archiveError",blockError:"blockError",muteError:"muteError"},outputs:{toggleArchive:"toggleArchive",toggleMute:"toggleMute",toggleBlock:"toggleBlock"},features:[n.Eb],decls:20,vars:15,consts:function(){let e,t,i,n,a,s,o,r,c;return e=" Archive ",t=" Hide this chat from your active list ",i=" Mute ",n=" Turn off notifications from this chat ",a=" Error archiving this chat. ",s=" Error muting this chat. ",o=" Block ",r=" Restrict members from sending messages ",c=" Error blocking this chat. ",[[1,"ChatSettings-item"],[1,"ChatSettings-item-title"],[3,"weight"],e,[3,"color"],t,["flTrackingLabel","MessagingArchiveThread",1,"ChatSettings-toggle",3,"busy","size","control"],[1,"ChatSettings-error",3,"flMarginBottom"],[3,"error",4,"ngIf"],i,n,["flTrackingLabel","MessagingMuteThread",1,"ChatSettings-toggle",3,"busy","size","control"],[4,"ngIf"],[3,"error"],a,s,[3,"weight","color"],o,r,["flTrackingLabel","MessagingBlockThread",1,"ChatSettings-toggle",3,"busy","control","size"],[1,"ChatSettings-error"],["class","ChatSettings-error-message",3,"error",4,"ngIf"],[1,"ChatSettings-error-message",3,"error"],c]},template:function(e,t){1&e&&(n.Yb(0,"fl-bit",0),n.Yb(1,"fl-bit",1),n.Yb(2,"fl-text",2),n.cc(3,3),n.Xb(),n.Yb(4,"fl-text",4),n.cc(5,5),n.Xb(),n.Xb(),n.Tb(6,"fl-toggle",6),n.Xb(),n.Yb(7,"fl-bit",7),n.ad(8,N,2,1,"fl-generic-error",8),n.Xb(),n.Tb(9,"fl-hr"),n.Yb(10,"fl-bit",0),n.Yb(11,"fl-bit",1),n.Yb(12,"fl-text",2),n.cc(13,9),n.Xb(),n.Yb(14,"fl-text",4),n.cc(15,10),n.Xb(),n.Xb(),n.Tb(16,"fl-toggle",11),n.Xb(),n.Yb(17,"fl-bit",7),n.ad(18,F,2,1,"fl-generic-error",8),n.Xb(),n.ad(19,X,11,7,"ng-container",12)),2&e&&(n.Gb(2),n.zc("weight",t.FontWeight.BOLD),n.Gb(2),n.zc("color",t.FontColor.MID),n.Gb(2),n.zc("busy",t.isArchiveToggleBusy)("size",t.ToggleSize.MID)("control",t.archiveControl),n.Gb(1),n.zc("flMarginBottom",t.Margin.SMALL),n.Gb(1),n.zc("ngIf",!!t.archiveError),n.Gb(4),n.zc("weight",t.FontWeight.BOLD),n.Gb(2),n.zc("color",t.FontColor.MID),n.Gb(2),n.zc("busy",t.isMuteToggleBusy)("size",t.ToggleSize.MID)("control",t.muteControl),n.Gb(1),n.zc("flMarginBottom",t.Margin.SMALL),n.Gb(1),n.zc("ngIf",!!t.muteError),n.Gb(1),n.zc("ngIf",t.isBlockSettingEnabled))},directives:[m.a,c.e,U.a,C.a,o.b,b.q,B.a,G.b],styles:["[_nghost-%COMP%]{display:block}.ChatSettings-item[_ngcontent-%COMP%]{display:flex;padding-left:8px;padding-top:16px}.ChatSettings-item-title[_ngcontent-%COMP%]{display:flex;flex:1;flex-direction:column}.ChatSettings-toggle[_ngcontent-%COMP%]{align-items:center;display:flex;justify-content:center}.ChatSettings-error[_ngcontent-%COMP%]{padding-left:8px}"],changeDetection:0}),e})();var H=i("B23V"),V=i("dO68"),Q=i("MmDv"),W=i("pZRy"),q=i("g6qU");function K(e,t){if(1&e&&(n.Yb(0,"fl-bit",9),n.Yb(1,"app-messaging-context-button",10),n.nc("click",function(e){return e.stopPropagation()}),n.Xb(),n.Xb()),2&e){const e=n.rc();n.Gb(1),n.zc("contextBoxState",e.contextBoxState)}}let Z=(()=>{class e{constructor(e){this.activatedRoute=e,this.ButtonColor=H.a,this.ButtonSize=V.a,this.LinkWeight=s.f,this.FontColor=r.a,this.IconColor=a.c,this.Margin=o.a,this.TextSize=c.f,this.NON_CTA_CONTEXT_BOX_STATE_NAME=Q.a}ngOnChanges(e){var t;if("contextBoxState"in e){const e=this.activatedRoute.snapshot.queryParams;this.linkQueryParams=Object.assign(Object.assign({},null===(t=this.contextBoxState)||void 0===t?void 0:t.linkQueryParams),e)}}}return e.\u0275fac=function(t){return new(t||e)(n.Sb(h.a))},e.\u0275cmp=n.Mb({type:e,selectors:[["app-messaging-chat-details-context"]],inputs:{contextBoxState:"contextBoxState",thread:"thread"},features:[n.Eb],decls:9,vars:12,consts:function(){let e,t;return e=" " + "\ufffd0\ufffd" + " ",t=" Posted " + "\ufffd#7\ufffd" + "" + "\ufffd/#7\ufffd" + "",[[1,"ChatContext-preview",3,"flMarginRight"],[3,"color","name"],[1,"ChatContext-title",3,"flMarginRight"],["flTrackingLabel","Context link",3,"link","queryParams","weight","click"],e,[3,"color","size"],t,[3,"date"],["class","ChatContext-cta-container",4,"ngIf"],[1,"ChatContext-cta-container"],[3,"contextBoxState","click"]]},template:function(e,t){1&e&&(n.Yb(0,"fl-bit",0),n.Tb(1,"fl-icon",1),n.Xb(),n.Yb(2,"fl-bit",2),n.Yb(3,"fl-link",3),n.nc("click",function(e){return e.stopPropagation()}),n.cc(4,4),n.Xb(),n.Yb(5,"fl-text",5),n.ic(6,6),n.Tb(7,"fl-relative-time",7),n.fc(),n.Xb(),n.Xb(),n.ad(8,K,2,1,"fl-bit",8)),2&e&&(n.zc("flMarginRight",t.Margin.SMALL),n.Gb(1),n.zc("color",t.IconColor.LIGHT)("name","ui-suitcase-outline"),n.Gb(1),n.zc("flMarginRight",t.Margin.SMALL),n.Gb(1),n.zc("link",null==t.contextBoxState?null:t.contextBoxState.linkUrl)("queryParams",t.linkQueryParams)("weight",t.LinkWeight.BOLD),n.Gb(1),n.gc(null==t.contextBoxState?null:t.contextBoxState.linkText),n.dc(4),n.Gb(1),n.zc("color",t.FontColor.MID)("size",t.TextSize.XXSMALL),n.Gb(2),n.zc("date",null==t.contextBoxState?null:t.contextBoxState.timeSubmitted),n.Gb(1),n.zc("ngIf",!t.NON_CTA_CONTEXT_BOX_STATE_NAME.includes(null==t.contextBoxState?null:t.contextBoxState.name)))},directives:[m.a,o.b,a.d,s.b,C.a,c.e,W.b,b.q,q.a],styles:["[_nghost-%COMP%]{display:flex;padding:16px 8px}.ChatContext-preview[_ngcontent-%COMP%]{align-items:center;background-color:#007fed;display:flex;height:46px;justify-content:center;width:46px}.ChatContext-title[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;display:flex;flex:1 1 0%;flex-direction:column;justify-content:center}.ChatContext-cta-container[_ngcontent-%COMP%]{word-break:break-word;word-wrap:break-word;display:flex;max-width:25%;padding:4px 0}.ChatContext-cta-button[_ngcontent-%COMP%]{align-items:center;display:flex}"],changeDetection:0}),e})();var J=i("fYbj"),ee=i("p8b5");function te(e,t){if(1&e&&n.Tb(0,"app-messaging-contact-item",8),2&e){const e=t.$implicit,i=n.rc();n.zc("flMarginBottom",i.Margin.MID)("showCtas",!1)("user",e)}}let ie=(()=>{class e{constructor(){this.FontColor=r.a,this.Margin=o.a,this.TextSize=c.f,this.TextTransform=c.g,this.trackById=J.m}seeMembers(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=n.Mb({type:e,selectors:[["app-messaging-chat-details-group-members"]],inputs:{loggedInUser:"loggedInUser",otherMembers:"otherMembers"},decls:9,vars:15,consts:function(){let e,t;return e=" Group Members ",t=" SEE ALL ",[[1,"MessagingGroupMembers-header"],[3,"color","size","textTransform"],e,["flTrackingLabel","MessageGroupMembersSeeAll",3,"size","click"],t,[3,"flMarginBottom"],[1,"MessagingGroupMembers-content",3,"flMarginBottom","showCtas","isLoggedInUser","user"],["class","MessagingGroupMembers-content",3,"flMarginBottom","showCtas","user",4,"ngFor","ngForOf","ngForTrackBy"],[1,"MessagingGroupMembers-content",3,"flMarginBottom","showCtas","user"]]},template:function(e,t){1&e&&(n.Yb(0,"fl-bit",0),n.Yb(1,"fl-text",1),n.cc(2,2),n.Xb(),n.Yb(3,"fl-link",3),n.nc("click",function(){return t.seeMembers()}),n.cc(4,4),n.Xb(),n.Xb(),n.Tb(5,"fl-hr",5),n.Tb(6,"app-messaging-contact-item",6),n.ad(7,te,1,3,"app-messaging-contact-item",7),n.sc(8,"slice")),2&e&&(n.Gb(1),n.zc("color",t.FontColor.MID)("size",t.TextSize.XXXSMALL)("textTransform",t.TextTransform.UPPERCASE),n.Gb(2),n.zc("size",t.TextSize.XXXSMALL),n.Gb(2),n.zc("flMarginBottom",t.Margin.MID),n.Gb(1),n.zc("flMarginBottom",t.Margin.MID)("showCtas",!1)("isLoggedInUser",!0)("user",t.loggedInUser),n.Gb(1),n.zc("ngForOf",n.vc(8,11,t.otherMembers,0,2))("ngForTrackBy",t.trackById))},directives:[m.a,c.e,s.b,C.a,B.a,o.b,ee.a,b.p],pipes:[b.z],styles:["[_nghost-%COMP%]{display:block}.MessagingGroupMembers-header[_ngcontent-%COMP%]{align-items:center;display:flex;justify-content:space-between;padding:16px 8px}.MessagingGroupMembers-content[_ngcontent-%COMP%]{padding:0 8px}"],changeDetection:0}),e})();var ne=i("al+g");function ae(e,t){if(1&e){const e=n.Zb();n.Wb(0),n.Yb(1,"fl-bit",7),n.Tb(2,"fl-icon",8),n.Yb(3,"fl-link",9),n.nc("click",function(t){return n.Qc(e),n.rc().handleRedirectToInbox(t)}),n.cc(4,10),n.Xb(),n.Xb(),n.Tb(5,"fl-hr"),n.Vb()}if(2&e){const e=n.rc();n.Gb(1),n.zc("flMarginBottom",e.Margin.SMALL),n.Gb(1),n.zc("name","ui-chat")("color",e.IconColor.PRIMARY)("flMarginRight",e.Margin.XXSMALL),n.Gb(1),n.zc("color",e.LinkColor.INHERIT)("weight",e.LinkWeight.BOLD)}}function se(e,t){if(1&e&&(n.Wb(0),n.Tb(1,"fl-hr"),n.Tb(2,"app-messaging-chat-details-context",11),n.Vb()),2&e){const e=n.rc();n.Gb(2),n.zc("contextBoxState",e.contextBoxState)("thread",e.thread)}}function oe(e,t){if(1&e&&(n.Wb(0),n.Tb(1,"fl-hr"),n.Tb(2,"app-messaging-chat-details-group-members",12),n.Vb()),2&e){const e=n.rc();n.Gb(2),n.zc("loggedInUser",e.loggedInUser)("otherMembers",e.otherMembers)}}const re=function(){return["group","team","team_official"]};let ce=(()=>{class e{constructor(e,t){this.datastore=e,this.router=t,this.FolderApi=l.FolderApi,this.FontColor=r.a,this.FontWeight=c.c,this.IconColor=a.c,this.LinkColor=s.a,this.LinkWeight=s.f,this.Margin=o.a,this.TextSize=c.f,this.chatboxMode=!0,this.makingCall=new n.n,this.showAddPeopleScreen=new n.n}ngOnChanges(e){("thread"in e||"isLoggedInUserThreadOwner"in e||"isLoggedInUserSupportAgent"in e||"supportAgent"in e||"team"in e||"threadBidders"in e||"threadCollaborators"in e||"threadContacts"in e)&&(this.showAddPeopleCta=this.canManageChatMembers())}handleRedirectToInbox(e){if(e.stopPropagation(),this.thread.isFake){const{threadType:e,members:t,context:i}=this.thread;return this.router.navigate(["/messages/new"],{queryParams:{thread_type:e,context_type:i.type,context_id:i.type!==l.ContextTypeApi.NONE?i.id:void 0,members:t}})}this.router.navigate(["/messages/thread",this.thread.id])}handleToggleArchive(e){if(!this.thread.isFake){const t=e?l.FolderApi.ARCHIVED:l.FolderApi.INBOX;this.archiveResponse$=this.datastore.collection("threads").update(this.thread.id,{folder:t}).then(e=>(this.archiveError="error"===e.status?e:void 0,e))}}handleToggleBlock(e){this.thread.isFake||(this.blockResponse$=this.datastore.collection("threads").update(this.thread.id,{isBlocked:e}).then(e=>(this.blockError="error"===e.status?e:void 0,e)))}handleToggleMute(e){this.thread.isFake||(this.muteResponse$=this.datastore.collection("threads").update(this.thread.id,{isMuted:e}).then(e=>(this.muteError="error"===e.status?e:void 0,e)))}canManageChatMembers(){const e=[...this.threadBidders||[],...this.threadCollaborators||[],...this.threadContacts||[]].length>0;return this.thread.context.type!==l.ContextTypeApi.NONE&&(!!(this.thread.context.type===l.ContextTypeApi.TEAM&&this.thread.threadType!==l.ThreadTypeApi.TEAM_OFFICIAL||this.thread.threadType===l.ThreadTypeApi.TEAM&&this.team)||this.thread.threadType!==l.ThreadTypeApi.TEAM_OFFICIAL&&(this.isLoggedInUserThreadOwner&&e||this.isLoggedInUserSupportAgent))}}return e.\u0275fac=function(t){return new(t||e)(n.Sb(d.a),n.Sb(h.e))},e.\u0275cmp=n.Mb({type:e,selectors:[["app-messaging-chat-details"]],inputs:{callsEnabled:"callsEnabled",chatboxMode:"chatboxMode",contextBoxState:"contextBoxState",isLoggedInUserSupportAgent:"isLoggedInUserSupportAgent",isLoggedInUserThreadOwner:"isLoggedInUserThreadOwner",loggedInUser:"loggedInUser",otherMembers:"otherMembers",supportAgent:"supportAgent",team:"team",thread:"thread",threadBidders:"threadBidders",threadCollaborators:"threadCollaborators",threadContacts:"threadContacts"},outputs:{makingCall:"makingCall",showAddPeopleScreen:"showAddPeopleScreen"},features:[n.Eb],decls:13,vars:37,consts:function(){let e;return e=" Open this chat in your inbox ",[["flTrackingSection","MessagingChatDetails",1,"MessagingChatDetails"],[4,"ngIf"],[3,"chatboxMode","flHideMobile","otherMembers"],[3,"chatboxMode","flShowMobile","otherMembers"],[3,"flHideMobile","callsEnabled","chatboxMode","showAddPeopleCta","thread","makingCall","showAddPeopleScreen"],[3,"flMarginBottom","flShowMobile","callsEnabled","chatboxMode","showAddPeopleCta","thread","makingCall","showAddPeopleScreen"],[3,"archiveError","blockError","archived","blocked","muted","isArchiveToggleBusy","isBlockToggleBusy","isMuteToggleBusy","isBlockSettingEnabled","muteError","toggleArchive","toggleBlock","toggleMute"],[1,"OpenChatInInbox",3,"flMarginBottom"],[1,"OpenChatInInbox-icon",3,"name","color","flMarginRight"],["flTrackingLabel","OpenChatInInbox-link",3,"color","weight","click"],e,[3,"contextBoxState","thread"],[3,"loggedInUser","otherMembers"]]},template:function(e,t){1&e&&(n.Yb(0,"fl-scrollable-content",0),n.ad(1,ae,6,6,"ng-container",1),n.Tb(2,"app-messaging-chat-details-members-summary",2),n.Tb(3,"app-messaging-chat-details-members-summary",3),n.Yb(4,"app-messaging-chat-details-actions",4),n.nc("makingCall",function(e){return t.makingCall.emit(e)})("showAddPeopleScreen",function(){return t.showAddPeopleScreen.emit()}),n.Xb(),n.Yb(5,"app-messaging-chat-details-actions",5),n.nc("makingCall",function(e){return t.makingCall.emit(e)})("showAddPeopleScreen",function(){return t.showAddPeopleScreen.emit()}),n.Xb(),n.ad(6,se,3,2,"ng-container",1),n.ad(7,oe,3,2,"ng-container",1),n.Tb(8,"fl-hr"),n.Yb(9,"app-messaging-chat-details-settings",6),n.nc("toggleArchive",function(e){return t.handleToggleArchive(e)})("toggleBlock",function(e){return t.handleToggleBlock(e)})("toggleMute",function(e){return t.handleToggleMute(e)}),n.sc(10,"flAsync"),n.sc(11,"flAsync"),n.sc(12,"flAsync"),n.Xb(),n.Xb()),2&e&&(n.Gb(1),n.zc("ngIf",t.chatboxMode),n.Gb(1),n.zc("chatboxMode",t.chatboxMode)("flHideMobile",!0)("otherMembers",t.otherMembers),n.Gb(1),n.zc("chatboxMode",!0)("flShowMobile",!0)("otherMembers",t.otherMembers),n.Gb(1),n.zc("flHideMobile",!0)("callsEnabled",t.callsEnabled)("chatboxMode",t.chatboxMode)("showAddPeopleCta",t.showAddPeopleCta)("thread",t.thread),n.Gb(1),n.zc("flMarginBottom",t.Margin.SMALL)("flShowMobile",!0)("callsEnabled",t.callsEnabled)("chatboxMode",!0)("showAddPeopleCta",t.showAddPeopleCta)("thread",t.thread),n.Gb(1),n.zc("ngIf",t.contextBoxState),n.Gb(1),n.zc("ngIf",!t.chatboxMode&&(null==t.otherMembers?null:t.otherMembers.length)>1),n.Gb(2),n.zc("archiveError",t.archiveError)("blockError",t.blockError)("archived",t.thread.folder===t.FolderApi.ARCHIVED)("blocked",t.thread.isBlocked)("muted",t.thread.isMuted)("isArchiveToggleBusy",!!t.archiveResponse$&&void 0===n.tc(10,30,t.archiveResponse$))("isBlockToggleBusy",!!t.blockResponse$&&void 0===n.tc(11,32,t.blockResponse$))("isMuteToggleBusy",!!t.muteResponse$&&void 0===n.tc(12,34,t.muteResponse$))("isBlockSettingEnabled",1===t.thread.otherMembers.length&&!n.Dc(36,re).includes(t.thread.threadType)&&"owner_autochat"!==t.thread.writePrivacy)("muteError",t.muteError))},directives:[g.a,u.a,b.q,O,v.a,R,o.b,B.a,Y,m.a,a.d,s.b,C.a,Z,ie],pipes:[ne.a],styles:["[_nghost-%COMP%]{display:block;height:100%;position:relative}.MessagingChatDetails[_ngcontent-%COMP%]{bottom:0;left:0;position:absolute;right:0;top:0;height:calc(100vh - 52px);overflow-y:auto;padding:16px}@media (min-width:768px){.MessagingChatDetails[_ngcontent-%COMP%]{height:100vh}}@media (min-width:960px){.MessagingChatDetails[_ngcontent-%COMP%]{height:auto}}.OpenChatInInbox[_ngcontent-%COMP%]{display:flex}.OpenChatInInbox-icon[_ngcontent-%COMP%]{bottom:2px;position:relative}.OpenChatInInbox-link[_ngcontent-%COMP%]{align-items:center;color:#000;display:flex;padding:0 8px}"],changeDetection:0}),e})()},"3bYl":function(e,t,i){"use strict";i.d(t,"b",function(){return k}),i.d(t,"a",function(){return z});var n=i("GS7A"),a=i("SVse"),s=i("8Y7J"),o=i("iInd"),r=i("m734"),c=i("uq5U"),l=i("I1jK"),d=i("sfSt"),h=i("HsDr"),g=i("2zwU"),u=i("o9eT"),b=i("NtPp"),f=i("pLZG"),p=i("lOjL"),m=i("EKBc"),C=i("p3pP"),M=i("7KAL"),S=i("SMHo"),x=i("w13q");const y=["drawerTemplate"];function T(e,t){if(1&e){const e=s.Zb();s.Yb(0,"fl-icon",7),s.nc("click",function(){return s.Qc(e),s.rc().handleEscape()}),s.Xb()}if(2&e){const e=s.rc();s.zc("flHideMobile",e.fullWidth)("name","ui-close")("size",e.IconSize.SMALL)}}function I(e,t){if(1&e&&(s.Yb(0,"fl-bit",8),s.Yb(1,"fl-view-header",9),s.Yb(2,"fl-heading",10),s.cd(3),s.Xb(),s.Xb(),s.Xb()),2&e){const e=s.rc();s.zc("flShowMobile",!0),s.Gb(1),s.zc("flSticky",!0)("flStickyStatic",!0)("flStickyBehaviour",e.StickyBehaviour.ALWAYS),s.Gb(1),s.zc("color",e.HeadingColor.INHERIT)("headingType",e.HeadingType.H1)("size",e.TextSize.MID)("truncate",!0),s.Gb(1),s.ed(" ",e.mobileHeaderTitle," ")}}function O(e,t){}function v(e,t){if(1&e&&(s.Yb(0,"fl-bit",11),s.ad(1,O,0,0,"ng-template",12),s.Xb()),2&e){const e=s.rc();s.Hb("data-edge-to-edge",e.edgeToEdge),s.Gb(1),s.zc("ngTemplateOutlet",e.drawerTemplate)}}const A=function(e){return{distance:e}},w=function(e,t){return{value:e,params:t}};var k=function(e){return e.LEFT="left",e.RIGHT="right",e}({});let z=(()=>{class e{constructor(e,t,i,n,a,o,r){this.router=e,this.renderer=t,this.location=i,this.changeDetectorRef=n,this.swipeNavigation=a,this.pwa=o,this.document=r,this.HeadingColor=d.a,this.HeadingType=d.c,this.IconSize=h.e,this.StickyBehaviour=g.a,this.TextSize=u.f,this.ViewHeaderType=b.c,this.canRemoveOverflow=!1,this.state="hidden",this.hideStatePosition="10%",this.drawerPosition=k.RIGHT,this.closeOnBackdropClick=!0,this.edgeToEdge=!1,this.hideCloseButton=!1,this.fullWidth=!0,this.closeDrawer=new s.n,this.openDrawer=new s.n,this.isOpen=!1}set position(e){this.drawerPosition=e,this.setHidePosition()}handleEscape(){this.close()}ngOnInit(){this.routeChangeSubscription=this.router.events.pipe(Object(f.a)(e=>e instanceof o.c)).subscribe(()=>{this._close({fromRouteChange:!0})})}close(){this._close()}_close({fromRouteChange:e=!1}={}){this.isOpen&&(this.state="hidden",this.setHidePosition(),this.changeDetectorRef.markForCheck(),this.drawerPopCloseSubscription&&this.drawerPopCloseSubscription.unsubscribe(),e||this.location.back(),setTimeout(()=>{this.swipeNavigation.enableSwipeGestures(!0)}))}setHidePosition(){this.hideStatePosition=this.drawerPosition===k.RIGHT?"10%":"-10%"}handleBackdropClick(){this.closeOnBackdropClick&&this.close()}open(){this.isOpen||(this.swipeNavigation.enableSwipeGestures(!1),this.isOpen=!0,this.state="visible",this.openDrawer.emit(),this.togglePageScrollState(),this.drawerPopCloseSubscription=this.location._createBackButtonState({onPop:()=>this._close({fromRouteChange:!0})}),this.changeDetectorRef.detectChanges())}togglePageScrollState(){this.isOpen&&!this.document.body.style.overflow&&(this.canRemoveOverflow=!0),this.isOpen?this.disableBodyScroll():!this.isOpen&&this.canRemoveOverflow&&(this.enableBodyScroll(),this.canRemoveOverflow=!1)}disableBodyScroll(){this.renderer.setStyle(this.document.body,"overflow","hidden")}enableBodyScroll(){this.renderer.removeStyle(this.document.body,"overflow")}animationDone(e){"visible"===e.fromState&&"hidden"===e.toState&&(this.isOpen=!1,this.closeDrawer.emit(),this.togglePageScrollState())}handleSwipeRight(){this.pwa.isInstalled()&&this.drawerPosition===k.RIGHT&&this.close()}handleSwipeLeft(){this.pwa.isInstalled()&&this.drawerPosition===k.LEFT&&this.close()}ngOnDestroy(){this.enableBodyScroll(),this.routeChangeSubscription&&this.routeChangeSubscription.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(s.Sb(o.e),s.Sb(s.G),s.Sb(p.a),s.Sb(s.h),s.Sb(m.a),s.Sb(C.a),s.Sb(a.e))},e.\u0275cmp=s.Mb({type:e,selectors:[["fl-drawer"]],contentQueries:function(e,t,i){if(1&e&&s.Lb(i,y,1),2&e){let e;s.Mc(e=s.oc())&&(t.drawerTemplate=e.first)}},hostVars:2,hostBindings:function(e,t){1&e&&s.nc("keydown.escape",function(){return t.handleEscape()},!1,s.Oc),2&e&&s.Kb("IsActive",t.isOpen)},inputs:{closeOnBackdropClick:"closeOnBackdropClick",edgeToEdge:"edgeToEdge",hideCloseButton:"hideCloseButton",mobileHeaderTitle:"mobileHeaderTitle",position:"position",fullWidth:"fullWidth"},outputs:{closeDrawer:"closeDrawer",openDrawer:"openDrawer"},decls:7,vars:16,consts:[["cdkScrollable","",1,"DrawerContainer"],[1,"DrawerDialog"],[1,"DrawerContent",3,"swiperight","swipeleft"],["class","DrawerCloseButton",3,"flHideMobile","name","size","click",4,"ngIf"],[3,"flShowMobile",4,"ngIf"],["class","DrawerContent-inner",4,"ngIf"],[1,"DrawerBackdrop",3,"click"],[1,"DrawerCloseButton",3,"flHideMobile","name","size","click"],[3,"flShowMobile"],[1,"DrawerHeader",3,"flSticky","flStickyStatic","flStickyBehaviour"],[3,"color","headingType","size","truncate"],[1,"DrawerContent-inner"],[3,"ngTemplateOutlet"]],template:function(e,t){1&e&&(s.Yb(0,"div",0),s.Yb(1,"div",1),s.nc("@paneAnimation.done",function(e){return t.animationDone(e)}),s.Yb(2,"div",2),s.nc("swiperight",function(){return t.handleSwipeRight()})("swipeleft",function(){return t.handleSwipeLeft()}),s.ad(3,T,1,3,"fl-icon",3),s.ad(4,I,4,9,"fl-bit",4),s.ad(5,v,2,2,"fl-bit",5),s.Xb(),s.Xb(),s.Yb(6,"div",6),s.nc("click",function(){return t.handleBackdropClick()}),s.Xb(),s.Xb()),2&e&&(s.Hb("data-position",t.drawerPosition),s.Gb(1),s.zc("@paneAnimation",s.Fc(13,w,t.state,s.Ec(11,A,t.hideStatePosition))),s.Hb("data-full-width",t.fullWidth),s.Gb(1),s.Hb("data-edge-to-edge",t.edgeToEdge)("data-full-width",t.fullWidth),s.Gb(1),s.zc("ngIf",!t.hideCloseButton),s.Gb(1),s.zc("ngIf",t.fullWidth),s.Gb(1),s.zc("ngIf",t.isOpen),s.Gb(1),s.zc("@backdropAnimation",t.state),s.Hb("data-backdrop",t.isOpen)("data-full-width",t.fullWidth))},directives:[M.a,a.q,h.d,S.a,x.a,b.b,g.b,d.b,a.v],styles:["[_nghost-%COMP%]{display:none}.IsActive[_nghost-%COMP%]{display:block}.DrawerBackdrop[_ngcontent-%COMP%]{bottom:0;left:0;position:absolute;right:0;top:0;background:rgba(25,32,45,.7);display:none;position:fixed;z-index:1040}.DrawerBackdrop[data-color=dark][_ngcontent-%COMP%]{background:rgba(25,32,45,.6)}.DrawerBackdrop[data-backdrop=true][_ngcontent-%COMP%]{display:block}.DrawerBackdrop[data-full-width=true][_ngcontent-%COMP%]{background:#fff}.DrawerBackdrop[data-full-width=true][data-color=dark][_ngcontent-%COMP%]{background:#161e2c}@media (min-width:768px){.DrawerBackdrop[data-full-width=true][_ngcontent-%COMP%]{background:rgba(25,32,45,.7)}.DrawerBackdrop[data-full-width=true][data-color=dark][_ngcontent-%COMP%]{background:rgba(25,32,45,.6)}}.DrawerCloseButton[_ngcontent-%COMP%]{cursor:pointer;opacity:.5;position:absolute;right:8px;top:8px;transition:opacity .15s linear;z-index:1090}.DrawerCloseButton[_ngcontent-%COMP%]:hover{opacity:1}.DrawerContainer[_ngcontent-%COMP%]{align-items:center;bottom:0;display:flex;justify-content:center;left:0;overflow:auto;position:fixed;right:0;top:0;z-index:1090}.DrawerContainer[data-position=left][_ngcontent-%COMP%]{justify-content:flex-start}.DrawerContainer[data-position=right][_ngcontent-%COMP%]{justify-content:flex-end}.DrawerContent[_ngcontent-%COMP%]{touch-action:pan-y!important;background:#fff;min-height:100vh}@media (min-width:768px){.DrawerContent[_ngcontent-%COMP%]{-webkit-user-select:auto!important;-ms-user-select:auto!important;user-select:auto!important}}@media (min-width:768px){.DrawerContent[data-full-width=true][_ngcontent-%COMP%]{box-shadow:0 0 4px 0 rgba(0,0,0,.08),0 2px 4px 0 rgba(0,0,0,.12)}}.DrawerContent[data-full-width=false][_ngcontent-%COMP%]{box-shadow:0 0 4px 0 rgba(0,0,0,.08),0 2px 4px 0 rgba(0,0,0,.12)}.DrawerContent-inner[data-edge-to-edge=false][_ngcontent-%COMP%]{padding:16px}@media (min-width:768px){.DrawerContent-inner[data-edge-to-edge=false][_ngcontent-%COMP%]{padding:32px}}.DrawerHeader[_ngcontent-%COMP%]{min-width:100%}.DrawerDialog[_ngcontent-%COMP%]{height:100%;max-width:1000px;position:relative;z-index:1090}.DrawerDialog[data-full-width=false][_ngcontent-%COMP%]{width:90%}.DrawerDialog[data-full-width=true][_ngcontent-%COMP%]{width:100%}@media (min-width:960px){.DrawerDialog[_ngcontent-%COMP%]{min-width:800px}}"],data:{animation:[Object(n.l)("paneAnimation",[Object(n.k)("* => visible",[Object(n.m)(r.a,{params:{duration:"200",translateX:"{{ distance }}"}})]),Object(n.k)("* => hidden",[Object(n.m)(c.a,{params:{duration:"200",translateX:"{{ distance }}"}})])]),Object(n.l)("backdropAnimation",[Object(n.k)("visible => hidden",[Object(n.m)(l.a)])])]},changeDetection:0}),e})()},"3f1L":function(e,t,i){"use strict";i.d(t,"a",function(){return a});var n=i("itXk");function a(e){return n.a(e)}},"565b":function(e,t,i){"use strict";i.d(t,"a",function(){return r});var n=i("mrSG"),a=i("SVse"),s=i("8Y7J"),o=i("DsW6");let r=(()=>{class e{constructor(e,t,i){this.element=e,this.tracking=t,this.platformId=i}ngAfterViewInit(){this.flTrackingLabel&&Object(a.D)(this.platformId)&&"FL-SPINNER"===this.element.nativeElement.tagName&&(this.spinnerStartObserver=new IntersectionObserver(([e])=>Object(n.a)(this,void 0,void 0,function*(){var t;e.isIntersecting&&!this.cancel&&(this.cancel=yield this.tracking.trackHeartbeat(`${this.flTrackingLabel}.Spinner`,this.flTrackingReferenceType,null===(t=this.flTrackingReferenceId)||void 0===t?void 0:t.toString()))})),this.spinnerStartObserver.observe(this.element.nativeElement))}isInView(){return new Promise(e=>{if(this.element.nativeElement){const t=new IntersectionObserver(([i])=>{e(i.isIntersecting),t.disconnect()});t.observe(this.element.nativeElement)}else e(!1)})}ngOnChanges(e){var t;return Object(n.a)(this,void 0,void 0,function*(){this.flTrackingLabel&&Object(a.D)(this.platformId)&&"busy"in e&&(this.busy&&!this.cancel?(yield this.isInView())&&(this.cancel=yield this.tracking.trackHeartbeat(`${this.flTrackingLabel}.ButtonSpinner`,this.flTrackingReferenceType,null===(t=this.flTrackingReferenceId)||void 0===t?void 0:t.toString())):!this.busy&&this.cancel&&(this.cancel(),this.cancel=void 0))})}ngOnDestroy(){this.cancel&&(this.cancel(),this.cancel=void 0),this.spinnerStartObserver&&(this.spinnerStartObserver.unobserve(this.element.nativeElement),this.spinnerStartObserver.disconnect())}}return e.\u0275fac=function(t){return new(t||e)(s.Sb(s.l),s.Sb(o.a),s.Sb(s.D))},e.\u0275dir=s.Nb({type:e,selectors:[["fl-spinner"],["fl-button","busy",""]],inputs:{flTrackingLabel:"flTrackingLabel",flTrackingReferenceType:"flTrackingReferenceType",flTrackingReferenceId:"flTrackingReferenceId",busy:"busy"},features:[s.Eb]}),e})()},"5f+h":function(e,t,i){"use strict";i.d(t,"b",function(){return y}),i.d(t,"a",function(){return T});var n=i("mrSG"),a=i("8Y7J"),s=i("s7LF"),o=i("HsDr"),r=i("9Aot"),c=i("Rnop"),l=i("IvPS"),d=i("IzEk"),h=i("b6KT"),g=i("L1P6"),u=i("SVse"),b=i("DSso"),f=i("V1in"),p=i("nSbf"),m=i("o9eT");function C(e,t){if(1&e){const e=a.Zb();a.Wb(0),a.Yb(1,"fl-icon",2),a.nc("click",function(){return a.Qc(e),a.rc().openFileSelect.emit()}),a.Xb(),a.Yb(2,"fl-textarea",3),a.nc("inputBlur",function(){return a.Qc(e),a.rc().textareaFocused=!1})("inputFocus",function(){return a.Qc(e),a.rc().textareaFocused=!0}),a.Xb(),a.Yb(3,"fl-emoji-picker",4),a.nc("emojiPicked",function(t){return a.Qc(e),a.rc().handleEmojiPicked(t)}),a.Xb(),a.Yb(4,"fl-icon",5),a.nc("click",function(){return a.Qc(e),a.rc().handleSendMessage()}),a.Xb(),a.Vb()}if(2&e){const e=a.rc();a.Gb(1),a.zc("flMarginRight",e.Margin.XXSMALL)("name","ui-attachment")("color",e.enableFileUpload?e.IconColor.DARK:e.IconColor.MID)("hoverColor",e.enableFileUpload?e.HoverColor.PRIMARY:e.HoverColor.CURRENT),a.Gb(1),a.zc("borderless",!0)("flAutoGrow",e.messageControl)("flAutoGrowMaxHeight",e.INPUT_MAX_HEIGHT)("flMarginRight",e.Margin.XXSMALL)("control",e.messageControl)("rows",1),a.Gb(1),a.zc("flMarginRight",e.Margin.XXSMALL)("pickerSize",e.IconSize.MID),a.Gb(1),a.zc("backdrop",e.enableSendButton?e.IconBackdrop.PRIMARY:void 0)("clickable",!0)("color",e.enableSendButton?e.IconColor.WHITE:e.IconColor.MID)("label","Send")("name","ui-send")}}function M(e,t){1&e&&(a.Wb(0),a.cc(1,8),a.Vb())}function S(e,t){1&e&&a.cc(0,9)}function x(e,t){if(1&e&&(a.Yb(0,"fl-text",6),a.ad(1,M,2,0,"ng-container",0),a.ad(2,S,1,0,"ng-template",null,7,a.bd),a.Xb()),2&e){const e=a.Nc(3),t=a.rc();a.zc("color",t.FontColor.MID),a.Gb(1),a.zc("ngIf",t.isBlockedByLoggedInUser)("ngIfElse",e)}}const y=5e3;let T=(()=>{class e{constructor(e){this.localStorage=e,this.FontColor=c.a,this.HoverColor=o.a,this.IconBackdrop=o.b,this.IconColor=o.c,this.IconSize=o.e,this.Margin=r.a,this.hasAttachments=!1,this.sendMessage=new a.n,this.addFile=new a.n,this.openFileSelect=new a.n,this.userTyping=new a.n,this.INPUT_MAX_HEIGHT=72,this.textareaFocused=!1,this.lastSentTyping=0,this.messageControl=new s.f,this.enableSendButton=!1}ngOnInit(){this.messageControlSubscription=this.messageControl.valueChanges.subscribe(e=>{this.enableSendButton=this.shouldEnableSendButton()})}ngOnDestroy(){this.messageControlSubscription&&this.messageControlSubscription.unsubscribe()}ngOnChanges(e){"threadIdentifier"in e&&(this.threadIdentifierKey=Object(h.d)(this.threadIdentifier),this.loadDraftMessage()),"hasAttachments"in e&&(this.enableSendButton=this.shouldEnableSendButton())}shouldEnableSendButton(){var e;return this.hasAttachments||""!==(null===(e=this.messageControl.value)||void 0===e?void 0:e.trim())}handleKeyUpEvent(e){this.textareaFocused&&(this.updateTypingStatus(),this.updateDraftMessage(this.messageControl.value))}handleKeyDownEvent(e){var t;!this.loggedInUser||!this.textareaFocused||"enter"!==(null===(t=e.key)||void 0===t?void 0:t.toLowerCase())&&13!==(e.which||e.keyCode||e.charCode)||e.shiftKey||(this.updateTypingStatus(),this.handleSendMessage(),e.preventDefault())}handlePasteEvent(e){if(!this.textareaFocused||!e.clipboardData)return;const{clipboardData:{items:t=[]}}=e;Array.from(t).some(e=>{if("file"!==e.kind)return void this.updateTypingStatus();const t=e.getAsFile();if(t){const i=e.type.split("/")[1],n=new File([t],`image.${i}`);this.addFile.emit(n)}})}handleSendMessage(){this.enableSendButton&&(this.sendMessage.emit({message:this.messageControl.value,sender:this.loggedInUser,threadIdentifier:this.threadIdentifier}),this.messageControl.setValue(""),this.updateDraftMessage(""))}handleEmojiPicked(e){this.textAreaComponent.insertAtCursor(e,{paddedWithSpaces:!0}),this.updateTypingStatus()}loadDraftMessage(){this.messageControl.value||this.localStorage.get("webappChatDraftMessages").pipe(Object(d.a)(1)).toPromise().then((e={})=>{if(this.threadIdentifierKey){const t=e[this.threadIdentifierKey];this.messageControl.setValue((null==t?void 0:t.text)||"")}})}updateDraftMessage(e){this.localStorage.get("webappChatDraftMessages").pipe(Object(d.a)(1)).toPromise().then((t={})=>{if(!this.threadIdentifierKey)return;const i=t,a=this.threadIdentifierKey,s=Object(n.d)(i,["symbol"==typeof a?a:a+""]);this.localStorage.set("webappChatDraftMessages",0===e.length?s:Object.assign(Object.assign({},s),{[this.threadIdentifierKey]:{text:e,lastUpdated:Date.now()}}))})}updateTypingStatus(){!this.threadIdentifier.isFake&&Date.now()>this.lastSentTyping+y&&(this.lastSentTyping=Date.now(),this.userTyping.emit(this.threadIdentifier.id))}}return e.\u0275fac=function(t){return new(t||e)(a.Sb(g.a))},e.\u0275cmp=a.Mb({type:e,selectors:[["app-messaging-typing-box"]],viewQuery:function(e,t){if(1&e&&a.jd(l.a,1),2&e){let e;a.Mc(e=a.oc())&&(t.textAreaComponent=e.first)}},hostBindings:function(e,t){1&e&&a.nc("keyup",function(e){return t.handleKeyUpEvent(e)},!1,a.Oc)("keydown",function(e){return t.handleKeyDownEvent(e)},!1,a.Oc)("paste",function(e){return t.handlePasteEvent(e)},!1,a.Oc)},inputs:{enableFileUpload:"enableFileUpload",hasAttachments:"hasAttachments",isBlockedByLoggedInUser:"isBlockedByLoggedInUser",isThreadBlocked:"isThreadBlocked",isLoggedInUserSupportAgent:"isLoggedInUserSupportAgent",loggedInUser:"loggedInUser",threadIdentifier:"threadIdentifier"},outputs:{sendMessage:"sendMessage",addFile:"addFile",openFileSelect:"openFileSelect",userTyping:"userTyping"},features:[a.Eb],decls:3,vars:2,consts:function(){let e,t,i;return e="Type a message",t=" You blocked the calls and messages from this user. ",i=" You cannot chat with this user. ",[[4,"ngIf","ngIfElse"],["threadBlocked",""],["flTrackingLabel","MessagingTypingBoxFileIcon",3,"flMarginRight","name","color","hoverColor","click"],["flTrackingLabel","MessagingTypingBox","placeholder",e,1,"TypingBox-input",3,"borderless","flAutoGrow","flAutoGrowMaxHeight","flMarginRight","control","rows","inputBlur","inputFocus"],[3,"flMarginRight","pickerSize","emojiPicked"],["flTrackingLabel","ChatboxSendButton",3,"backdrop","clickable","color","label","name","click"],[3,"color"],["blockedByOther",""],t,i]},template:function(e,t){if(1&e&&(a.ad(0,C,5,17,"ng-container",0),a.ad(1,x,4,3,"ng-template",null,1,a.bd)),2&e){const e=a.Nc(2);a.zc("ngIf",t.isLoggedInUserSupportAgent||!t.isThreadBlocked)("ngIfElse",e)}},directives:[u.q,o.d,b.a,r.b,l.a,f.a,p.a,m.e],styles:["[_nghost-%COMP%]{align-items:center;display:flex;justify-content:center;min-height:56px;padding:0 8px}.TypingBox-input[_ngcontent-%COMP%]{line-height:0;width:100%}"],changeDetection:0}),e})()},"7A1k":function(e,t,i){"use strict";i.d(t,"a",function(){return D});var n=i("mrSG"),a=i("8Y7J"),s=i("iInd"),o=i("fVXH"),r=i("97vJ"),c=i("jnZY"),l=i("OpNG"),d=i("tlTr"),h=i("yeKy"),g=i("f6cb"),u=i("tsv4"),b=i("5yfJ"),f=i("lJxs"),p=i("/uUt"),m=i("zp1y"),C=i("pLZG"),M=i("eIep"),S=i("05l1"),x=i("x+ZX"),y=i("JX91"),T=i("vkgz"),I=i("IzEk"),O=i("b6KT"),v=i("/wLE"),A=i("eCtd"),w=i("w792"),k=i("u4EQ"),z=i("L1P6"),E=i("SVse"),L=i("WDoz"),_=i("yotz"),j=i("rurT"),P=i("KUXl"),R=i("al+g");const B=function(e,t){return{height:e,width:t}},$=function(e,t){return{top:e,left:t}};function U(e,t){if(1&e){const e=a.Zb();a.Yb(0,"app-messaging-chat-contents",4),a.nc("resizeEnd",function(t){a.Qc(e);const i=a.rc(2).$implicit;return a.rc().onResizeEnd(t,i)})("closeChat",function(t){return a.Qc(e),a.rc(3).closeChat(t)})("makingCall",function(t){return a.Qc(e),a.rc(3).makingCall.emit(t)})("minimiseChat",function(t){return a.Qc(e),a.rc(3).minimiseChat(t,!0)})("focusChat",function(t){return a.Qc(e),a.rc(3).focusClick(t)})("toggleSize",function(t){return a.Qc(e),a.rc(3).toggleSize(t)})("unfocusChat",function(){return a.Qc(e),a.rc(3).blur()}),a.sc(1,"flAsync"),a.sc(2,"flAsync"),a.sc(3,"flAsync"),a.sc(4,"flAsync"),a.Xb()}if(2&e){const e=a.rc(2).$implicit,t=a.rc();a.zc("ngStyle",a.Fc(21,B,e.minimised?t.NEW_CHATBOX_DIMENSIONS[t.ChatBoxSize.MINIMISED].height+"px":((null==e.dimensions?null:e.dimensions.height)||t.NEW_CHATBOX_DIMENSIONS[t.ChatBoxSize.REGULAR].height)+"px",e.minimised?t.NEW_CHATBOX_DIMENSIONS[t.ChatBoxSize.MINIMISED].width+"px":((null==e.dimensions?null:e.dimensions.width)||t.NEW_CHATBOX_DIMENSIONS[t.ChatBoxSize.REGULAR].width)+"px"))("allContacts",a.tc(1,13,t.contacts$))("chatboxMode",!0)("resizeEdges",a.Fc(24,$,!e.minimised,!e.minimised))("enableGhostResize",!e.minimised)("validateResize",t.validateResizeFunc)("resizeCursorPrecision",10)("inCall",a.tc(2,15,t.inCall$))("isFocused",e.focus!==t.FocusState.Neither)("isMinimised",e.minimised)("team",a.tc(3,17,t.getTeamFromChat(t.teams$,e)))("thread",a.tc(4,19,e.thread$))("threadIdentifier",e.threadIdentifier)}}function G(e,t){if(1&e){const e=a.Zb();a.Yb(0,"app-chat-box",5),a.nc("resizeEnd",function(t){a.Qc(e);const i=a.rc(2).$implicit;return a.rc().onResizeEnd(t,i)})("closeChat",function(t){return a.Qc(e),a.rc(3).closeChat(t)})("minimiseChat",function(t){return a.Qc(e),a.rc(3).minimiseChat(t)})("blurClick",function(){return a.Qc(e),a.rc(3).blur()})("focusClick",function(t){return a.Qc(e),a.rc(3).focusClick(t)})("makingCall",function(t){return a.Qc(e),a.rc(3).makingCall.emit(t)}),a.Xb()}if(2&e){const e=a.rc(2).$implicit,t=a.rc();a.zc("resizeEdges",a.Fc(10,$,!e.minimised,!e.minimised))("enableGhostResize",!e.minimised)("validateResize",t.validateResizeFunc)("ngStyle",a.Fc(13,B,e.height+"px",e.width+"px"))("resizeCursorPrecision",10)("attributes",e)("allContacts$",t.contacts$)("inCall$",t.inCall$)("currentUserIdValue",t.currentUserIdValue)("team$",t.getTeamFromChat(t.teams$,e))}}function N(e,t){if(1&e&&(a.Wb(0),a.ad(1,U,5,27,"app-messaging-chat-contents",2),a.ad(2,G,1,16,"ng-template",null,3,a.bd),a.Vb()),2&e){const e=a.Nc(3),t=a.rc(2);a.Gb(1),a.zc("ngIf",t.isNewChatbox)("ngIfElse",e)}}function F(e,t){if(1&e&&(a.Wb(0),a.ad(1,N,4,2,"ng-container",1),a.Vb()),2&e){const e=t.$implicit;a.Gb(1),a.zc("ngIf",e.visible)}}let D=(()=>{class e{constructor(e,t,i,n,s,o,r,c){this.auth=e,this.activatedRoute=t,this.datastore=i,this.webSocketService=n,this.sounds=s,this.changeDetectorRef=o,this.messagingChat=r,this.localStorage=c,this.ChatBoxSize=h.a,this.FocusState=d.a,this.NEW_CHATBOX_DIMENSIONS=h.e,this.toObservable=g.s,this.adminChatsOnly=!1,this.makingCall=new a.n,this.chats=[],this.errors={},this.getTeamFromChat=O.c,this.SUPPORT_CHATS_LIMIT=20,this.NEW_INBOX_WIDGET_WIDTH=390}onResize(){return Object(n.a)(this,void 0,void 0,function*(){yield this.limitChatHeight(),this.updateChatOverflow()})}beforeUnload(){return Object(n.a)(this,void 0,void 0,function*(){yield this.saveChats(this.chats)})}ngOnInit(){this.showNewChatboxSubscription$=this.activatedRoute.queryParams.pipe(Object(f.a)(e=>Object(s.m)(e).has("new_chatbox")),Object(p.a)()).subscribe(e=>this.isNewChatbox=e),this.currentUserId$=this.auth.getUserId(),this.messagingChat.registerLiveChat(e=>this.startChat(e)),this.messagingChat.cleanStoredDraftMessages(),this.currentUserIdSubscription=this.currentUserId$.subscribe(e=>{this.currentUserIdValue=e}),this.currentUserDoc=this.datastore.document("users",this.currentUserId$),this.loadChats().then(()=>this.limitChatHeight());const e=this.datastore.collection("notificationsPreferences").valueChanges().pipe(Object(f.a)(e=>{const t=e.filter(e=>"messages"===e.notificationType&&"chat_sound"===e.channel);return t.length>0&&t[0].enabled}));this.messageNotifySubscription=this.webSocketService.fromServerStream$.pipe(Object(m.a)(this.currentUserId$,e),Object(C.a)(([e,t,i])=>{if(i&&Object(o.a)(e)&&"messages"===e.body.parent_type&&"private"===e.body.type&&e.body.data.from_user.toString()!==t&&!this.isHiddenThread(e.body.data.thread_details.thread_type)){const t=e.body.data.thread_id,i=this.chats.find(e=>e.threadIdentifier.id===t);return void 0!==i&&(i.focus===d.a.Neither||i.focus===d.a.Header)}return!1})).subscribe(()=>this.sounds.handleNotification("message")),this.contacts$=this.currentUserDoc.valueChanges().pipe(Object(f.a)(O.f),Object(p.a)(),Object(M.a)(e=>e?b.a:this.datastore.collection("contacts").valueChanges()),Object(r.a)(),Object(S.a)(1),Object(x.a)()),this.teams$=this.datastore.collection("teams",e=>e.where("members","includes",this.currentUserId$.pipe(Object(f.a)(e=>Object(g.r)(e))))).valueChanges().pipe(Object(c.a)(),Object(y.a)({})),this.clickedOutsideSubscription=this.clickedOutside$.subscribe(e=>{e&&this.blur()}),this.validateResizeFunc=e=>void 0!==e.rectangle.width&&void 0!==e.rectangle.height&&this.messagingChat.isValidChatboxDimensions({width:e.rectangle.width,height:e.rectangle.height},this.isNewChatbox)}blur(e){this.chats=this.chats.map(t=>Object.assign(Object.assign({},t),{focus:e&&t===e?t.focus:d.a.Neither}))}onResizeEnd(e,t){return Object(n.a)(this,void 0,void 0,function*(){const{width:i,height:n}=e.rectangle;if(void 0===i||void 0===n)return;const a=this.messagingChat.constrainChatboxDimensions({width:i,height:n},this.isNewChatbox);if(this.chats){this.blur();const e=this.chats.findIndex(e=>Object(O.h)(e.threadIdentifier,t.threadIdentifier));e>=0&&(this.chats=this.getUpdatedChats(e,Object.assign(Object.assign({},this.chats[e]),this.isNewChatbox?{focus:d.a.HeaderAndTypingBox,dimensions:a,lastUpdate:Date.now()}:{height:a.height,width:a.width,focus:d.a.HeaderAndTypingBox,lastUpdate:Date.now()})),yield this.saveChats(this.chats),this.updateChatOverflow())}})}startChat({userIds:e,threadType:t,context:i={type:u.ContextTypeApi.NONE},threadId:a,focus:s}){return Object(n.a)(this,void 0,void 0,function*(){const n=Array.from(new Set([...e,Number(this.currentUserIdValue)]));if(n.length<2&&!a)return;const o=a||Math.floor(Math.random()*Number.MIN_SAFE_INTEGER),r={id:o,threadType:t,context:i,members:n,isFake:o<0},c=this.chats.find(e=>Object(O.h)(r,e.threadIdentifier));if(void 0===c){if(s&&this.blur(),t===u.ThreadTypeApi.ADMIN_PREFERRED_CHAT&&(i.type===u.ContextTypeApi.SUPPORT_CHAT||i.type===u.ContextTypeApi.SUPPORT_SESSION)){const e=this.chats.filter(e=>e.threadIdentifier.threadType===u.ThreadTypeApi.ADMIN_PREFERRED_CHAT&&(e.threadIdentifier.context.type===u.ContextTypeApi.SUPPORT_CHAT||e.threadIdentifier.context.type===u.ContextTypeApi.SUPPORT_SESSION));if(e&&e.length>=this.SUPPORT_CHATS_LIMIT){const t=e[e.length-1];yield this.closeChat(t.threadIdentifier)}}this.chats=[this.createChatAttributes(r,s),...this.chats],this.changeDetectorRef.markForCheck()}else{const e=this.chats.indexOf(c);e>=0&&(s&&this.blur(c),this.chats=this.getUpdatedChats(e,Object.assign(Object.assign({},c),{focus:s?d.a.HeaderAndTypingBox:c.focus,minimised:!s&&c.minimised,lastUpdate:Date.now()})))}this.updateChatOverflow(),yield this.saveChats(this.chats)})}createChatAttributes(e,t=!0,i=280,n=-1,a=!1,s=!1,o={width:h.e[h.a.REGULAR].width,height:h.e[h.a.REGULAR].height}){const r=e.members.length>0?e.members.filter(e=>e!==Number(this.currentUserIdValue)):[],c=Date.now(),l={context:e.context,contextType:e.context.type,folder:u.FolderApi.INBOX,id:e.id,inactiveMembers:[],isFake:e.isFake,isMuted:!1,isBlocked:!1,isRead:!0,members:e.members,messageUnreadCount:0,otherMembers:r,owner:Number(this.currentUserIdValue),threadType:e.threadType,timeCreated:c,timeRead:c,timeUpdated:c,userReadTimes:{},writePrivacy:u.PrivacyLevelApi.MEMBERS};let g;g=e.id>0?t=>t.where("id","==",e.id):t=>t.where("otherMembers","equalsIgnoreOrder",r).where("context","==",e.context).where("threadType","in",[e.threadType]);const b=this.datastore.collection("threads",g),p=b.valueChanges().pipe(Object(C.a)(e=>e&&0!==e.length),Object(T.a)(t=>{t.length>1&&console.warn(`More than 1 thread returned for user ${this.currentUserIdValue}`,e)}),Object(f.a)(e=>e[0]),Object(T.a)(e=>{this.updateThreadIdentifier(Object(O.a)(e))}),Object(y.a)(l),Object(S.a)(1),Object(x.a)());return{minimised:a,focus:t?d.a.HeaderAndTypingBox:d.a.Neither,width:i,height:n,lastUpdate:Date.now(),visible:!0,threadCollection:b,thread$:p,threadIdentifier:e,dimensions:o}}focusLastUpdatedChatbox(){const e=this.chats.reduce((e,t,i)=>t.visible&&!t.minimised&&(!this.chats[e]||t.lastUpdate>this.chats[e].lastUpdate)?i:e,-1);e>=0&&(this.chats=this.getUpdatedChats(e,Object.assign(Object.assign({},this.chats[e]),{focus:d.a.HeaderAndTypingBox})))}closeChat(e){return Object(n.a)(this,void 0,void 0,function*(){const t=this.chats.findIndex(t=>Object(O.h)(t.threadIdentifier,e));if(-1!==t){const i=this.chats[t].focus!==d.a.Neither;this.chats=this.chats.filter(t=>!Object(O.h)(t.threadIdentifier,e)),this.updateChatOverflow(),i&&this.focusLastUpdatedChatbox(),yield this.saveChats(this.chats)}})}minimiseChat(e,t=!1){return Object(n.a)(this,void 0,void 0,function*(){const i=this.chats.findIndex(t=>Object(O.h)(t.threadIdentifier,e));if(i>=0){const n=!this.chats[i].minimised;this.chats=this.getUpdatedChats(i,Object.assign(Object.assign({},this.chats[i]),{minimised:n})),yield this.saveChats(this.chats),t&&(n?this.blur():this.focusClick(e))}})}updateThreadIdentifier(e){const t=this.chats.findIndex(t=>Object(O.h)(t.threadIdentifier,e));if(t<0)return;const i=this.chats[t];e.id===i.threadIdentifier.id&&e.isFake===i.threadIdentifier.isFake&&Object(l.b)(e.members,i.threadIdentifier.members)||(this.chats=this.getUpdatedChats(t,Object.assign(Object.assign({},i),{threadIdentifier:Object.assign({},e)})))}ngOnDestroy(){this.currentUserIdSubscription&&this.currentUserIdSubscription.unsubscribe(),this.webSocketSubscription&&this.webSocketSubscription.unsubscribe(),this.messageNotifySubscription&&this.messageNotifySubscription.unsubscribe(),this.clickedOutsideSubscription&&this.clickedOutsideSubscription.unsubscribe(),this.messagingChat&&this.messagingChat.unregisterLiveChat(),this.showNewChatboxSubscription$&&this.showNewChatboxSubscription$.unsubscribe()}focusClick(e){this.chats=this.chats.map(t=>(t=>Object(O.h)(t.threadIdentifier,e))(t)?Object.assign(Object.assign({},t),{focus:d.a.HeaderAndTypingBox,lastUpdate:Date.now()}):Object.assign(Object.assign({},t),{focus:d.a.Neither}))}identifyChat(e,t){if("group"===t.threadIdentifier.threadType)return t.threadIdentifier.id.toString();const i=`[${[...t.threadIdentifier.members].sort().toString()}]`;return t.threadIdentifier.context.type===u.ContextTypeApi.NONE?`${t.threadIdentifier.threadType}:${i}`:`${t.threadIdentifier.threadType}:${t.threadIdentifier.context.type}:${t.threadIdentifier.context.id}:${i}`}updateChatOverflow(){const e=this.chats.filter(e=>!this.isHiddenThread(e.threadIdentifier.threadType)&&e.focus===d.a.Neither).sort((e,t)=>t.lastUpdate-e.lastUpdate),t=this.chats.findIndex(e=>!this.isHiddenThread(e.threadIdentifier.threadType)&&e.focus!==d.a.Neither),i=this.isNewChatbox,n=Object(s.m)(this.activatedRoute.snapshot.queryParams).has("newInboxWidget");-1!==t&&e.unshift(this.chats[t]);const a=this.messagingChat.fitChatsToScreen(e,{offset:n?this.NEW_INBOX_WIDGET_WIDTH:210,gap:8,useDimensions:i}).map(e=>e.threadIdentifier.id);this.chats=this.chats.map(e=>Object.assign(Object.assign({},e),{visible:a.includes(e.threadIdentifier.id)}))}getUpdatedChats(e,t){return e<0||e>this.chats.length-1?this.chats:(this.changeDetectorRef.markForCheck(),[...this.chats.slice(0,e),t,...this.chats.slice(e+1,this.chats.length)])}isHiddenThread(e){return this.adminChatsOnly&&"admin_preferred_chat"!==e&&"support_chat"!==e}saveChats(e){return Object(n.a)(this,void 0,void 0,function*(){const t=e.map(e=>({dimensions:e.dimensions,minimised:e.minimised,focus:e.focus,width:e.width,height:e.height,threadIdentifier:e.threadIdentifier}));yield this.localStorage.set("webappChats",t)})}loadChats(){return this.localStorage.get("webappChats").pipe(Object(I.a)(1)).toPromise().then(e=>{this.chats=e?e.filter(e=>!e.threadIdentifier.isFake).map(e=>this.createChatAttributes(e.threadIdentifier,!1,e.width,e.height,e.minimised,!!e.dimensions&&this.isExpanded(e.dimensions),e.dimensions)):[],this.updateChatOverflow(),this.changeDetectorRef.markForCheck()})}limitChatHeight(){return Object(n.a)(this,void 0,void 0,function*(){const{max:{height:e}}=this.messagingChat.getDimensionLimits(this.isNewChatbox);this.chats=this.chats.map(t=>{var i;return this.isNewChatbox&&t.dimensions&&(null===(i=t.dimensions)||void 0===i?void 0:i.height)>e?Object.assign(Object.assign({},t),{dimensions:Object.assign(Object.assign({},t.dimensions),{height:h.e[h.a.REGULAR].height})}):!this.isNewChatbox&&t.height>e?Object.assign(Object.assign({},t),{height:380}):t}),yield this.saveChats(this.chats)})}isExpanded(e){return e.height>=h.e[h.a.EXPANDED].height||e.width>=h.e[h.a.EXPANDED].width}toggleSize(e){if(this.chats){this.blur();const t=this.chats.findIndex(t=>Object(O.h)(t.threadIdentifier,e));if(t>=0){const{dimensions:e}=this.chats[t],i=!!e&&!this.isExpanded(e);this.chats=this.getUpdatedChats(t,Object.assign(Object.assign({},this.chats[t]),{focus:d.a.HeaderAndTypingBox,lastUpdate:Date.now(),dimensions:h.e[i?h.a.EXPANDED:h.a.REGULAR]})),this.saveChats(this.chats),this.updateChatOverflow()}}}}return e.\u0275fac=function(t){return new(t||e)(a.Sb(v.a),a.Sb(s.a),a.Sb(A.a),a.Sb(w.a),a.Sb(k.a),a.Sb(a.h),a.Sb(h.d),a.Sb(z.a))},e.\u0275cmp=a.Mb({type:e,selectors:[["app-messaging-chat"]],hostBindings:function(e,t){1&e&&a.nc("resize",function(){return t.onResize()},!1,a.Pc)("beforeunload",function(){return t.beforeUnload()},!1,a.Pc)},inputs:{adminChatsOnly:"adminChatsOnly",inCall$:"inCall$",clickedOutside$:"clickedOutside$"},outputs:{makingCall:"makingCall"},decls:1,vars:2,consts:[[4,"ngFor","ngForOf","ngForTrackBy"],[4,"ngIf"],["class","MessagingChatBox","mwlResizable","",3,"ngStyle","allContacts","chatboxMode","resizeEdges","enableGhostResize","validateResize","resizeCursorPrecision","inCall","isFocused","isMinimised","team","thread","threadIdentifier","resizeEnd","closeChat","makingCall","minimiseChat","focusChat","toggleSize","unfocusChat",4,"ngIf","ngIfElse"],["oldChatbox",""],["mwlResizable","",1,"MessagingChatBox",3,"ngStyle","allContacts","chatboxMode","resizeEdges","enableGhostResize","validateResize","resizeCursorPrecision","inCall","isFocused","isMinimised","team","thread","threadIdentifier","resizeEnd","closeChat","makingCall","minimiseChat","focusChat","toggleSize","unfocusChat"],["mwlResizable","","flTrackingSection","chatbox",1,"InteractableChatbox",3,"resizeEdges","enableGhostResize","validateResize","ngStyle","resizeCursorPrecision","attributes","allContacts$","inCall$","currentUserIdValue","team$","resizeEnd","closeChat","minimiseChat","blurClick","focusClick","makingCall"]],template:function(e,t){1&e&&a.ad(0,F,2,1,"ng-container",0),2&e&&a.zc("ngForOf",t.chats)("ngForTrackBy",t.identifyChat)},directives:[E.p,E.q,L.a,_.a,E.r,j.a,P.a],pipes:[R.a],styles:["[_nghost-%COMP%]{align-items:flex-end;bottom:0;display:flex;flex-direction:row;pointer-events:none}.InteractableChatbox[_ngcontent-%COMP%], .MessagingChatBox[_ngcontent-%COMP%]{pointer-events:auto}.MessagingChatBox[_ngcontent-%COMP%]{box-shadow:0 0 4px 0 rgba(0,0,0,.08),0 2px 4px 0 rgba(0,0,0,.12);display:block;margin-right:8px}"],changeDetection:0}),e})()},AJ15:function(e,t,i){"use strict";i.d(t,"a",function(){return Te});var n=i("2Vo4"),a=i("XNiG"),s=i("8Y7J"),o=i("w13q"),r=i("SVse"),c=i("KUXl");let l=(()=>{class e{ngOnInit(){this.isHeadingBlue=this.isOldChatbox}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Mb({type:e,selectors:[["app-heading"]],hostVars:2,hostBindings:function(e,t){2&e&&s.Kb("IsHeadingBlue",t.isHeadingBlue)},inputs:{element:"element",isOldChatbox:"isOldChatbox"},decls:1,vars:1,template:function(e,t){1&e&&s.cd(0),2&e&&s.ed(" ",t.element.text," ")},styles:["[_nghost-%COMP%]{font-size:14px;line-height:1.43;word-break:break-word;word-wrap:break-word;font-weight:700}.IsHeadingBlue[_nghost-%COMP%]{color:#139ff0}"],changeDetection:0}),e})(),d=(()=>{class e{ngOnInit(){this.element.style&&(this.isBold=this.element.style.includes("bold"),this.isItalic=this.element.style.includes("italic"),this.isSmall=this.element.style.includes("small"))}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Mb({type:e,selectors:[["app-body"]],hostVars:6,hostBindings:function(e,t){2&e&&s.Kb("IsBold",t.isBold)("IsItalic",t.isItalic)("IsSmall",t.isSmall)},inputs:{element:"element"},decls:2,vars:1,template:function(e,t){1&e&&(s.Yb(0,"fl-bit"),s.cd(1),s.Xb()),2&e&&(s.Gb(1),s.ed(" ",t.element.text," "))},directives:[o.a],styles:["[_nghost-%COMP%]{font-size:14px;line-height:1.43;word-break:break-word;word-wrap:break-word;white-space:pre-line}.IsBold[_nghost-%COMP%]{font-weight:700}.IsItalic[_nghost-%COMP%]{font-style:italic}.IsSmall[_nghost-%COMP%]{font-size:13px;line-height:1.2}"],changeDetection:0}),e})();var h=i("s7LF"),g=i("w5Bh"),u=i("DSso");function b(e,t){if(1&e&&(s.Yb(0,"fl-bit",2),s.cd(1),s.Xb()),2&e){const e=s.rc();s.Gb(1),s.dd(e.currErrText)}}let f=(()=>{class e{constructor(e){this.changeDetectorRef=e,this.control=new h.f,this.richMessageValuesChange=new s.n}handleClick(e){e.stopPropagation()}ngOnInit(){this.richMessageValues[this.element.name]=""}ngOnChanges(){this.disabled?this.control.disable():this.control.enable()}handleInput(){this.currErrText="",this.richMessageValues[this.element.name]=this.control.value,this.changeDetectorRef.markForCheck()}validate(){return this.currErrText="",this.changeDetectorRef.markForCheck(),!0}}return e.\u0275fac=function(t){return new(t||e)(s.Sb(s.h))},e.\u0275cmp=s.Mb({type:e,selectors:[["app-text-input"]],hostBindings:function(e,t){1&e&&s.nc("click",function(e){return t.handleClick(e)})},inputs:{element:"element",disabled:"disabled",richMessageValues:"richMessageValues"},outputs:{richMessageValuesChange:"richMessageValuesChange"},features:[s.Eb],decls:2,vars:3,consts:[["flTrackingLabel","rich-message-text-input",3,"placeholder","control","input"],["class","Error",4,"ngIf"],[1,"Error"]],template:function(e,t){1&e&&(s.Yb(0,"fl-input",0),s.nc("input",function(){return t.handleInput()}),s.Xb(),s.ad(1,b,2,1,"fl-bit",1)),2&e&&(s.zc("placeholder",t.element.placeholder)("control",t.control),s.Gb(1),s.zc("ngIf",t.currErrText))},directives:[g.a,u.a,r.q,o.a],styles:[".Error[_ngcontent-%COMP%]{font-size:13px;line-height:1.2;color:#eb3730;margin-top:4px}"],changeDetection:0}),e})();var p=i("f6cb"),m=i("yb+G");function C(e,t){if(1&e&&s.Tb(0,"fl-radio",3),2&e){const e=s.rc().ngIf,t=s.rc();s.zc("control",e)("options",t.options)}}function M(e,t){if(1&e&&(s.Wb(0),s.ad(1,C,1,2,"fl-radio",2),s.Vb()),2&e){const e=t.ngIf,i=s.rc();s.Gb(1),s.zc("ngIf",i.isFormControl(e))}}function S(e,t){if(1&e&&(s.Yb(0,"fl-bit",4),s.cd(1),s.Xb()),2&e){const e=s.rc();s.Gb(1),s.dd(e.currErrText)}}let x=(()=>{class e{constructor(){this.isFormControl=p.k,this.richMessageValuesChange=new s.n,this.formGroup=new h.h({radio:new h.f})}ngOnInit(){this.options=this.element.values.map(e=>e.text),this.formSubscription=this.formGroup.valueChanges.subscribe(e=>{const t=this.element.values.filter(t=>t.text===e.radio);1===t.length&&(this.richMessageValues[this.element.name]=t[0].value)})}ngOnDestroy(){this.formSubscription&&this.formSubscription.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Mb({type:e,selectors:[["app-radio-input"]],inputs:{element:"element",disabled:"disabled",richMessageValues:"richMessageValues"},outputs:{richMessageValuesChange:"richMessageValuesChange"},decls:2,vars:2,consts:[[4,"ngIf"],["class","Error",4,"ngIf"],["flTrackingLabel","rich-message-radio-input",3,"control","options",4,"ngIf"],["flTrackingLabel","rich-message-radio-input",3,"control","options"],[1,"Error"]],template:function(e,t){1&e&&(s.ad(0,M,2,1,"ng-container",0),s.ad(1,S,2,1,"fl-bit",1)),2&e&&(s.zc("ngIf",t.formGroup.get("radio")),s.Gb(1),s.zc("ngIf",t.currErrText))},directives:[r.q,m.b,u.a,o.a],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column}.Error[_ngcontent-%COMP%]{font-size:13px;line-height:1.2;color:#eb3730;margin-top:4px}"],changeDetection:0}),e})();var y=i("SYW+");function T(e,t){if(1&e&&s.Tb(0,"fl-checkbox",4),2&e){const e=s.rc().ngIf,t=s.rc().$implicit;s.zc("control",e)("label",t.text)}}function I(e,t){if(1&e&&(s.Wb(0),s.ad(1,T,1,2,"fl-checkbox",3),s.Vb()),2&e){const e=t.ngIf,i=s.rc(2);s.Gb(1),s.zc("ngIf",i.isFormControl(e))}}function O(e,t){if(1&e&&(s.Wb(0),s.ad(1,I,2,1,"ng-container",2),s.Vb()),2&e){const e=t.$implicit,i=s.rc();s.Gb(1),s.zc("ngIf",i.formGroup.get(e.value))}}function v(e,t){if(1&e&&(s.Yb(0,"fl-bit",5),s.cd(1),s.Xb()),2&e){const e=s.rc();s.Gb(1),s.dd(e.currErrText)}}let A=(()=>{class e{constructor(){this.isFormControl=p.k,this.richMessageValues={},this.richMessageValuesChange=new s.n,this.formGroup=new h.h({})}ngOnInit(){this.element.values.forEach(e=>{this.richMessageValues[e.value]=!1,this.formGroup.addControl(e.value,new h.f(!1))}),this.formSubscription=this.formGroup.valueChanges.subscribe(e=>{Object.entries(e).forEach(e=>{const[t,i]=e;this.richMessageValues[t]=i})})}ngOnDestroy(){this.formSubscription&&this.formSubscription.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Mb({type:e,selectors:[["app-checkbox-input"]],inputs:{element:"element",disabled:"disabled",richMessageValues:"richMessageValues"},outputs:{richMessageValuesChange:"richMessageValuesChange"},decls:2,vars:2,consts:[[4,"ngFor","ngForOf"],["class","Error",4,"ngIf"],[4,"ngIf"],["flTrackingLabel","rich-message-checkbox",3,"control","label",4,"ngIf"],["flTrackingLabel","rich-message-checkbox",3,"control","label"],[1,"Error"]],template:function(e,t){1&e&&(s.ad(0,O,2,1,"ng-container",0),s.ad(1,v,2,1,"fl-bit",1)),2&e&&(s.zc("ngForOf",t.element.values),s.Gb(1),s.zc("ngIf",t.currErrText))},directives:[r.p,r.q,y.a,u.a,o.a],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column}.Error[_ngcontent-%COMP%]{font-size:13px;line-height:1.2;color:#eb3730}"],changeDetection:0}),e})();function w(e,t){if(1&e&&(s.Yb(0,"fl-bit",3),s.cd(1),s.Xb()),2&e){const e=s.rc();s.Gb(1),s.dd(e.currErrText)}}let k=(()=>{class e{constructor(e){this.changeDetectorRef=e,this.InputType=g.d,this.control=new h.f,this.richMessageValuesChange=new s.n}handleClick(e){e.stopPropagation()}ngOnInit(){this.richMessageValues[this.element.name]=NaN}ngOnChanges(){this.disabled?this.control.disable():this.control.enable()}handleInput(){const e=parseInt(this.control.value,10);this.currErrText="",this.richMessageValues[this.element.name]=e,this.changeDetectorRef.markForCheck()}validate(){return this.changeDetectorRef.markForCheck(),Number.isNaN(this.richMessageValues[this.element.name])?(this.currErrText="Please enter a value",!1):(this.currErrText="",this.changeDetectorRef.markForCheck(),!0)}}return e.\u0275fac=function(t){return new(t||e)(s.Sb(s.h))},e.\u0275cmp=s.Mb({type:e,selectors:[["app-number-input"]],hostBindings:function(e,t){1&e&&s.nc("click",function(e){return t.handleClick(e)})},inputs:{element:"element",disabled:"disabled",richMessageValues:"richMessageValues"},outputs:{richMessageValuesChange:"richMessageValuesChange"},features:[s.Eb],decls:3,vars:5,consts:[[1,"Container"],["flTrackingLabel","rich-message-number-input",1,"FieldInput",3,"beforeLabel","placeholder","control","type","input"],["class","Error",4,"ngIf"],[1,"Error"]],template:function(e,t){1&e&&(s.Yb(0,"fl-bit",0),s.Yb(1,"fl-input",1),s.nc("input",function(){return t.handleInput()}),s.Xb(),s.Xb(),s.ad(2,w,2,1,"fl-bit",2)),2&e&&(s.Gb(1),s.zc("beforeLabel",t.element.label)("placeholder",t.element.placeholder)("control",t.control)("type",t.InputType.NUMBER),s.Gb(1),s.zc("ngIf",t.currErrText))},directives:[o.a,g.a,u.a,r.q],styles:[".Container[_ngcontent-%COMP%]{align-items:center;display:flex}.FieldInput[_ngcontent-%COMP%]{flex-grow:1}.Label[_ngcontent-%COMP%]{margin-right:8px}.Error[_ngcontent-%COMP%]{font-size:13px;line-height:1.2;color:#eb3730;margin-top:4px}"],changeDetection:0}),e})();var z=i("9Aot"),E=i("3VJ0");function L(e,t){if(1&e&&s.Tb(0,"fl-select",4),2&e){const e=s.rc().ngIf,t=s.rc();s.zc("disabled",t.disabled)("control",e)("options",t.options)("flMarginBottom",t.Margin.XSMALL)}}function _(e,t){if(1&e&&(s.Yb(0,"fl-bit",2),s.ad(1,L,1,4,"fl-select",3),s.Xb()),2&e){const e=t.ngIf,i=s.rc();s.Gb(1),s.zc("ngIf",i.isFormControl(e))}}function j(e,t){if(1&e&&(s.Yb(0,"fl-bit",5),s.cd(1),s.Xb()),2&e){const e=s.rc();s.Gb(1),s.dd(e.currErrText)}}let P=(()=>{class e{constructor(){this.isFormControl=p.k,this.richMessageValuesChange=new s.n,this.Margin=z.a,this.formGroup=new h.h({select:new h.f})}handleClick(e){e.stopPropagation()}ngOnInit(){this.options=this.element.values.map(e=>e.text),this.element.default&&(this.richMessageValues[this.element.name]=this.element.default),this.formSubscription=this.formGroup.valueChanges.subscribe(e=>{const t=this.element.values.filter(t=>t.text===e.select);1===t.length&&(this.richMessageValues[this.element.name]=t[0].value)})}ngOnDestroy(){this.formSubscription&&this.formSubscription.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Mb({type:e,selectors:[["app-select-input"]],hostBindings:function(e,t){1&e&&s.nc("click",function(e){return t.handleClick(e)})},inputs:{element:"element",disabled:"disabled",richMessageValues:"richMessageValues"},outputs:{richMessageValuesChange:"richMessageValuesChange"},decls:2,vars:2,consts:[["class","Container",4,"ngIf"],["class","Error",4,"ngIf"],[1,"Container"],["flTrackingLabel","rich-message-select",3,"disabled","control","options","flMarginBottom",4,"ngIf"],["flTrackingLabel","rich-message-select",3,"disabled","control","options","flMarginBottom"],[1,"Error"]],template:function(e,t){1&e&&(s.ad(0,_,2,1,"fl-bit",0),s.ad(1,j,2,1,"fl-bit",1)),2&e&&(s.zc("ngIf",t.formGroup.get("select")),s.Gb(1),s.zc("ngIf",t.currErrText))},directives:[r.q,o.a,E.b,u.a,z.b],styles:[".Container[_ngcontent-%COMP%]{display:flex;flex-direction:column}.Error[_ngcontent-%COMP%]{font-size:13px;line-height:1.2;color:#eb3730;margin-top:4px}"],changeDetection:0}),e})();var R=i("ph87"),B=i("7v0r"),$=i("B23V"),U=i("iInd"),G=i("LRne"),N=i("itXk"),F=i("lJxs"),D=i("eIep"),X=i("CqXF"),Y=i("JIr8"),H=i("IzEk"),V=i("/wLE"),Q=i("IheW"),W=i("90vB");let q=(()=>{class e{constructor(e,t,i){this.auth=e,this.http=t,this.freelancerHttp=i}request(e,t,i){return this.auth.getAuthorizationHeader().pipe(Object(F.a)(t=>{const i=e.contentType||"application/json";return{headers:t.set("Content-Type",i),body:this.serialiseBody(i,e.payload)}}),Object(D.a)(({headers:n,body:a})=>this.http.request(t,e.url,{observe:"response",body:a,headers:n,params:{webapp:"1",compact:"true",new_errors:"true"}}).pipe(Object(D.a)(t=>this.savePayload(t.status,e.payload,i).pipe(Object(X.a)({status:"success"}))),Object(Y.a)(e=>G.a({status:"error",errorCode:e.error.error.code})))),Object(H.a)(1))}serialiseBody(e,t){return e.includes("urlencoded")?Object.keys(t).map(e=>`${encodeURIComponent(e)}=${encodeURIComponent(`${t[e]}`)}`).join("&"):JSON.stringify(t)}savePayload(e,t,i){return N.a([this.auth.getAuthorizationHeader(),this.auth.getUserId()]).pipe(Object(D.a)(([n,a])=>this.http.post(`${this.freelancerHttp.getBaseServiceUrl()}/messages/0.1/messages/${i}/?action=save_rich_message_payload`,{[a]:{status_code:e,payload:t}},{headers:n,params:{webapp:"1",compact:"true",new_errors:"true"}})),Object(X.a)(void 0))}}return e.\u0275fac=function(t){return new(t||e)(s.jc(V.a),s.jc(Q.a),s.jc(W.a))},e.\u0275prov=s.Ob({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var K=i("lDT0"),Z=i("SMHo"),J=i("565b"),ee=i("4kPF"),te=i("al+g");function ie(e,t){if(1&e&&(s.Yb(0,"fl-link",3),s.cd(1),s.Xb()),2&e){const e=s.rc(2);s.zc("link",e.transformedLink.url)("queryParams",e.transformedLink.queryParams)("fragment",e.transformedLink.fragment),s.Gb(1),s.ed(" ",e.element.label," ")}}function ne(e,t){if(1&e&&(s.Yb(0,"fl-button",4),s.cd(1),s.Xb()),2&e){const e=s.rc(2);s.zc("color",e.color)("display","block")("link",e.transformedLink.url)("queryParams",e.transformedLink.queryParams)("fragment",e.transformedLink.fragment),s.Gb(1),s.ed(" ",e.element.label," ")}}function ae(e,t){if(1&e&&(s.Wb(0),s.ad(1,ie,2,4,"fl-link",1),s.ad(2,ne,2,6,"ng-template",null,2,s.bd),s.Vb()),2&e){const e=s.Nc(3),t=s.rc();s.Gb(1),s.zc("ngIf","LinkHeading"===t.displayClass)("ngIfElse",e)}}function se(e,t){if(1&e&&(s.Yb(0,"fl-banner-alert",12),s.Tb(1,"fl-interactive-text",13),s.Xb()),2&e){const e=s.rc(2);s.zc("type",e.BannerAlertType.ERROR)("closeable",!1)("flMarginBottom",e.Margin.XXSMALL),s.Gb(1),s.zc("link",!0)("content",e.currErrText)}}function oe(e,t){if(1&e){const e=s.Zb();s.Wb(0),s.Yb(1,"fl-bit",5),s.Yb(2,"fl-button",6),s.nc("click",function(){return s.Qc(e),s.rc().handleClick()}),s.sc(3,"flAsync"),s.cd(4),s.Xb(),s.Xb(),s.Yb(5,"fl-bit",5),s.Yb(6,"fl-button",7),s.nc("click",function(){return s.Qc(e),s.rc().handleClick(!0)}),s.cc(7,8),s.sc(8,"flAsync"),s.Xb(),s.Yb(9,"fl-button",9),s.nc("click",function(){return s.Qc(e),s.rc().handleClick(!1)}),s.cc(10,10),s.sc(11,"flAsync"),s.Xb(),s.Xb(),s.ad(12,se,2,5,"fl-banner-alert",11),s.Vb()}if(2&e){const e=s.rc();s.Gb(1),s.zc("flHide",e.alreadyConfirming),s.Gb(1),s.zc("color",e.color)("display","block")("ngClass",e.displayClass)("disabled",s.tc(3,13,e.disabledSubject$))("busy",e.busy),s.Gb(2),s.ed(" ",e.element.label," "),s.Gb(1),s.zc("flHide",!e.alreadyConfirming),s.Gb(1),s.zc("color",e.ButtonColor.SUCCESS)("disabled",s.tc(8,15,e.disabledSubject$)),s.Gb(3),s.zc("color",e.ButtonColor.DEFAULT)("disabled",s.tc(11,17,e.disabledSubject$)),s.Gb(3),s.zc("ngIf",e.currErrText)}}let re=(()=>{class e{constructor(e,t,i){this.changeDetectorRef=e,this.router=t,this.richMessagesRequests=i,this.ButtonColor=$.a,this.BannerAlertType=B.c,this.Margin=z.a,this.displayType="default",this.link="",this.richMessageValuesChange=new s.n,this.buttonPressFired=new s.n,this.submissionSuccess=new s.n,this.busy=!1,this.subscriptions=[],this.color=$.a.DEFAULT,this.alreadyConfirming=!1,this.displayClass="",this.displayTypeMap={success:$.a.SUCCESS,info:$.a.DEFAULT,blue:$.a.SECONDARY,green:$.a.SUCCESS,default:$.a.DEFAULT,"post-project":$.a.PRIMARY}}ngOnInit(){switch(this.color=this.displayTypeMap[this.displayType]||$.a.DEFAULT,this.displayType){case"link-heading":this.color=$.a.DEFAULT,this.displayClass="LinkHeading"}this.transformedLink=Object(R.q)(this.link),this.subscriptions.push(this.validInputElementsSubject$.subscribe(e=>{if(!e)return this.disabledSubject$.next(!1),void(this.busy=!1);this.alreadyConfirming=!1;const{action:t}=this.element,i=Object.assign(Object.assign({},this.element.request),{payload:Object.assign(Object.assign({},this.element.request.payload),this.richMessageValues)});if("REDIRECT"===t.toUpperCase()){const e=i.url.replace(/^(?:\/\/|[^/]+)*\//,"").split("?"),t=e[1].split("&").reduce((e,t)=>{const i=t.split("=");return Object.assign(Object.assign({},e),{[i[0]]:i[1]})},{});this.router.navigate([e[0]],{queryParams:t}).then(e=>{this.busy=!1,e?this.disabledSubject$.next(!0):this.currErrText="Error: Failed to redirect."})}else this.subscriptions.push(this.richMessagesRequests.request(i,t,this.messageId).subscribe(e=>{this.busy=!1,"error"===e.status?(this.disabledSubject$.next(!1),this.currErrText=e.errorCode&&this.element.errors&&this.element.errors[e.errorCode]?this.element.errors[e.errorCode]:"Unknown error."):(this.currErrText="",this.submissionSuccess.emit(!0)),this.changeDetectorRef.markForCheck()}))}))}ngOnDestroy(){this.subscriptions.forEach(e=>e.unsubscribe())}handleClick(e=!0){const t=()=>{this.busy=!0,this.disabledSubject$.next(!0),this.buttonPressFired.emit(!0)};this.element.confirm?e&&this.alreadyConfirming?t():this.alreadyConfirming=e:t(),this.changeDetectorRef.markForCheck()}}return e.\u0275fac=function(t){return new(t||e)(s.Sb(s.h),s.Sb(U.e),s.Sb(q))},e.\u0275cmp=s.Mb({type:e,selectors:[["app-button-input"]],inputs:{element:"element",displayType:"displayType",messageId:"messageId",link:"link",disabledSubject$:"disabledSubject$",validInputElementsSubject$:"validInputElementsSubject$",richMessageValues:"richMessageValues",currentUserId:"currentUserId"},outputs:{richMessageValuesChange:"richMessageValuesChange",buttonPressFired:"buttonPressFired",submissionSuccess:"submissionSuccess"},decls:2,vars:2,consts:function(){let e,t;return e=" Confirm ",t=" Cancel ",[[4,"ngIf"],["flTrackingLabel","rich-message-button",3,"link","queryParams","fragment",4,"ngIf","ngIfElse"],["buttonLink",""],["flTrackingLabel","rich-message-button",3,"link","queryParams","fragment"],["flTrackingLabel","rich-message-button",3,"color","display","link","queryParams","fragment"],[3,"flHide"],["flTrackingLabel","rich-message-button",3,"color","display","ngClass","disabled","busy","click"],["flTrackingLabel","rich-message-button","data-uitest-target","richmessage-confirm",1,"ConfirmButton",3,"color","disabled","click"],e,["flTrackingLabel","rich-message-button",3,"color","disabled","click"],t,["class","Error",3,"type","closeable","flMarginBottom",4,"ngIf"],[1,"Error",3,"type","closeable","flMarginBottom"],[3,"link","content"]]},template:function(e,t){1&e&&(s.ad(0,ae,4,2,"ng-container",0),s.ad(1,oe,13,19,"ng-container",0)),2&e&&(s.zc("ngIf","REDIRECT"===t.element.action),s.Gb(1),s.zc("ngIf","REDIRECT"!==t.element.action))},directives:[r.q,K.b,u.a,$.b,o.a,Z.a,J.a,r.o,B.a,z.b,ee.a],pipes:[te.a],styles:[".Error[_ngcontent-%COMP%]{word-break:break-word;word-wrap:break-word;margin-top:4px}.ConfirmButton[_ngcontent-%COMP%]{margin-right:8px}.LinkHeading[_ngcontent-%COMP%]{font-weight:700;text-align:left}"],changeDetection:0}),e})(),ce=(()=>{class e{constructor(){this.BannerAlertType=B.c,this.Margin=z.a}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Mb({type:e,selectors:[["app-alert"]],inputs:{element:"element"},decls:2,vars:5,consts:[[3,"type","closeable","flMarginBottom"],[3,"link","content"]],template:function(e,t){1&e&&(s.Yb(0,"fl-banner-alert",0),s.Tb(1,"fl-interactive-text",1),s.Xb()),2&e&&(s.zc("type","success"===t.element.alert_type?t.BannerAlertType.SUCCESS:t.BannerAlertType.ERROR)("closeable",!1)("flMarginBottom",t.Margin.XXSMALL),s.Gb(1),s.zc("link",!0)("content",t.element.text))},directives:[B.a,z.b,ee.a],encapsulation:2,changeDetection:0}),e})();const le=["inputel"];function de(e,t){if(1&e&&s.Tb(0,"app-heading",10),2&e){const e=s.rc(2).$implicit,t=s.rc(2);s.zc("isOldChatbox",t.isOldChatbox)("element",e)}}function he(e,t){if(1&e&&s.Tb(0,"app-body",11),2&e){const e=s.rc(2).$implicit;s.zc("element",e)}}function ge(e,t){if(1&e){const e=s.Zb();s.Yb(0,"app-text-input",12,13),s.nc("richMessageValuesChange",function(t){return s.Qc(e),s.rc(4).richMessageValues=t}),s.sc(2,"flAsync"),s.Xb()}if(2&e){const e=s.rc(2).$implicit,t=s.rc(2);s.zc("element",e)("disabled",s.tc(2,3,t.disabledSubject$))("richMessageValues",t.richMessageValues)}}function ue(e,t){if(1&e){const e=s.Zb();s.Yb(0,"app-radio-input",12),s.nc("richMessageValuesChange",function(t){return s.Qc(e),s.rc(4).richMessageValues=t}),s.sc(1,"flAsync"),s.Xb()}if(2&e){const e=s.rc(2).$implicit,t=s.rc(2);s.zc("element",e)("disabled",s.tc(1,3,t.disabledSubject$))("richMessageValues",t.richMessageValues)}}function be(e,t){if(1&e){const e=s.Zb();s.Yb(0,"app-checkbox-input",12,13),s.nc("richMessageValuesChange",function(t){return s.Qc(e),s.rc(4).richMessageValues=t}),s.sc(2,"flAsync"),s.Xb()}if(2&e){const e=s.rc(2).$implicit,t=s.rc(2);s.zc("element",e)("disabled",s.tc(2,3,t.disabledSubject$))("richMessageValues",t.richMessageValues)}}function fe(e,t){if(1&e){const e=s.Zb();s.Yb(0,"app-number-input",12,13),s.nc("richMessageValuesChange",function(t){return s.Qc(e),s.rc(4).richMessageValues=t}),s.sc(2,"flAsync"),s.Xb()}if(2&e){const e=s.rc(2).$implicit,t=s.rc(2);s.zc("element",e)("disabled",s.tc(2,3,t.disabledSubject$))("richMessageValues",t.richMessageValues)}}function pe(e,t){if(1&e){const e=s.Zb();s.Yb(0,"app-select-input",12),s.nc("richMessageValuesChange",function(t){return s.Qc(e),s.rc(4).richMessageValues=t}),s.sc(1,"flAsync"),s.Xb()}if(2&e){const e=s.rc(2).$implicit,t=s.rc(2);s.zc("element",e)("disabled",s.tc(1,3,t.disabledSubject$))("richMessageValues",t.richMessageValues)}}function me(e,t){if(1&e){const e=s.Zb();s.Yb(0,"app-button-input",14),s.nc("richMessageValuesChange",function(t){return s.Qc(e),s.rc(4).richMessageValues=t})("buttonPressFired",function(){return s.Qc(e),s.rc(4).handleButtonPress()})("submissionSuccess",function(){return s.Qc(e),s.rc(4).handleSubmissionSuccess()}),s.Xb()}if(2&e){const e=s.rc(2).$implicit,t=s.rc(2);s.zc("element",e)("link",e.request.url)("displayType",e.displayType)("messageId",t.messageId)("disabledSubject$",t.disabledSubject$)("validInputElementsSubject$",t.validInputElementsSubject$)("richMessageValues",t.richMessageValues)("currentUserId",t.currentUserId)}}function Ce(e,t){if(1&e&&s.Tb(0,"app-alert",11),2&e){const e=s.rc(2).$implicit;s.zc("element",e)}}function Me(e,t){if(1&e&&(s.Wb(0),s.ad(1,de,1,2,"app-heading",6),s.ad(2,he,1,1,"app-body",7),s.ad(3,ge,3,5,"app-text-input",8),s.ad(4,ue,2,5,"app-radio-input",8),s.ad(5,be,3,5,"app-checkbox-input",8),s.ad(6,fe,3,5,"app-number-input",8),s.ad(7,pe,2,5,"app-select-input",8),s.ad(8,me,1,8,"app-button-input",9),s.ad(9,Ce,1,1,"app-alert",7),s.Vb()),2&e){const e=s.rc().$implicit;s.Gb(1),s.zc("ngIf","heading"===e.type),s.Gb(1),s.zc("ngIf","body"===e.type),s.Gb(1),s.zc("ngIf","text-input"===e.type),s.Gb(1),s.zc("ngIf","radio"===e.type),s.Gb(1),s.zc("ngIf","checkbox"===e.type),s.Gb(1),s.zc("ngIf","number"===e.type),s.Gb(1),s.zc("ngIf","select"===e.type),s.Gb(1),s.zc("ngIf","button"===e.type),s.Gb(1),s.zc("ngIf","alert"===e.type)}}function Se(e,t){if(1&e&&(s.Wb(0,4),s.ad(1,Me,10,9,"ng-container",5),s.Vb()),2&e){const e=t.$implicit,i=s.rc(2);s.Gb(1),s.zc("ngIf",i.shouldDisplay(e))}}function xe(e,t){if(1&e&&(s.Yb(0,"fl-bit",2),s.ad(1,Se,2,1,"ng-container",3),s.Xb()),2&e){const e=t.$implicit;s.Gb(1),s.zc("ngForOf",e)}}const ye=function(e){return{OldChatbox:e}};let Te=(()=>{class e{constructor(){this.isOldChatbox=!0,this.disabledSubject$=new n.a(!1),this.validInputElementsSubject$=new a.a,this.richMessageValues={}}ngOnChanges(e){void 0!==e.richMessage&&(this.disabledSubject$.next(!!this.richMessage.disabled),this.submissionSuccessful=!(!this.richMessage.latestSubmissions||!this.richMessage.latestSubmissions[this.currentUserId]||200!==this.richMessage.latestSubmissions[this.currentUserId].status_code))}handleButtonPress(){const e=this.validatables.map(e=>e.validate());this.validInputElementsSubject$.next(e.every(e=>e))}handleSubmissionSuccess(){this.submissionSuccessful=!0}shouldDisplay(e){return!(e.hide_on_success&&this.submissionSuccessful||e.show_on_success&&!this.submissionSuccessful)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Mb({type:e,selectors:[["app-rich-message"]],viewQuery:function(e,t){if(1&e&&s.jd(le,1),2&e){let e;s.Mc(e=s.oc())&&(t.validatables=e)}},inputs:{richMessage:"richMessage",messageId:"messageId",currentUserId:"currentUserId",isOldChatbox:"isOldChatbox"},features:[s.Eb],decls:2,vars:4,consts:[[3,"ngClass"],["class","Group",4,"ngFor","ngForOf"],[1,"Group"],["flTrackingSection","rich-message",4,"ngFor","ngForOf"],["flTrackingSection","rich-message"],[4,"ngIf"],[3,"isOldChatbox","element",4,"ngIf"],[3,"element",4,"ngIf"],[3,"element","disabled","richMessageValues","richMessageValuesChange",4,"ngIf"],[3,"element","link","displayType","messageId","disabledSubject$","validInputElementsSubject$","richMessageValues","currentUserId","richMessageValuesChange","buttonPressFired","submissionSuccess",4,"ngIf"],[3,"isOldChatbox","element"],[3,"element"],[3,"element","disabled","richMessageValues","richMessageValuesChange"],["inputel",""],[3,"element","link","displayType","messageId","disabledSubject$","validInputElementsSubject$","richMessageValues","currentUserId","richMessageValuesChange","buttonPressFired","submissionSuccess"]],template:function(e,t){1&e&&(s.Yb(0,"fl-bit",0),s.ad(1,xe,2,1,"fl-bit",1),s.Xb()),2&e&&(s.zc("ngClass",s.Ec(2,ye,t.isOldChatbox)),s.Gb(1),s.zc("ngForOf",t.richMessage.long))},directives:[o.a,r.o,r.p,c.a,r.q,l,d,f,x,A,k,P,re,ce],pipes:[te.a],styles:[".OldChatbox[_ngcontent-%COMP%]{background-color:#fff;box-shadow:0 0 4px 0 rgba(0,0,0,.08),0 2px 4px 0 rgba(0,0,0,.12);display:flex;flex-direction:column;margin:16px;max-width:400px;padding:16px}.Group[_ngcontent-%COMP%]{display:block}.Group[_ngcontent-%COMP%]:not(:last-child){margin-bottom:8px}.Group[_ngcontent-%COMP%]:not(:first-child){margin-top:16px}"],changeDetection:0}),e})()},AvnH:function(e,t,i){"use strict";i.d(t,"a",function(){return o});var n=i("mrSG"),a=i("2Vo4"),s=i("8Y7J");let o=(()=>{class e{constructor(){this.templateConfigSubject$=new a.a(void 0)}registerHeader(e){var t;if(null===(t=this.templateConfigSubject$.value)||void 0===t?void 0:t.templateRef)throw new Error("Could not register view header component: a view header already exists!");this.templateConfigSubject$.next(e)}registerSubtitle(e){var t,i;if(!(null===(t=this.templateConfigSubject$.value)||void 0===t?void 0:t.templateRef))throw new Error("Could not register view header subtitle without the primary view header");if(null===(i=this.templateConfigSubject$.value)||void 0===i?void 0:i.subtitleTemplateRef)throw new Error("Could not register view header subtitle: a subtitle already exists!");e&&this.templateConfigSubject$.next(Object.assign(Object.assign({},this.templateConfigSubject$.value),{subtitleTemplateRef:e}))}registerCustomAction(e){var t,i;if(!(null===(t=this.templateConfigSubject$.value)||void 0===t?void 0:t.templateRef))throw new Error("Could not register view header custom action without the primary view header");if(null===(i=this.templateConfigSubject$.value)||void 0===i?void 0:i.customActionTemplateRef)throw new Error("Could not register view header custom action: a custom action already exists!");e&&this.templateConfigSubject$.next(Object.assign(Object.assign({},this.templateConfigSubject$.value),{customActionTemplateRef:e}))}deregisterHeader(e){var t;(null===(t=this.templateConfigSubject$.value)||void 0===t?void 0:t.templateRef)===e.templateRef&&this.templateConfigSubject$.next(void 0)}deregisterSubtitle(e){var t;if((null===(t=this.templateConfigSubject$.value)||void 0===t?void 0:t.subtitleTemplateRef)===e){const e=this.templateConfigSubject$.value,t=Object(n.d)(e,["subtitleTemplateRef"]);this.templateConfigSubject$.next(t)}}deregisterCustomAction(e){var t;if((null===(t=this.templateConfigSubject$.value)||void 0===t?void 0:t.customActionTemplateRef)===e){const e=this.templateConfigSubject$.value,t=Object(n.d)(e,["customActionTemplateRef"]);this.templateConfigSubject$.next(t)}}templateChanges(){return this.templateConfigSubject$.asObservable()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=s.Ob({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},CJMb:function(e,t,i){"use strict";i.d(t,"a",function(){return h});var n=i("9u4R"),a=i("tqRt"),s=i("OpNG"),o=i("cUs2");function r(){return{defaultOrder:{field:"id",direction:s.a.ASC},fetch:(e,t,i)=>({endpoint:"support/0.1/agents/",params:{agents:t,users:Object(o.h)(i,"userId"),support_types:Object(o.h)(i,"type"),agent_states:Object(o.h)(i,"state")}}),push:void 0,set:void 0,update:(e,t,i)=>({endpoint:`support/0.1/agents/${i.id}/state`,method:"POST",payload:{state:t.state}}),remove:void 0}}function c(e){return{id:e.id,userId:e.user_id,owner:e.owner||void 0,type:e.support_type,createTime:1e3*e.create_time,state:e.state}}function l(e={},t){switch(t.type){case"API_FETCH_SUCCESS":if("agents"===t.payload.type){const{result:i,ref:n,order:a}=t.payload;return i.agents?Object(o.o)(e,Object(o.z)(i.agents,c),a,n):e}return e;case"API_UPDATE":if("agents"===t.payload.type){const{delta:i,ref:n,originalDocument:a}=t.payload;return Object(o.q)(e,Object(o.z)([Object(s.e)(a,i)],e=>e),n)}return e;case"API_UPDATE_SUCCESS":if("agents"===t.payload.type){const{result:i,ref:n}=t.payload;return Object(o.q)(e,Object(o.z)([i.agent],c),n)}return e;case"API_UPDATE_ERROR":if("agents"===t.payload.type){const{originalDocument:i,ref:n}=t.payload;return Object(o.q)(e,Object(o.z)([i],e=>e),n)}return e;case"WS_MESSAGE":{const{payload:i}=t;if("supportAgent"===i.type)switch(i.data.type){case"available":case"unavailable":case"away":return Object(o.b)(e,[i.data.agent],c,{path:{collection:"agents",authUid:i.toUserId}});default:return e}return e}default:return e}}var d=i("8Y7J");let h=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=d.Qb({type:e}),e.\u0275inj=d.Pb({imports:[[a.j.forFeature("agents",l),n.d.forFeature("agents",r)]]}),e})()},IvPS:function(e,t,i){"use strict";i.d(t,"a",function(){return p});var n=i("8Y7J"),a=i("QrFh"),s=i("9Aot"),o=i("Rnop"),r=i("o9eT"),c=i("JX91"),l=i("s7LF"),d=i("SVse"),h=i("w13q");const g=function(e){return{IsFocus:e}};function u(e,t){if(1&e&&(n.Yb(0,"fl-bit",3),n.Yb(1,"fl-text",4),n.cc(2,5),n.Xb(),n.Xb()),2&e){const e=n.rc();n.Gb(1),n.zc("ngClass",n.Ec(5,g,!0===e.textareaFocused))("color",e.maxCharacter-(null==e.control.value?null:e.control.value.length)>=0?e.FontColor.DARK:e.FontColor.ERROR)("size",e.TextSize.XSMALL)("fontType",e.FontType.PARAGRAPH),n.Gb(1),n.gc(e.maxCharacter-(null==e.control.value?null:e.control.value.length)),n.dc(2)}}function b(e,t){if(1&e&&(n.Yb(0,"fl-text",6),n.cd(1),n.Xb()),2&e){const e=n.rc();n.zc("color",e.FontColor.ERROR)("size",e.TextSize.XXSMALL),n.Gb(1),n.ed(" ",e.error," ")}}const f=function(e){return{Error:e}};let p=(()=>{class e{constructor(e){this.cd=e,this.FontColor=o.a,this.FontType=r.b,this.TextSize=r.f,this.Margin=s.a,this.textareaFocused=!1,this.borderless=!1,this.placeholder="",this.rows=2,this.inputBlur=new n.n,this.inputFocus=new n.n}set disabled(e){this.attrDisabled=!!e||void 0}ngOnInit(){this.errorSubscription=this.control.statusChanges.pipe(Object(c.a)(this.control.status)).subscribe(()=>{[this.error]=Object.values(this.control.errors||{}),this.cd.markForCheck()})}ngOnDestroy(){this.errorSubscription&&this.errorSubscription.unsubscribe()}handleBlur(){this.textareaFocused=!1,this.inputBlur.emit()}handleFocus(){this.textareaFocused=!this.textareaFocused,this.inputFocus.emit()}insertAtCursor(e,t={paddedWithSpaces:!1}){const i=this.control.value;if(i){const{selectionStart:n,selectionEnd:a}=this.controlValueAccessorDirective.getCursorSelectionPosition(),s=`${t.paddedWithSpaces&&0!==n&&!/\s/.test(i[n-1])?" ":""}${e}${t.paddedWithSpaces&&a!==i.length&&!/\s/.test(i[a])?" ":""}`;this.control.setValue(`${i.substring(0,n)}${s}${i.substring(a)}`),this.controlValueAccessorDirective.setCursorPosition(n+s.length)}else this.control.setValue(e),this.controlValueAccessorDirective.setCursorPosition(e.length)}}return e.\u0275fac=function(t){return new(t||e)(n.Sb(n.h))},e.\u0275cmp=n.Mb({type:e,selectors:[["fl-textarea"]],viewQuery:function(e,t){if(1&e&&n.jd(a.a,1),2&e){let e;n.Mc(e=n.oc())&&(t.controlValueAccessorDirective=e.first)}},inputs:{id:"id",control:"control",borderless:"borderless",placeholder:"placeholder",rows:"rows",maxCharacter:"maxCharacter",maxLength:"maxLength",disabled:"disabled"},outputs:{inputBlur:"inputBlur",inputFocus:"inputFocus"},decls:3,vars:13,consts:function(){let e;return e=" " + "\ufffd0\ufffd" + " ",[["flControlValueAccessor","",1,"TextArea",3,"formControl","ngClass","flMarginBottom","focus","blur"],["class","CountCharacterWrapper",4,"ngIf"],[3,"color","size",4,"ngIf"],[1,"CountCharacterWrapper"],[1,"Counter",3,"ngClass","color","size","fontType"],e,[3,"color","size"]]},template:function(e,t){1&e&&(n.Yb(0,"textarea",0),n.nc("focus",function(){return t.handleFocus()})("blur",function(){return t.handleBlur()}),n.Xb(),n.ad(1,u,3,7,"fl-bit",1),n.ad(2,b,2,3,"fl-text",2)),2&e&&(n.zc("formControl",t.control)("ngClass",n.Ec(11,f,t.control.invalid&&(t.control.touched||t.control.dirty)))("flMarginBottom",t.control.invalid&&(t.control.touched||t.control.dirty)?t.Margin.XXXSMALL:void 0),n.Hb("id",t.id)("data-borderless",t.borderless)("placeholder",t.placeholder)("maxlength",t.maxLength?t.maxLength:null)("rows",t.rows)("disabled",t.attrDisabled),n.Gb(1),n.zc("ngIf",void 0!==t.maxCharacter&&!(t.control.invalid&&(t.control.touched||t.control.dirty))),n.Gb(1),n.zc("ngIf",t.control.invalid&&(t.control.touched||t.control.dirty)))},directives:[l.c,a.a,l.k,l.o,l.g,d.o,s.b,d.q,h.a,r.e],styles:[".TextArea[_ngcontent-%COMP%], [_nghost-%COMP%]{display:block}.TextArea[_ngcontent-%COMP%]{font-size:14px;line-height:1.43;align-items:center;background:#fff;border:1px solid #bec0c2;border-radius:0;color:#0e1724;max-height:inherit;padding:12px;resize:vertical;transition:all .2s ease-out;width:100%}.TextArea[_ngcontent-%COMP%]:-ms-input-placeholder{color:#75787d}.TextArea[_ngcontent-%COMP%]::placeholder{color:#75787d}.TextArea[_ngcontent-%COMP%]:focus, .TextArea[_ngcontent-%COMP%]:hover{border-color:#139ff0;color:#0e1724;outline:0}.TextArea[disabled][_ngcontent-%COMP%]{background:#f7f7f7;color:#0e1724;cursor:not-allowed}.TextArea.IsInvalid[_ngcontent-%COMP%]{border-color:#eb3730}.TextArea.IsInvalid[data-borderless=true][_ngcontent-%COMP%], .TextArea.IsInvalid[data-borderless=true][_ngcontent-%COMP%]:focus{border-bottom-color:#eb3730}.TextArea[data-borderless=true][_ngcontent-%COMP%]{background-color:transparent;border:1px solid transparent;padding-left:0;padding-right:0;transition:all .2s ease-out}.TextArea[data-borderless=true][_ngcontent-%COMP%]:focus{border-bottom-color:#139ff0}.TextArea[data-borderless=true][_ngcontent-%COMP%]:hover{box-shadow:none}.CountCharacterWrapper[_ngcontent-%COMP%]{text-align:right}.Counter[_ngcontent-%COMP%]{opacity:0}.Counter.IsFocus[_ngcontent-%COMP%]{opacity:1}"],changeDetection:0}),e})()},MmDv:function(e,t,i){"use strict";i.d(t,"a",function(){return p}),i.d(t,"b",function(){return m});var n=i("3f1L"),a=i("KPk5"),s=i("tsv4"),o=i("n0rP"),r=i("/uUt"),c=i("lJxs"),l=i("JX91"),d=i("b6KT");const h=(e,t)=>t===e.projectOwnerId,g=e=>"awarded"===e.awardStatus,u=e=>"pending"===e.awardStatus,b=(e,t)=>g(e)&&!h(e,t),f=e=>void 0===e.invalidTime&&void 0===e.timeTrackingStopped&&"automatic"===e.invoicePaymentMethod,p=["contest","hire","project","projectAdmin","userAdmin","recruiterSupportSession"];class m{constructor(e,t,i,n,a,s,o,r,c,l,d,h,g){this.auth=e,this.thread$=t,this.threadMembers$=i,this.project$=n,this.contest$=a,this.bids$=s,this.milestones$=o,this.milestoneRequests$=r,this.hourlyContracts$=c,this.agentSession$=l,this.team$=d,this.failedInvoices$=h,this.tracking=g}getState(){return Object(n.a)([this.auth.authState$,this.startWithUndefined(this.threadMembers$),this.thread$.pipe(Object(r.a)()),this.startWithUndefined(this.project$),this.startWithUndefined(this.contest$),this.startWithUndefined(this.bids$),this.startWithUndefined(this.milestones$),this.startWithUndefined(this.milestoneRequests$),this.startWithUndefined(this.hourlyContracts$),this.startWithUndefined(this.agentSession$),this.startWithUndefined(this.team$),this.startWithUndefined(this.failedInvoices$)]).pipe(Object(c.a)(e=>this.cleanState(e)),Object(c.a)(e=>this.getContextState(e,this.tracking)),Object(r.a)())}getContextState([e,t,i,n,o,r,c,l,p,m,C,M],S){if(!i||!e)return;const x=Number(e.userId),y=function(e,t,i){return i.filter(i=>i.bidderId===e||t.length<3&&t.includes(i.bidderId))[0]}(x,i.members,r||[]),T=t?t.find(t=>e&&t.id===x):void 0,I=t?t.find(t=>!(!e||t.id===x)):void 0,O=function(e,t,i){return i.filter(i=>i.bidderId===e||t.length<3&&t.includes(i.bidderId||-1))}(x,i.members,c||[]),v=function(e,t,i){return i.filter(i=>i.bidderId===e||t.length<3&&t.includes(i.bidderId||-1))}(x,i.members,l||[]);if(S&&S.trackCustomEvent("DebugMessagingRecruiter",void 0,{threadId:i.id,threadType:i.threadType,contextId:i.context.type!==s.ContextTypeApi.NONE?i.context.id:-1,contextType:i.contextType,isSupportUser:Object(d.f)(T).toString()}),I&&!(i.context.type===s.ContextTypeApi.TEAM||i.threadType===s.ThreadTypeApi.TEAM&&C&&x!==C.ownerUserId)){if((i.threadType===s.ThreadTypeApi.ADMIN_PREFERRED_CHAT||i.threadType===s.ThreadTypeApi.GROUP)&&i.context.type===s.ContextTypeApi.SUPPORT_SESSION&&t&&t.some(d.f))return Object(d.f)(T)?this.projectAdminLink(I,n,m):this.projectLink(I,n);if(i.threadType&&i.threadType.toLowerCase()===s.ThreadTypeApi.GROUP)return this.projectLink(I,n);if(o)return{name:"contest",linkText:o.title,linkUrl:`/${o.seoUrl}`,otherUserName:I.displayName,timeSubmitted:o.timeSubmitted,contextId:o.id};if(n&&"draft"===n.status)return this.projectLink(I,n);if(n&&n.projectCollaborations&&n.projectCollaborations.length&&(n.projectCollaborations.filter(e=>e.userId).map(e=>e.userId).includes(x)||n.projectCollaborations.filter(e=>e.userId).map(e=>e.userId).includes(I.id)))return this.projectLink(I,n);if("private_chat"!==i.threadType||n){if("primary"===i.threadType)return{name:"hireme",otherUserName:I.displayName,button:{data:{type:"LINK",buttonUrl:`/u/${I.username}`,buttonExtras:{queryParams:{hireme:!0}}},tag:"chatbox-hireme-button"}};if(void 0===y)return this.projectLink(I,n);if(((e,t)=>!g(e)&&!u(e)&&h(e,t))(y,x)&&n&&!n.hireme)return"hourly"===n.type?{name:"projectAwardHourly",linkText:n.title,linkUrl:`/projects/${n.seoUrl}`,button:{data:{type:"LINK",buttonUrl:`/projects/${n.seoUrl}`,buttonExtras:{queryParams:{awardBid:y.id}}},tag:"chatbox-award-button"},otherUserName:I.displayName,timeSubmitted:n.timeSubmitted,contextId:n.id}:{name:"projectAwardFixed",linkText:n.title,linkUrl:`/projects/${n.seoUrl}`,button:{data:{type:"AWARD_FIXED",bidId:y.id,bidderId:y.bidderId,projectId:n.id},tag:"chatbox-award-button"},otherUserName:I.displayName,timeSubmitted:n.timeSubmitted,contextId:n.id};if(((e,t)=>!g(e)&&!(e=>"revoked"===e.awardStatus)(e)&&u(e)&&!h(e,t))(y,x)){if(n&&n.hireme&&n.isEscrowProject)return{name:"projectAcceptRedirect",linkText:n.title,linkUrl:`/projects/${n.seoUrl}`,button:{data:{type:"LINK",buttonUrl:`/projects/${n.seoUrl}`},tag:"chatbox-accept-button"},otherUserName:I.displayName,timeSubmitted:n.timeSubmitted,contextId:n.id};if(n&&"hourly"===n.type)return{name:"projectAcceptHourly",linkText:n.title,linkUrl:`/projects/${n.seoUrl}`,button:{data:{type:"ACCEPT",projectId:n.id,bidId:y.id},tag:"chatbox-accept-button"},otherUserName:I.displayName,timeSubmitted:n.timeSubmitted,contextId:n.id};if(n)return{name:"projectAcceptFixed",linkText:n.title,linkUrl:`/projects/${n.seoUrl}`,button:{data:{type:"ACCEPT",projectId:n.id,bidId:y.id},tag:"chatbox-accept-button"},otherUserName:I.displayName,timeSubmitted:n.timeSubmitted,contextId:n.id}}if((g(y)||u(y))&&h(y,x)&&T){if(n&&p&&p.length&&0===p.filter(f).length)return{name:"setupBilling",linkText:n.title,linkUrl:`/projects/${n.seoUrl}`,button:{data:{type:"LINK",buttonUrl:`/projects/${n.seoUrl}`},tag:"chatbox-billing-button"},otherUserName:I.displayName,timeSubmitted:n.timeSubmitted,contextId:n.id};if(n&&n.isEscrowProject)return{name:"milestoneCreateRedirect",linkText:n.title,linkUrl:`/projects/${n.seoUrl}`,button:{data:{type:"LINK",buttonUrl:`/projects/${n.seoUrl}`},tag:"chatbox-create-milestone-button"},otherUserName:I.displayName,timeSubmitted:n.timeSubmitted,contextId:n.id};if(n&&n.timeSubmitted>a.a&&M&&M.length>0)return{name:"payFailedInvoices",linkText:n.title,linkUrl:`projects/${n.seoUrl}`,button:{data:{type:"LINK",buttonUrl:`/projects/${n.seoUrl}/payments`},tag:"chatbox-redirect-payments-page"},otherUserName:I.displayName,timeSubmitted:n.timeSubmitted,contextId:n.id};if(n&&v.length>0)return{name:"milestoneCreateFromRequest",linkText:n.title,linkUrl:`/projects/${n.seoUrl}`,button:{data:{type:"CREATE_MILESTONE",projectId:n.id,bidderId:y.bidderId,bidId:y.id,employerUsername:T.username,currencyDetails:n.currency},tag:"chatbox-create-milestone-button"},otherUserName:I.displayName,timeSubmitted:n.timeSubmitted,contextId:n.id};if(0===O.length&&n)return{name:"milestoneCreateInitial",linkText:n.title,linkUrl:`/projects/${n.seoUrl}`,button:{data:{type:"CREATE_MILESTONE",projectId:n.id,bidderId:y.bidderId,bidId:y.id,employerUsername:T.username,currencyDetails:n.currency},tag:"chatbox-create-milestone-button"},otherUserName:I.displayName,timeSubmitted:n.timeSubmitted,contextId:n.id};if(n)return{name:"milestoneCreate",linkText:n.title,linkUrl:`/projects/${n.seoUrl}`,button:{data:{type:"CREATE_MILESTONE",projectId:n.id,bidderId:y.bidderId,bidId:y.id,employerUsername:T.username,currencyDetails:n.currency},tag:"chatbox-create-milestone-button"},otherUserName:I.displayName,timeSubmitted:n.timeSubmitted,contextId:n.id}}return n&&!n.local&&p&&!h(y,x)&&void 0!==y.timeAccepted&&p.filter(f).length>0?{name:"trackTime",linkText:n.title,linkUrl:`/projects/${n.seoUrl}`,button:{data:{type:"LINK",buttonUrl:`/projects/${n.seoUrl}/tracking`,buttonExtras:{fragment:`timetracker-${y.id}-invoice-0`}},tag:"chatbox-track-time-button"},otherUserName:I.displayName,timeSubmitted:n.timeSubmitted,contextId:n.id}:n&&n.isEscrowProject&&b(y,x)?{name:"requestMilestoneRedirect",linkText:n.title,linkUrl:`/projects/${n.seoUrl}`,button:{data:{type:"LINK",buttonUrl:`/projects/${n.seoUrl}`},tag:"chatbox-request-milestone-button"},otherUserName:I.displayName,timeSubmitted:n.timeSubmitted,contextId:n.id}:n&&b(y,x)?{name:"requestMilestone",linkText:n.title,linkUrl:`/projects/${n.seoUrl}`,button:{data:{type:"REQUEST_MILESTONE",bidId:y.id,projectId:n.id,employerUsername:I.displayName,currencyDetails:n.currency,bidderId:y.bidderId},tag:"chatbox-request-milestone-button"},otherUserName:I.displayName,timeSubmitted:n.timeSubmitted,contextId:n.id}:this.projectLink(I,n)}}}projectLink(e,t){if(t)return{name:"project",linkText:t.title,linkUrl:`/projects/${t.seoUrl}`,otherUserName:e.displayName,timeSubmitted:t.timeSubmitted,contextId:t.id}}projectAdminLink(e,t,i){return t?{name:"projectAdmin",linkUrl:"/admin/projects/properties.php",linkText:t.title,linkQueryParams:{id:t.id},otherUserName:e.displayName,timeSubmitted:t.timeSubmitted,contextId:t.id}:!t&&i&&i.sessionSourceType===o.SourceTypeApi.PROJECT?{name:"projectAdmin",linkUrl:"/admin/projects/properties.php",linkText:"Deleted project",linkQueryParams:{id:i.sessionSourceId},otherUserName:e.displayName,timeSubmitted:0}:!t&&i&&i.sessionSourceType===o.SourceTypeApi.USER?{name:"userAdmin",linkUrl:"/admin/users/properties.php",linkText:"View user",linkQueryParams:{id:i.sessionSourceId},otherUserName:e.displayName,timeSubmitted:0}:void 0}cleanState([e,t,i,n,a,r,c,l,d,h,g,u]){const b=n&&(i.context.type===s.ContextTypeApi.PROJECT&&i.context.id===n.id||h&&i.context.type===s.ContextTypeApi.SUPPORT_SESSION&&i.context.id===h.sessionId&&h.sessionSourceType===o.SourceTypeApi.PROJECT&&h.sessionSourceId===n.id),f="contest"===i.context.type&&a&&i.context.id===a.id,p=n&&"hourly"===n.type,m=h&&i.context.type===s.ContextTypeApi.SUPPORT_SESSION&&i.context.id===h.sessionId,C=u&&n&&u.every(e=>e.projectId===n.id);return[e,t,i,b?n:void 0,f?a:void 0,b?r:void 0,b?c:void 0,b?l:void 0,b&&p?d:void 0,m?h:void 0,g,C?u:void 0]}startWithUndefined(e){return e.pipe(Object(l.a)(void 0),Object(r.a)())}}},Np1b:function(e,t,i){"use strict";i.d(t,"a",function(){return H});var n=i("8Y7J"),a=i("s7LF"),s=i("jnZY"),o=i("fVXH"),r=i("riYv"),c=i("etQe"),l=i("UlxN"),d=i("os2j"),h=i("fYbj"),g=i("4ykm"),u=i("f6cb"),b=i("tsv4"),f=i("2Vo4"),p=i("itXk"),m=i("LRne"),C=i("05l1"),M=i("x+ZX"),S=i("vkgz"),x=i("pLZG"),y=i("lJxs"),T=i("/uUt"),I=i("JX91"),O=i("Zy1z"),v=i("zp1y"),A=i("5+tZ"),w=i("NJ9Y"),k=i("b6KT"),z=i("5f+h"),E=i("eCtd"),L=i("w792"),_=i("HEOu"),j=i("KrVf"),P=i("3A0Z"),R=i("YFxV"),B=i("DsW6");const $=["fileSelect"],U=["messageList"];function G(e,t){1&e&&(n.Yb(0,"fl-bit",8),n.Tb(1,"fl-spinner",9),n.Xb())}function N(e,t){1&e&&n.Tb(0,"app-messaging-message-list-empty")}function F(e,t){if(1&e){const e=n.Zb();n.Yb(0,"app-messaging-message-list",12,13),n.nc("loadMoreMessage",function(){return n.Qc(e),n.rc(2).loadMoreMessage()})("viewAttachment",function(t){return n.Qc(e),n.rc(2).viewAttachment(t)}),n.sc(2,"flAsync"),n.sc(3,"flAsync"),n.sc(4,"flAsync"),n.sc(5,"flAsync"),n.sc(6,"flAsync"),n.sc(7,"flAsync"),n.sc(8,"flAsync"),n.sc(9,"flAsync"),n.sc(10,"flAsync"),n.Xb()}if(2&e){const e=n.rc(2);let t=null,i=null;n.zc("isGroupChat",(null==(t=n.tc(2,9,e.thread$))?null:t.threadType)===e.ThreadTypeApi.GROUP)("loading",n.tc(3,11,e.messageListLoading$))("loggedInUser",n.tc(4,13,e.loggedInUser$))("messages",n.tc(5,15,e.sortedMessages$))("userReadTimes",null==(i=n.tc(6,17,e.thread$))?null:i.userReadTimes)("showLoadMore",n.tc(7,19,e.canLoadMoreMessages$))("thread",n.tc(8,21,e.thread$))("usersIsOnlineMap",n.tc(9,23,e.chatMembersIsOnlineMap$))("usersMap",n.tc(10,25,e.chatMembersMap$))}}function D(e,t){if(1&e&&(n.ad(0,N,1,0,"app-messaging-message-list-empty",10),n.sc(1,"flAsync"),n.ad(2,F,11,27,"ng-template",null,11,n.bd)),2&e){const e=n.Nc(3),t=n.rc();let i=null;n.zc("ngIf",0===(null==(i=n.tc(1,2,t.sortedMessages$))?null:i.length))("ngIfElse",e)}}function X(e,t){if(1&e){const e=n.Zb();n.Wb(0),n.Yb(1,"app-messaging-attachment-list",14),n.nc("removeAttachment",function(t){return n.Qc(e),n.rc().removeFile(t)})("successfulUpload",function(t){return n.Qc(e),n.rc().removeFile(t)})("retryUpload",function(t){return n.Qc(e),n.rc().retryUploadFile(t)}),n.sc(2,"flAsync"),n.Xb(),n.Tb(3,"fl-hr"),n.Vb()}if(2&e){const e=n.rc();n.Gb(1),n.zc("fileAttachmentMap",n.tc(2,1,e.fileAttachmentMapping$))}}var Y=function(e){return e[e.LOAD_THREAD=0]="LOAD_THREAD",e[e.LOAD_MORE_MESSAGES=1]="LOAD_MORE_MESSAGES",e}({});let H=(()=>{class e{constructor(e,t,i,a,s,o,r){this.datastore=e,this.featureFlagService=t,this.fileStorage=i,this.modalService=a,this.timeUtils=s,this.tracking=o,this.webSocketService=r,this.ThreadLoadingState=Y,this.ThreadTypeApi=b.ThreadTypeApi,this.usersTyping=new n.n,this.previewModalOpen=new n.n,this.previewModalClose=new n.n,this.MESSAGE_LIST_INCREMENT=50,this.MESSAGE_LIST_LIMIT_MAX=5e3,this._messagesLimitSubject$=new f.a(this.MESSAGE_LIST_INCREMENT),this.messagesLimit$=this._messagesLimitSubject$.asObservable(),this._loadingStateSubject$=new f.a(Y.LOAD_THREAD),this.loadingState$=this._loadingStateSubject$.asObservable(),this._fileAttachmentMappingSubject$=new f.a({}),this.fileAttachmentMapping$=this._fileAttachmentMappingSubject$.asObservable(),this._isFileAttachmentMappingEmptySubject$=new f.a(!0),this.isFileAttachmentMappingEmpty$=this._isFileAttachmentMappingEmptySubject$.asObservable(),this._messageSendQueueSubject$=new f.a([]),this.messageSendQueue$=this._messageSendQueueSubject$.asObservable().pipe(Object(C.a)(1),Object(M.a)()),this._usersTypingSubject$=new f.a({}),this.usersTypingMap$=this._usersTypingSubject$.asObservable()}ngOnInit(){this._allChatMembersSubject$=new f.a(this.allChatMembers),this.allChatMembers$=this._allChatMembersSubject$.asObservable(),this._loggedInUserSubject$=new f.a(this.loggedInUser),this.loggedInUser$=this._loggedInUserSubject$.asObservable(),this._membersActivityStatusSubject$=new f.a(this.membersActivityStatus),this.membersActivityStatus$=this._membersActivityStatusSubject$.asObservable(),this._threadSubject$=new f.a(this.thread),this.thread$=this._threadSubject$.asObservable(),this._threadIdentifierSubject$=new f.a(this.threadIdentifier),this.threadIdentifier$=this._threadIdentifierSubject$.asObservable();const e=this.datastore.collection("messages",e=>this.thread$.pipe(Object(S.a)(()=>{this._loadingStateSubject$.next(Y.LOAD_THREAD),this._messagesLimitSubject$.next(this.MESSAGE_LIST_INCREMENT)}),Object(x.a)(e=>!e.isFake&&e.id>0),Object(y.a)(e=>e.id),Object(T.a)(),Object(y.a)(t=>e.where("threadId","==",t).limit(this.messagesLimit$.pipe(Object(y.a)(e=>Math.min(e+1,this.MESSAGE_LIST_LIMIT_MAX))))))),t=e.valueChanges();this.messageListLoading$=e.status$.pipe(Object(y.a)(e=>!e.ready)),this.canLoadMoreMessages$=p.a([t,this.messagesLimit$]).pipe(Object(y.a)(([e,t])=>e.length>t&&e.length<this.MESSAGE_LIST_LIMIT_MAX)),this.sortedMessages$=p.a([t.pipe(Object(I.a)([])),this.messageSendQueue$,this.messagesLimit$]).pipe(Object(y.a)(([e,t,i])=>{const n={},a=e.slice(0,i).sort((e,t)=>e.timeCreated===t.timeCreated?e.id-t.id:e.timeCreated-t.timeCreated).reduceRight((e,t)=>{const i=JSON.parse(JSON.stringify(t));return i.richMessage&&(n[i.richMessage.category]&&(i.richMessage.disabled=!0),n[i.richMessage.category]=!0),[i,...e]},[]),s=new Set(a.map(e=>e.clientMessageId)),o=t.filter(e=>!s.has(e.clientMessageId));return[...a,...o]})),this.chatMembersMap$=this.allChatMembers$.pipe(Object(x.a)(u.g),Object(s.a)(),Object(I.a)({})),this.chatMembersIsOnlineMap$=this.membersActivityStatus$.pipe(Object(x.a)(u.g),Object(y.a)(e=>{const t={};return e.forEach(e=>t[e.id]=e.status===r.OnlineOfflineStatusApi.ONLINE),t}),Object(I.a)({})),this.filesSelectControl=new a.f([]),this.filesSelectControlSubscription$=this.filesSelectControl.valueChanges.subscribe(e=>{e.forEach(e=>{if(!Object.keys(this._fileAttachmentMappingSubject$.value).map(e=>e.slice(e.indexOf("_")+1)).some(t=>t===`${e.name}_${e.size}_${e.lastModified}`)){const t=this.getFileAttachmentKey(e),i=Object(h.i)(e.name)?this.fileSelect.readFileAsDataURL(e).pipe(Object(C.a)(1),Object(M.a)()):m.a("");this._fileAttachmentMappingSubject$.next(Object.assign(Object.assign({},this._fileAttachmentMappingSubject$.value),{[t]:{file:e,previewUrl$:i}})),this._isFileAttachmentMappingEmptySubject$.next(!1)}})});const i=this.featureFlagService.getFlag(l.b.FILEUPLOAD);this.filesSelectToggleSubscription$=p.a([this.messageListLoading$,this.loadingState$,i,this.thread$]).subscribe(([e,t,i,n])=>{!i||t!==Y.LOAD_MORE_MESSAGES&&e||!this.isLoggedInUserSupportAgent&&("none"===n.writePrivacy||n.isBlocked)?this.filesSelectControl.disable():this.filesSelectControl.enable()}),this.sortedMessagesSubscription$=p.a([this.sortedMessages$.pipe(Object(O.a)(),Object(x.a)(([e,t])=>e.length>0&&t.length>0)),this.loggedInUser$]).subscribe(([[e,t],i])=>{const n=t[t.length-1],a=e[e.length-1];n.fromUser!==i.id||Object(k.e)(n,a)||this.timeUtils.setTimeout(()=>this.showLastMessage())}),this.typingSubscription=this.webSocketService.fromServerStream$.pipe(Object(x.a)(o.a),Object(v.a)(this.thread$),Object(x.a)(([e,t])=>"messages"===e.body.parent_type&&"typing"===e.body.type&&e.body.data.thread===t.id),Object(y.a)(([e,t])=>e),Object(v.a)(this.sortedMessages$.pipe(Object(y.a)(e=>e.filter(e=>e.sendStatus===c.a.SENT))),this.thread$.pipe(Object(y.a)(e=>e.userReadTimes)))).subscribe(([e,t,i])=>{const n=Object(u.r)(e.body.data.from_user),a=t.pop(),s=!!a&&i[n]>=a.timeCreated&&(a.fromUser!==n||1e3*e.body.timestamp>a.timeCreated);this._usersTypingSubject$.next(Object.assign(Object.assign({},this._usersTypingSubject$.value),{[n]:s})),this.timeUtils.setTimeout(()=>{this._usersTypingSubject$.next(Object.assign(Object.assign({},this._usersTypingSubject$.value),{[n]:!1}))},z.b)}),this.usersTyping$=p.a([this.usersTypingMap$,this.chatMembersMap$]).pipe(Object(y.a)(([e,t])=>Object.entries(e).filter(([e,t])=>!!t).map(([e,i])=>t[Object(u.r)(e)]))),this.hasUnsentAttachments$=this.fileAttachmentMapping$.pipe(Object(y.a)(e=>Object.entries(e).some(([e,t])=>!t.uploadTask)),Object(I.a)(!1))}ngOnChanges(e){var t,i,n,a,s;e.allChatMembers&&(null===(t=this._allChatMembersSubject$)||void 0===t||t.next(e.allChatMembers.currentValue)),e.loggedInUser&&(null===(i=this._loggedInUserSubject$)||void 0===i||i.next(e.loggedInUser.currentValue)),e.membersActivityStatus&&(null===(n=this._membersActivityStatusSubject$)||void 0===n||n.next(e.membersActivityStatus.currentValue)),e.thread&&(null===(a=this._threadSubject$)||void 0===a||a.next(e.thread.currentValue)),e.threadIdentifier&&(null===(s=this._threadIdentifierSubject$)||void 0===s||s.next(e.threadIdentifier.currentValue))}loadMoreMessage(){this._loadingStateSubject$.next(Y.LOAD_MORE_MESSAGES),this._messagesLimitSubject$.next(Math.min(this._messagesLimitSubject$.getValue()+this.MESSAGE_LIST_INCREMENT,this.MESSAGE_LIST_LIMIT_MAX))}showLastMessage(){this.messageList&&this.messageList.scrollToBottom()}openFileSelect(){this.fileSelect&&this.fileSelect.triggerInput()}addFile(e){this.filesSelectControl.setValue([...this.filesSelectControl.value,e])}removeFile(e){var t;const i=this._fileAttachmentMappingSubject$.value;e in i&&(null===(t=i[e].uploadTask)||void 0===t||t.cancel(),delete i[e],this._fileAttachmentMappingSubject$.next(i)),this.isAttachmentListEmpty()&&(this._fileAttachmentMappingSubject$.next({}),this._isFileAttachmentMappingEmptySubject$.next(!0))}viewAttachment(e){const t=this.modalService.open("MessagingAttachmentModal",{inputs:{attachment:e},edgeToEdge:!0,size:g.a.XLARGE});t.afterOpen().toPromise().then(e=>setTimeout(()=>this.previewModalOpen.emit())),t.afterClosed().toPromise().then(()=>{this.previewModalClose.emit(),this.tracking.track("user_action",{section:"messaging_image_viewer",subsection:"header",label:"close_image_viewer"})})}enqueueMessage(e,t){const{message:i,threadIdentifier:n,sender:a}=e,s=Date.now(),o=!i||0===i.trim().length;n.isFake||this.sendFiles(n.id),n.isFake&&o&&t.length>0||o||(this._messageSendQueueSubject$.next([...this._messageSendQueueSubject$.getValue(),{attachments:[],clientMessageId:s,fromUser:a.id,id:s,message:i,messageSource:b.SourceTypeApi.CHAT_BOX,threadId:n.id,timeCreated:Date.now(),sendStatus:c.a.SENDING}]),1===this._messageSendQueueSubject$.getValue().length&&this.sendQueuedMessage())}sendQueuedMessage(){if(0===this._messageSendQueueSubject$.getValue().length)return;const e=this._messageSendQueueSubject$.getValue()[0];this.sendMessage(e).then(()=>{this._messageSendQueueSubject$.next(this._messageSendQueueSubject$.getValue().slice(1)),this.sendQueuedMessage()})}sendMessage(e){return m.a(e).pipe(Object(v.a)(this.thread$),Object(A.b)(([e,t])=>{if(!t.isFake)return this.datastore.collection("messages").push(e).then(e=>{});const i=Object(k.b)(t,e.message,e.fromUser);return this.datastore.collection("threads").push(i).then(e=>{"success"===e.status&&this.sendFiles(e.id)})})).toPromise()}sendFiles(e){Object.entries(this._fileAttachmentMappingSubject$.value).forEach(([t,i])=>{if(!this._fileAttachmentMappingSubject$.value[t].uploadTask){const n=this.fileStorage.upload(d.a.MESSAGING_ATTACHMENTS,i.file,{customMetadata:{threadId:e.toString(),clientMessageId:Date.now().toString()}});this._fileAttachmentMappingSubject$.next(Object.assign(Object.assign({},this._fileAttachmentMappingSubject$.value),{[t]:Object.assign({uploadTask:n,uploadTaskEvent$:n.changes(),uploadPercentage$:n.percentageChanges()},this._fileAttachmentMappingSubject$.value[t])}))}}),this.filesSelectControl.setValue([])}retryUploadFile(e){var t;if(e in this._fileAttachmentMappingSubject$.value){const i=this._fileAttachmentMappingSubject$.value[e];null===(t=i.uploadTaskEvent$)||void 0===t||t.pipe(Object(w.a)(),Object(y.a)(e=>e.metadata)).subscribe(t=>{var n;const a=null===(n=t.customMetadata)||void 0===n?void 0:n.threadId;if(a){const t=this.fileStorage.upload(d.a.MESSAGING_ATTACHMENTS,i.file,{customMetadata:{threadId:a,clientMessageId:Date.now().toString()}});this._fileAttachmentMappingSubject$.next(Object.assign(Object.assign({},this._fileAttachmentMappingSubject$.value),{[e]:Object.assign(Object.assign({},i),{uploadTask:t,uploadTaskEvent$:t.changes(),uploadPercentage$:t.percentageChanges()})}))}}).unsubscribe()}}getFileAttachmentKey(e){return`${Date.now()}_${e.name}_${e.size}_${e.lastModified}`}handleUserTyping(e){this.datastore.collection("threads").update(e,{typing:!0}),this.usersTyping.emit()}isAttachmentListEmpty(){return 0===Object.keys(this._fileAttachmentMappingSubject$.value).length}ngOnDestroy(){this.sortedMessagesSubscription$&&this.sortedMessagesSubscription$.unsubscribe(),this.filesSelectControlSubscription$&&this.filesSelectControlSubscription$.unsubscribe(),this.filesSelectToggleSubscription$&&this.filesSelectToggleSubscription$.unsubscribe(),this.typingSubscription&&this.typingSubscription.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(n.Sb(E.a),n.Sb(_.a),n.Sb(j.a),n.Sb(P.b),n.Sb(R.a),n.Sb(B.a),n.Sb(L.a))},e.\u0275cmp=n.Mb({type:e,selectors:[["app-messaging-thread-view"]],viewQuery:function(e,t){if(1&e&&(n.jd($,1),n.jd(U,1)),2&e){let e;n.Mc(e=n.oc())&&(t.fileSelect=e.first),n.Mc(e=n.oc())&&(t.messageList=e.first)}},inputs:{allChatMembers:"allChatMembers",loggedInUser:"loggedInUser",membersActivityStatus:"membersActivityStatus",isLoggedInUserSupportAgent:"isLoggedInUserSupportAgent",thread:"thread",threadIdentifier:"threadIdentifier"},outputs:{usersTyping:"usersTyping",previewModalOpen:"previewModalOpen",previewModalClose:"previewModalClose"},features:[n.Eb],decls:19,vars:31,consts:[["flTrackingLabel","ThreadViewFileSelect",1,"ThreadView-fileSelect",3,"control","multiple"],["fileSelect",""],["class","ThreadView-loading",4,"ngIf","ngIfElse"],["loadedState",""],[1,"ThreadView-typingBoxArea"],[3,"usersTyping"],[4,"ngIf"],[3,"enableFileUpload","hasAttachments","isThreadBlocked","isBlockedByLoggedInUser","isLoggedInUserSupportAgent","loggedInUser","threadIdentifier","userTyping","addFile","openFileSelect","sendMessage"],[1,"ThreadView-loading"],["flTrackingLabel","MessageListLoading"],[4,"ngIf","ngIfElse"],["nonEmptyMessageList",""],[3,"isGroupChat","loading","loggedInUser","messages","userReadTimes","showLoadMore","thread","usersIsOnlineMap","usersMap","loadMoreMessage","viewAttachment"],["messageList",""],[3,"fileAttachmentMap","removeAttachment","successfulUpload","retryUpload"]],template:function(e,t){if(1&e&&(n.Yb(0,"fl-file-select",0,1),n.ad(2,G,2,0,"fl-bit",2),n.sc(3,"flAsync"),n.sc(4,"flAsync"),n.ad(5,D,4,4,"ng-template",null,3,n.bd),n.Yb(7,"fl-bit",4),n.Tb(8,"fl-hr"),n.Tb(9,"app-messaging-typing-indicator",5),n.sc(10,"flAsync"),n.ad(11,X,4,3,"ng-container",6),n.sc(12,"flAsync"),n.Yb(13,"app-messaging-typing-box",7),n.nc("userTyping",function(e){return t.handleUserTyping(e)})("addFile",function(e){return t.addFile(e)})("openFileSelect",function(){return t.openFileSelect()})("sendMessage",function(e){return t.enqueueMessage(e,t.filesSelectControl.value)}),n.sc(14,"flAsync"),n.sc(15,"flAsync"),n.sc(16,"flAsync"),n.sc(17,"flAsync"),n.sc(18,"flAsync"),n.Xb(),n.Xb(),n.Xb()),2&e){const e=n.Nc(6);let i=null,a=null;n.zc("control",t.filesSelectControl)("multiple",!0),n.Gb(2),n.zc("ngIf",n.tc(3,13,t.messageListLoading$)&&n.tc(4,15,t.loadingState$)===t.ThreadLoadingState.LOAD_THREAD)("ngIfElse",e),n.Gb(7),n.zc("usersTyping",n.tc(10,17,t.usersTyping$)),n.Gb(2),n.zc("ngIf",!n.tc(12,19,t.isFileAttachmentMappingEmpty$)),n.Gb(2),n.zc("enableFileUpload",!t.filesSelectControl.disabled)("hasAttachments",n.tc(14,21,t.hasUnsentAttachments$))("isThreadBlocked","none"===(null==(i=n.tc(15,23,t.thread$))?null:i.writePrivacy))("isBlockedByLoggedInUser",null==(a=n.tc(16,25,t.thread$))?null:a.isBlocked)("isLoggedInUserSupportAgent",t.isLoggedInUserSupportAgent)("loggedInUser",n.tc(17,27,t.loggedInUser$))("threadIdentifier",n.tc(18,29,t.threadIdentifier$))}},styles:["[_nghost-%COMP%]{display:flex;flex:1 0;flex-direction:column}.ThreadView-fileSelect[_ngcontent-%COMP%]{height:100%}.ThreadView-loading[_ngcontent-%COMP%]{align-items:center;display:flex;height:100%;justify-content:center;width:100%}.ThreadView-typingBoxArea[_ngcontent-%COMP%]{flex:0 0 auto}"],changeDetection:0}),e})()},OS7q:function(e,t,i){"use strict";i.d(t,"a",function(){return r});var n=i("SVse"),a=i("iuNj"),s=i("cokP"),o=i("8Y7J");let r=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=o.Qb({type:e}),e.\u0275inj=o.Pb({imports:[[n.c,s.a,a.a]]}),e})()},QrFh:function(e,t,i){"use strict";i.d(t,"a",function(){return r});var n=i("s7LF"),a=i("f6cb"),s=i("8Y7J"),o=i("YFxV");let r=(()=>{class e extends n.c{constructor(e,t,i,n){super(i,e,n),this.elementRef=e,this.timeUtils=t}writeValue(e){super.writeValue(e),this.timeUtils.setTimeout(()=>{if(!Object(a.g)(this.offset))return;const{nativeElement:e}=this.elementRef;e.focus(),e.setSelectionRange(this.offset,this.offset)})}setCursorPosition(e){this.offset=e}getCursorSelectionPosition(){const{nativeElement:e}=this.elementRef;return{selectionStart:e.selectionStart,selectionEnd:e.selectionEnd}}}return e.\u0275fac=function(t){return new(t||e)(s.Sb(s.l),s.Sb(o.a),s.Sb(s.G,4),s.Sb(n.a,8))},e.\u0275dir=s.Nb({type:e,selectors:[["","flControlValueAccessor",""]],features:[s.Fb([{provide:n.m,useExisting:e,multi:!0}]),s.Db]}),e})()},Uw4d:function(e,t,i){"use strict";i.d(t,"a",function(){return l});var n=i("SVse"),a=i("s7LF"),s=i("oA5+"),o=i("18b0"),r=i("cokP"),c=i("8Y7J");let l=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=c.Qb({type:e}),e.\u0275inj=c.Pb({imports:[[n.c,r.a,s.a,o.a,a.j]]}),e})()},UztC:function(e,t,i){"use strict";i.d(t,"a",function(){return T});var n=i("UlxN"),a=i("B23V"),s=i("dO68"),o=i("MmDv"),r=i("8Y7J"),c=i("HEOu"),l=i("SVse"),d=i("w13q"),h=i("o9eT"),g=i("g6qU"),u=i("al+g");function b(e,t){1&e&&(r.Wb(0),r.cc(1,4),r.Vb())}function f(e,t){1&e&&(r.Wb(0),r.cc(1,5),r.Vb())}function p(e,t){1&e&&(r.Wb(0),r.cc(1,6),r.Vb())}function m(e,t){1&e&&(r.Wb(0),r.cc(1,7),r.Vb())}function C(e,t){1&e&&(r.Wb(0),r.cc(1,8),r.Vb())}function M(e,t){1&e&&(r.Wb(0),r.cc(1,9),r.Vb())}function S(e,t){1&e&&(r.Wb(0),r.cc(1,10),r.Vb())}function x(e,t){1&e&&(r.Wb(0),r.cc(1,11),r.Vb())}function y(e,t){if(1&e&&(r.Yb(0,"fl-bit",1),r.Yb(1,"fl-text"),r.ad(2,b,2,0,"ng-container",2),r.ad(3,f,2,0,"ng-container",2),r.ad(4,p,2,0,"ng-container",2),r.ad(5,m,2,0,"ng-container",2),r.ad(6,C,2,0,"ng-container",2),r.ad(7,M,2,0,"ng-container",2),r.ad(8,S,2,0,"ng-container",2),r.ad(9,x,2,0,"ng-container",2),r.Xb(),r.Tb(10,"app-messaging-context-button",3),r.Xb()),2&e){const e=r.rc();r.Gb(2),r.zc("ngIf","projectAwardHourly"===(null==e.contextBoxState?null:e.contextBoxState.name)||"projectAwardFixed"===(null==e.contextBoxState?null:e.contextBoxState.name)),r.Gb(1),r.zc("ngIf","setupBilling"===(null==e.contextBoxState?null:e.contextBoxState.name)),r.Gb(1),r.zc("ngIf","milestoneCreate"===(null==e.contextBoxState?null:e.contextBoxState.name)||"milestoneCreateFromRequest"===(null==e.contextBoxState?null:e.contextBoxState.name)||"milestoneCreateInitial"===(null==e.contextBoxState?null:e.contextBoxState.name)||"milestoneCreateRedirect"===(null==e.contextBoxState?null:e.contextBoxState.name)),r.Gb(1),r.zc("ngIf","payFailedInvoices"===(null==e.contextBoxState?null:e.contextBoxState.name)),r.Gb(1),r.zc("ngIf","hireme"===(null==e.contextBoxState?null:e.contextBoxState.name)),r.Gb(1),r.zc("ngIf","projectAcceptHourly"===(null==e.contextBoxState?null:e.contextBoxState.name)||"projectAcceptFixed"===(null==e.contextBoxState?null:e.contextBoxState.name)||"projectAcceptRedirect"===(null==e.contextBoxState?null:e.contextBoxState.name)),r.Gb(1),r.zc("ngIf","trackTime"===(null==e.contextBoxState?null:e.contextBoxState.name)),r.Gb(1),r.zc("ngIf","requestMilestone"===(null==e.contextBoxState?null:e.contextBoxState.name)||"requestMilestoneRedirect"===(null==e.contextBoxState?null:e.contextBoxState.name)),r.Gb(1),r.zc("contextBoxState",e.contextBoxState)}}let T=(()=>{class e{constructor(e){this.featureFlagService=e,this.ButtonColor=a.a,this.ButtonSize=s.a,this.NON_CTA_CONTEXT_BOX_STATE_NAME=o.a}ngOnInit(){this.billingEnabled$=this.featureFlagService.getFlag(n.b.BILLING)}}return e.\u0275fac=function(t){return new(t||e)(r.Sb(c.a))},e.\u0275cmp=r.Mb({type:e,selectors:[["app-messaging-context-box"]],inputs:{contextBoxState:"contextBoxState"},decls:2,vars:3,consts:function(){let e,t,i,n,a,s,o,r;return e=" Start working with this freelancer! ",t=" Set your billing for this project. ",i=" Set project deliverables. ",n=" This project has an outstanding bill. ",a=" I'm available. Let's work together! ",s=" This project has been awarded to you! ",o=" Make sure to track your progress. ",r=" Define your deliverables. ",[["class","ContextBox",4,"ngIf"],[1,"ContextBox"],[4,"ngIf"],[3,"contextBoxState"],e,t,i,n,a,s,o,r]},template:function(e,t){1&e&&(r.ad(0,y,11,9,"fl-bit",0),r.sc(1,"flAsync")),2&e&&r.zc("ngIf",!!t.contextBoxState&&!t.NON_CTA_CONTEXT_BOX_STATE_NAME.includes(t.contextBoxState.name)&&("setupBilling"!==(null==t.contextBoxState?null:t.contextBoxState.name)||r.tc(1,1,t.billingEnabled$)))},directives:[l.q,d.a,h.e,g.a],pipes:[u.a],styles:[".ContextBox[_ngcontent-%COMP%]{align-items:center;background:#fff;border-bottom:1px solid #dedede;box-shadow:0 10px 10px -9px rgba(0,0,0,.12);display:flex;flex:0 0 48px;height:48px;justify-content:space-between;padding:8px 16px;width:100%}"],changeDetection:0}),e})()},V1in:function(e,t,i){"use strict";i.d(t,"a",function(){return a});var n=i("8Y7J");let a=(()=>{class e{constructor(e){this.element=e,this.flAutoGrowMaxHeight=72,this.flAutoGrowMinHeight=48}ngOnInit(){this.valueChangeSubscription=this.flAutoGrow.valueChanges.subscribe(e=>this.adjust())}ngOnDestroy(){this.valueChangeSubscription&&this.valueChangeSubscription.unsubscribe()}adjust(){let e;if(this.element.nativeElement instanceof HTMLTextAreaElement)e=this.element.nativeElement;else{if("FL-TEXTAREA"!==this.element.nativeElement.tagName)throw new Error("Not supported element!");e=this.element.nativeElement.children.item(0)}e.style.overflow="hidden",e.style.height="auto",e.style.overflowY="auto",e.style.height=`${Math.max(this.flAutoGrowMinHeight,Math.min(e.scrollHeight,this.flAutoGrowMaxHeight))}px`,e.scrollHeight<this.flAutoGrowMaxHeight&&(e.style.overflow="hidden")}}return e.\u0275fac=function(t){return new(t||e)(n.Sb(n.l))},e.\u0275dir=n.Nb({type:e,selectors:[["","flAutoGrow",""]],inputs:{flAutoGrow:"flAutoGrow",flAutoGrowMaxHeight:"flAutoGrowMaxHeight",flAutoGrowMinHeight:"flAutoGrowMinHeight"},exportAs:["autogrow"]}),e})()},VFv1:function(e,t,i){"use strict";i.d(t,"a",function(){return u});var n=i("9u4R"),a=i("tqRt"),s=i("OpNG"),o=i("cUs2"),r=i("DXEH");function c(){return{defaultOrder:{field:"id",direction:s.a.DESC},fetch:(e,t,i,n)=>({endpoint:"projects/0.1/hourly_contracts",params:{project_ids:Object(o.h)(i,"projectId"),bidder_ids:Object(o.h)(i,"bidderId"),active:Object(o.h)(i,"active")[0]?"true":void 0}}),push:void 0,set:void 0,update:(e,t,i)=>{const n=`projects/0.1/hourly_contracts/${i.bidId}`;let a;if("timeTrackingStopped"in t?a=void 0===t.timeTrackingStopped?{action:r.HourlyContractActionApi.STOP_TIME_TRACKING}:{action:r.HourlyContractActionApi.ENABLE_TIME_TRACKING}:"currentWorkLimit"in t&&i.currentWorkLimit!==t.currentWorkLimit&&(a={action:r.HourlyContractActionApi.UPDATE,work_limit:t.currentWorkLimit}),void 0===a)throw new Error("Could not update due to missing payload");return{endpoint:n,payload:a,method:"PUT",asFormData:!0}},remove:void 0}}function l(e){if(!(e.id&&e.project_id&&e.bid_id&&e.billing_cycle&&e.invoice_payment_method))throw new ReferenceError("Missing a required hourly contract field.");if(e.billing_cycle!==r.HourlyContractBillingCycleApi.WEEKLY&&e.billing_cycle!==r.HourlyContractBillingCycleApi.MONTHLY)throw new ReferenceError("Billing Cycle must be monthly or weekly");return{id:e.id,projectId:e.project_id,bidId:e.bid_id,defaultHourlyRate:e.default_hourly_rate,defaultWorkLimit:e.default_work_limit,billingCycle:e.billing_cycle,invoicePaymentMethod:e.invoice_payment_method,currentHourlyRate:e.current_hourly_rate,currentWorkLimit:e.current_work_limit,timezone:e.timezone,bidderId:e.bidder_id,projectOwnerId:e.project_owner_id,invalidTime:e.invalid_time?1e3*e.invalid_time:void 0,timeTrackingStopped:e.time_tracking_stopped?1e3*e.time_tracking_stopped:void 0,invoiceId:e.invoice_id,active:!e.invalid_time}}function d(e){if(!(e.id&&e.project_id&&e.bid_id&&e.billing_cycle&&e.invoice_payment_method))throw new ReferenceError("Missing a required hourly contract field.");if(e.billing_cycle!==r.HourlyContractBillingCycleApi.WEEKLY&&e.billing_cycle!==r.HourlyContractBillingCycleApi.MONTHLY)throw new ReferenceError("Billing Cycle must be monthly or weekly");return{id:e.id,projectId:e.project_id,bidId:e.bid_id,defaultHourlyRate:e.default_hourly_rate||void 0,defaultWorkLimit:e.default_work_limit||void 0,billingCycle:e.billing_cycle,invoicePaymentMethod:e.invoice_payment_method,currentHourlyRate:e.current_hourly_rate||void 0,currentWorkLimit:e.current_work_limit||void 0,timezone:e.timezone?{id:e.timezone.id||void 0,country:e.timezone.country||void 0,timezone:e.timezone.timezone||void 0,offset:e.timezone.offset||void 0}:void 0,bidderId:e.bidder_id||void 0,projectOwnerId:e.project_owner_id||void 0,invalidTime:e.invalid_time?1e3*e.invalid_time:void 0,timeTrackingStopped:e.time_tracking_stopped?1e3*e.time_tracking_stopped:void 0,invoiceId:e.invoice_id||void 0,active:!e.invalid_time}}function h(e={},t){switch(t.type){case"API_FETCH_SUCCESS":if("hourlyContracts"===t.payload.type){const{result:i,ref:n,order:a}=t.payload;return Object(o.o)(e,Object(o.z)(i.hourly_contracts,l),a,n)}return e;case"API_UPDATE_SUCCESS":{const{result:i}=t.payload;if(("bids"===t.payload.type||"projectViewBids"===t.payload.type)&&i&&"hourly_contract"in i&&i.hourly_contract){const n={path:{collection:"hourlyContracts",authUid:t.payload.ref.path.authUid}};return Object(o.q)(e,Object(o.z)([i.hourly_contract],l),n)}if("hourlyContracts"===t.payload.type){const{result:i,ref:n}=t.payload;return Object(o.q)(e,Object(o.z)([i],l),n)}return e}case"WS_MESSAGE":{const i={path:{collection:"hourlyContracts",authUid:t.payload.toUserId}};if("notifications"===t.payload.parent_type)switch(t.payload.type){case"hourlyContractUpdate":return Object(o.q)(e,Object(o.z)([t.payload.data.hourlyContract],d),i);default:return e}return e}default:return e}}var g=i("8Y7J");let u=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=g.Qb({type:e}),e.\u0275inj=g.Pb({imports:[[a.j.forFeature("hourlyContracts",h),n.d.forFeature("hourlyContracts",c)]]}),e})()},WDoz:function(e,t,i){"use strict";i.d(t,"a",function(){return Q});var n=i("8Y7J"),a=i("3f1L"),s=i("97vJ"),o=i("riYv"),r=i("f6cb"),c=i("tsv4"),l=i("DXEH"),d=i("ueDg"),h=i("n0rP"),g=i("2Vo4"),u=i("itXk"),b=i("VRyK"),f=i("LRne"),p=i("lJxs"),m=i("pLZG"),C=i("JX91"),M=i("/uUt"),S=i("05l1"),x=i("x+ZX"),y=i("zp1y"),T=i("puO/"),I=i("MmDv"),O=function(e){return e[e.ADD=0]="ADD",e[e.REMOVE=1]="REMOVE",e}({}),v=i("/wLE"),A=i("eCtd"),w=i("L1P6"),k=i("LE8X"),z=i("SVse"),E=i("4ykm"),L=i("3A0Z"),_=i("w13q"),j=i("KUXl"),P=i("1YM7"),R=i("UztC"),B=i("Np1b"),$=i("3bYl"),U=i("SMHo"),G=i("23iI");const N=["chatOptionsDrawer"];function F(e,t){if(1&e){const e=n.Zb();n.Yb(0,"app-messaging-chat-details",10),n.nc("showAddPeopleScreen",function(){return n.Qc(e),n.rc().openAddPeopleModal()}),n.Xb()}if(2&e){const e=n.rc();n.zc("flShowDesktop",!0)("callsEnabled",e.callsEnabled)("chatboxMode",!1)("contextBoxState",e.contextBoxState)("isLoggedInUserSupportAgent",e.isLoggedInUserSupportAgent)("isLoggedInUserThreadOwner",e.isLoggedInUserThreadOwner)("loggedInUser",e.loggedInUser)("otherMembers",e.activeOtherMembers)("supportAgent",e.supportAgent)("team",e.team)("thread",e.thread)("threadBidders",e.threadBidders)("threadCollaborators",e.threadCollaborators)("threadContacts",e.threadContacts)}}function D(e,t){if(1&e){const e=n.Zb();n.Yb(0,"app-messaging-chat-details",11),n.nc("showAddPeopleScreen",function(){return n.Qc(e),n.rc().openAddPeopleModal()}),n.Xb()}if(2&e){const e=n.rc();n.zc("callsEnabled",e.callsEnabled)("chatboxMode",!1)("contextBoxState",e.contextBoxState)("isLoggedInUserSupportAgent",e.isLoggedInUserSupportAgent)("isLoggedInUserThreadOwner",e.isLoggedInUserThreadOwner)("loggedInUser",e.loggedInUser)("otherMembers",e.activeOtherMembers)("supportAgent",e.supportAgent)("team",e.team)("thread",e.thread)("threadBidders",e.threadBidders)("threadCollaborators",e.threadCollaborators)("threadContacts",e.threadContacts)}}let X=(()=>{class e{constructor(e){this.modalService=e,this.addChatMembers=new n.n,this.markAsRead=new n.n,this.showSidebar=!1}toggleSidebar(){this.showSidebar=!this.showSidebar,this.showSidebar?this.chatOptionsDrawer.open():this.chatOptionsDrawer.close()}openAddPeopleModal(){this.modalService.open("MessagingAddPeopleModal",{edgeToEdge:!0,inputs:{isLoggedInUserSupportAgent:this.isLoggedInUserSupportAgent,threadBidders:this.threadBidders,threadCollaborators:this.threadCollaborators,threadContacts:this.threadContacts},mobileFullscreen:!0,size:E.a.SMALL}).afterClosed().toPromise().then(e=>{e&&this.addChatMembers.emit(e)})}}return e.\u0275fac=function(t){return new(t||e)(n.Sb(L.b))},e.\u0275cmp=n.Mb({type:e,selectors:[["app-messaging-full-inbox"]],viewQuery:function(e,t){if(1&e&&n.jd(N,1),2&e){let e;n.Mc(e=n.oc())&&(t.chatOptionsDrawer=e.first)}},inputs:{activeOtherMembers:"activeOtherMembers",allChatMembers:"allChatMembers",callsEnabled:"callsEnabled",contextBoxState:"contextBoxState",isLoggedInUserSupportAgent:"isLoggedInUserSupportAgent",isLoggedInUserThreadOwner:"isLoggedInUserThreadOwner",loggedInUser:"loggedInUser",membersActivityStatus:"membersActivityStatus",supportAgent:"supportAgent",team:"team",thread:"thread",threadBidders:"threadBidders",threadCollaborators:"threadCollaborators",threadContacts:"threadContacts",threadIdentifier:"threadIdentifier"},outputs:{addChatMembers:"addChatMembers",markAsRead:"markAsRead"},decls:11,vars:18,consts:function(){let e;return e="Chat Details",[["flTrackingSection","FullInbox",1,"FullInbox"],[1,"FullInbox-header",3,"callsEnabled","chatboxMode","contextBoxState","loggedInUser","membersActivityStatus","otherMembers","supportAgent","thread","showChatDetails"],[1,"FullInbox-content"],[1,"FullInbox-threadView"],[3,"contextBoxState"],[3,"allChatMembers","loggedInUser","membersActivityStatus","thread","threadIdentifier","click","usersTyping"],["class","FullInbox-sidebar FullInbox-sidebar--desktop",3,"flShowDesktop","callsEnabled","chatboxMode","contextBoxState","isLoggedInUserSupportAgent","isLoggedInUserThreadOwner","loggedInUser","otherMembers","supportAgent","team","thread","threadBidders","threadCollaborators","threadContacts","showAddPeopleScreen",4,"ngIf"],["mobileHeaderTitle",e,3,"edgeToEdge","fullWidth","flHideDesktop"],["chatOptionsDrawer",""],["drawerTemplate",""],[1,"FullInbox-sidebar","FullInbox-sidebar--desktop",3,"flShowDesktop","callsEnabled","chatboxMode","contextBoxState","isLoggedInUserSupportAgent","isLoggedInUserThreadOwner","loggedInUser","otherMembers","supportAgent","team","thread","threadBidders","threadCollaborators","threadContacts","showAddPeopleScreen"],[1,"FullInbox-sidebar",3,"callsEnabled","chatboxMode","contextBoxState","isLoggedInUserSupportAgent","isLoggedInUserThreadOwner","loggedInUser","otherMembers","supportAgent","team","thread","threadBidders","threadCollaborators","threadContacts","showAddPeopleScreen"]]},template:function(e,t){1&e&&(n.Yb(0,"fl-bit",0),n.Yb(1,"app-messaging-header",1),n.nc("showChatDetails",function(){return t.toggleSidebar()}),n.Xb(),n.Yb(2,"fl-bit",2),n.Yb(3,"fl-bit",3),n.Tb(4,"app-messaging-context-box",4),n.Yb(5,"app-messaging-thread-view",5),n.nc("click",function(){return t.markAsRead.emit()})("usersTyping",function(){return t.markAsRead.emit()}),n.Xb(),n.Xb(),n.ad(6,F,1,14,"app-messaging-chat-details",6),n.Yb(7,"fl-drawer",7,8),n.ad(9,D,1,13,"ng-template",null,9,n.bd),n.Xb(),n.Xb(),n.Xb()),2&e&&(n.Gb(1),n.zc("callsEnabled",t.callsEnabled)("chatboxMode",!1)("contextBoxState",t.contextBoxState)("loggedInUser",t.loggedInUser)("membersActivityStatus",t.membersActivityStatus)("otherMembers",t.activeOtherMembers)("supportAgent",t.supportAgent)("thread",t.thread),n.Gb(3),n.zc("contextBoxState",t.contextBoxState),n.Gb(1),n.zc("allChatMembers",t.allChatMembers)("loggedInUser",t.loggedInUser)("membersActivityStatus",t.membersActivityStatus)("thread",t.thread)("threadIdentifier",t.threadIdentifier),n.Gb(1),n.zc("ngIf",t.showSidebar),n.Gb(1),n.zc("edgeToEdge",!0)("fullWidth",!0)("flHideDesktop",!0))},directives:[_.a,j.a,P.a,R.a,B.a,z.q,$.a,U.a,G.a],styles:["[_nghost-%COMP%]{display:block;height:100%}.FullInbox[_ngcontent-%COMP%]{background:#fff;display:flex;flex-flow:column;height:100%;padding-bottom:env(safe-area-inset-bottom);width:100%}.FullInbox-content[_ngcontent-%COMP%]{display:flex;height:calc(100% - 81px)}.FullInbox-threadView[_ngcontent-%COMP%]{display:flex;flex:1 0 auto;flex-flow:column;height:100%}.FullInbox-header[_ngcontent-%COMP%]{border-bottom:1px solid #dedede}.FullInbox-sidebar[_ngcontent-%COMP%]{border-left:1px solid #dedede;display:block}.FullInbox-sidebar--desktop[_ngcontent-%COMP%]{width:375px}"],changeDetection:0}),e})();var Y=i("al+g");function H(e,t){if(1&e){const e=n.Zb();n.Yb(0,"app-messaging-chat-box",2),n.nc("addChatMembers",function(t){n.Qc(e);const i=n.rc();return i.modifyChatMembers(t,i.ModifyChatMembersActionType.ADD)})("focusChat",function(t){return n.Qc(e),n.rc().focusChatBox(t)})("closeChat",function(){n.Qc(e);const t=n.rc();return t.closeChat.emit(t.threadIdentifier)})("closeOnboarding",function(){return n.Qc(e),n.rc().closeOnboarding()})("minimiseChat",function(){n.Qc(e);const t=n.rc();return t.minimiseChat.emit(t.threadIdentifier)})("unfocusChat",function(){return n.Qc(e),n.rc().unfocusChat.emit()})("makingCall",function(t){return n.Qc(e),n.rc().makingCall.emit(t)})("markAsRead",function(){return n.Qc(e),n.rc().markAsRead()})("toggleSize",function(){n.Qc(e);const t=n.rc();return t.toggleSize.emit(t.threadIdentifier)}),n.sc(1,"flAsync"),n.sc(2,"flAsync"),n.sc(3,"flAsync"),n.sc(4,"flAsync"),n.sc(5,"flAsync"),n.sc(6,"flAsync"),n.sc(7,"flAsync"),n.sc(8,"flAsync"),n.sc(9,"flAsync"),n.sc(10,"flAsync"),n.sc(11,"flAsync"),n.sc(12,"flAsync"),n.sc(13,"flAsync"),n.sc(14,"flAsync"),n.sc(15,"flAsync"),n.sc(16,"flAsync"),n.Xb()}if(2&e){const e=n.rc();n.zc("allChatMembers",n.tc(1,21,e.allChatMembers$))("activeOtherMembers",n.tc(2,23,e.activeOtherMembers$))("callsEnabled",n.tc(3,25,e.callsEnabled$))("contextBoxState",n.tc(4,27,e.contextBoxState$))("isFocused",e.isFocused)("isHourlyProject",n.tc(5,29,e.isHourlyProject$))("isLoggedInUserSupportAgent",n.tc(6,31,e.isLoggedInUserSupportAgent$))("isLoggedInUserThreadOwner",n.tc(7,33,e.isLoggedInUserThreadOwner$))("isMinimised",e.isMinimised)("loggedInUser",n.tc(8,35,e.loggedInUser$))("membersActivityStatus",n.tc(9,37,e.membersActivityStatus$))("privateChatOtherUser",n.tc(10,39,e.otherUser$))("project",n.tc(11,41,e.project$))("showOnboarding",n.tc(12,43,e.showOnboarding$))("supportAgent",n.tc(13,45,e.supportAgent$))("team",e.team)("thread",e.thread)("threadBidders",n.tc(14,47,e.threadBidders$))("threadContacts",n.tc(15,49,e.threadContacts$))("threadCollaborators",n.tc(16,51,e.threadCollaborators$))("threadIdentifier",e.threadIdentifier)}}function V(e,t){if(1&e){const e=n.Zb();n.Yb(0,"app-messaging-full-inbox",3),n.nc("addChatMembers",function(t){n.Qc(e);const i=n.rc();return i.modifyChatMembers(t,i.ModifyChatMembersActionType.ADD)})("focusChat",function(){return n.Qc(e),n.rc().markAsRead()})("markAsRead",function(){return n.Qc(e),n.rc().markAsRead()}),n.sc(1,"flAsync"),n.sc(2,"flAsync"),n.sc(3,"flAsync"),n.sc(4,"flAsync"),n.sc(5,"flAsync"),n.sc(6,"flAsync"),n.sc(7,"flAsync"),n.sc(8,"flAsync"),n.sc(9,"flAsync"),n.sc(10,"flAsync"),n.sc(11,"flAsync"),n.sc(12,"flAsync"),n.Xb()}if(2&e){const e=n.rc();n.zc("activeOtherMembers",n.tc(1,15,e.activeOtherMembers$))("allChatMembers",n.tc(2,17,e.allChatMembers$))("callsEnabled",n.tc(3,19,e.callsEnabled$))("contextBoxState",n.tc(4,21,e.contextBoxState$))("isLoggedInUserSupportAgent",n.tc(5,23,e.isLoggedInUserSupportAgent$))("isLoggedInUserThreadOwner",n.tc(6,25,e.isLoggedInUserThreadOwner$))("loggedInUser",n.tc(7,27,e.loggedInUser$))("membersActivityStatus",n.tc(8,29,e.membersActivityStatus$))("supportAgent",n.tc(9,31,e.supportAgent$))("team",e.team)("thread",e.thread)("threadBidders",n.tc(10,33,e.threadBidders$))("threadContacts",n.tc(11,35,e.threadContacts$))("threadCollaborators",n.tc(12,37,e.threadCollaborators$))("threadIdentifier",e.threadIdentifier)}}let Q=(()=>{class e{constructor(e,t,i,a){this.auth=e,this.datastore=t,this.localStorage=i,this.userAgent=a,this.ModifyChatMembersActionType=O,this.inCall=!1,this.isFocused=!1,this.isMinimised=!1,this.closeChat=new n.n,this.focusChat=new n.n,this.unfocusChat=new n.n,this.minimiseChat=new n.n,this.toggleSize=new n.n,this.makingCall=new n.n,this.XXX_SKILL_ID=88,this.projectOnboardingClosedSubject$=new g.a(!1),this.projectOnboardingClosed$=this.projectOnboardingClosedSubject$.asObservable()}ngOnInit(){this._allContactsSubject$=new g.a(this.allContacts),this.allContacts$=this._allContactsSubject$.asObservable(),this._threadSubject$=new g.a(this.thread),this.thread$=this._threadSubject$.asObservable(),this._threadIdentifierSubject$=new g.a(this.threadIdentifier),this.threadIdentifier$=this._threadIdentifierSubject$.asObservable(),this._inCallSubject$=new g.a(this.inCall),this.inCall$=this._inCallSubject$.asObservable(),this._teamSubject$=new g.a(this.team),this.team$=this._teamSubject$.asObservable();const e=this.auth.getUserId().pipe(Object(p.a)(e=>Object(r.r)(e)));this.allChatMembers$=this.datastore.collection("users",this.thread$.pipe(Object(p.a)(e=>[...e.inactiveMembers,...e.members]))).valueChanges(),this.loggedInUser$=u.a([this.allChatMembers$,e]).pipe(Object(p.a)(([e,t])=>e.find(e=>e.id===t)),Object(m.a)(r.g)),this.isLoggedInUserThreadOwner$=u.a([this.thread$,this.loggedInUser$]).pipe(Object(p.a)(([e,t])=>!e.isFake&&e.owner===t.id)),this.activeOtherMembers$=u.a([this.thread$,this.allChatMembers$]).pipe(Object(p.a)(([e,t])=>t.filter(t=>e.otherMembers.includes(t.id)))),this.membersActivityStatus$=this.datastore.collection("onlineOffline",this.thread$.pipe(Object(p.a)(e=>e.members))).valueChanges();const t=this.datastore.collection("agentSessions",e=>e.where("sessionId","==",this.thread$.pipe(Object(p.a)(e=>e.context.type===c.ContextTypeApi.SUPPORT_SESSION?e.context.id:void 0),Object(m.a)(r.g)))).valueChanges().pipe(Object(p.a)(e=>e[0]),Object(m.a)(r.g)),i=this.datastore.collection("agents",e=>e.where("userId","in",this.thread$.pipe(Object(p.a)(e=>e.members))).where("state","in",[h.AgentStateApi.AVAILABLE,h.AgentStateApi.AWAY,h.AgentStateApi.UNAVAILABLE])).valueChanges();this.isLoggedInUserSupportAgent$=u.a([e,i]).pipe(Object(p.a)(([e,t])=>t.map(e=>e.userId).includes(e))),this.supportAgent$=u.a([t.pipe(Object(C.a)(void 0)),this.isLoggedInUserSupportAgent$,this.activeOtherMembers$,this.loggedInUser$,i]).pipe(Object(p.a)(([e,t,i,n,a])=>{if(0!==a.length)return a.find(t?t=>e?t.userId===n.id&&t.type===e.type:t.userId===n.id:e=>i.map(e=>e.id).includes(e.userId))}));const n=b.a(this.thread$.pipe(Object(p.a)(e=>e.context.type===c.ContextTypeApi.PROJECT?e.context.id:void 0),Object(m.a)(r.g)),t.pipe(Object(m.a)(e=>e.sessionSourceType===h.SourceTypeApi.PROJECT),Object(p.a)(e=>e.sessionSourceId))),f=this.datastore.document("threadProjects",n);this.project$=f.valueChanges();const y=this.activeOtherMembers$.pipe(Object(p.a)(e=>e[0]),Object(m.a)(r.g),Object(p.a)(e=>e.id));this.otherUser$=this.datastore.document("projectViewUsers",y).valueChanges();const T=u.a([y,this.membersActivityStatus$]).pipe(Object(p.a)(([e,t])=>{const i=t.find(t=>t.id===e);return(null==i?void 0:i.status)===o.OnlineOfflineStatusApi.ONLINE}),Object(C.a)(!1),Object(M.a)()),O=u.a([this.project$,y,e]).pipe(Object(p.a)(([e,t,i])=>e.ownerId===i?t:i),Object(M.a)()),v=this.datastore.collection("bids",e=>e.where("projectId","==",n).where("awardStatus","==",d.BidAwardStatusApi.AWARDED).where("bidderId","==",O)),A=this.datastore.document("contests",this.thread$.pipe(Object(p.a)(e=>e.context.type===c.ContextTypeApi.CONTEST?e.context.id:void 0),Object(m.a)(r.g)));this.isFocused&&this.markAsRead();const w=v.valueChanges().pipe(Object(p.a)(e=>e.length>0),Object(C.a)(!1)),k=u.a([w,this.project$,e,this.otherUser$]).pipe(Object(p.a)(([e,t,i,n])=>!e&&t.ownerId===i&&n.preferredFreelancer&&n.status.freelancerVerifiedUser),Object(C.a)(!1)),z=this.project$.pipe(Object(p.a)(e=>!e.skills.map(e=>e.id).includes(this.XXX_SKILL_ID)),Object(C.a)(!1));this.callsEnabled$=Object(a.a)([this.inCall$,this.isLoggedInUserSupportAgent$,T,this.thread$,this.threadIdentifier$,k,w,z]).pipe(Object(p.a)(([e,t,i,n,a,s,o,r])=>{const c=null==a?void 0:a.isFake,l=1===n.otherMembers.length;if(t&&l)return{audio:{enabled:!0,recorded:!1},video:{enabled:!0,recorded:!1}};const d=l&&i&&this.isCallSupportedBrowser()&&!e&&"none"!==n.writePrivacy&&r&&!c,h=("admin_preferred_chat"===n.threadType||!t)&&d;return{audio:{enabled:(o||s)&&h,recorded:s&&h},video:{enabled:!t&&"admin_preferred_chat"!==n.threadType&&o&&d,recorded:!1}}}),Object(C.a)({audio:{enabled:!1,recorded:!1},video:{enabled:!1,recorded:!1}}),Object(S.a)(1),Object(x.a)());const E=this.datastore.collection("bids",e=>e.where("projectId","==",this.project$.pipe(Object(p.a)(e=>e.id))));this.showOnboarding$=u.a([this.projectOnboardingClosed$,E.valueChanges(),e,this.thread$,this.localStorage.get("projectOverlayThreadComplete"),this.loggedInUser$.pipe(Object(p.a)(e=>!!e.isDeloitteDcUser))]).pipe(Object(p.a)(([e,t,i,n,a,s])=>!(e||"project"!==n.context.type||"private_chat"!==n.threadType||a&&a[n.id]||void 0===t.find(e=>e.bidderId===Object(r.r)(i))||s)));const L=this.datastore.collection("hourlyContracts",e=>e.where("projectId","==",this.project$.pipe(Object(m.a)(r.g),Object(m.a)(e=>e.type===d.ProjectTypeApi.HOURLY),Object(p.a)(e=>e.id))).where("bidderId","==",O)).valueChanges();this.isHourlyProject$=u.a([L,this.project$]).pipe(Object(p.a)(([e,t])=>t.type===d.ProjectTypeApi.HOURLY&&e.some(e=>e.projectId===t.id)));const _=this.datastore.collection("bids",e=>e.where("projectId","==",n).where("bidderId","==",O)),j=this.datastore.collection("milestones",t=>u.a([f.valueChanges(),e]).pipe(Object(p.a)(([e,i])=>e.ownerId===i?t.where("projectId","==",n):t.where("projectId","==",n).where("bidderId","==",i)))),P=this.datastore.collection("milestoneRequests",t=>u.a([f.valueChanges(),e]).pipe(Object(p.a)(([e,i])=>e.ownerId===i?t.where("projectId","==",n):t.where("projectId","==",n).where("bidderId","==",i)))),R=this.datastore.collection("invoices",e=>e.where("projectId","==",n).where("freelancerId","==",O).where("milestoneLinkedStatus","==",l.ProjectInvoiceMilestoneLinkedStatusesApi.UNLINKED).limit(1)),B=u.a([E.valueChanges(),this.thread$]).pipe(Object(p.a)(([e,t])=>e.map(e=>e.bidderId).filter(e=>!t.members.includes(e)).filter(e=>void 0!==e)),Object(m.a)(e=>e.length>0));this.threadBidders$=this.datastore.collection("users",B).valueChanges().pipe(Object(S.a)(1),Object(x.a)(),Object(s.a)()),this.threadContacts$=u.a([this.allContacts$,this.thread$]).pipe(Object(p.a)(([e,t])=>e.filter(e=>!t.members.includes(e.id))));const $=u.a([this.project$,this.thread$]).pipe(Object(p.a)(([e,t])=>(e.projectCollaborations||[]).map(e=>e.userId).filter(r.g).filter(e=>!t.members.includes(e))),Object(m.a)(e=>e.length>0));this.threadCollaborators$=this.datastore.collection("users",$).valueChanges().pipe(Object(S.a)(1),Object(x.a)(),Object(s.a)()),this.stateManager=new I.b(this.auth,this.thread$,this.allChatMembers$,f.valueChanges(),A.valueChanges(),_.valueChanges(),j.valueChanges(),P.valueChanges(),L,t,this.team$,R.valueChanges()),this.contextBoxState$=this.stateManager.getState()}ngOnChanges(e){var t,i,n,a,s;e.allContacts&&(null===(t=this._allContactsSubject$)||void 0===t||t.next(e.allContacts.currentValue)),e.thread&&(null===(i=this._threadSubject$)||void 0===i||i.next(e.thread.currentValue)),e.threadIdentifier&&(null===(n=this._threadIdentifierSubject$)||void 0===n||n.next(e.threadIdentifier.currentValue)),e.inCall&&(null===(a=this._inCallSubject$)||void 0===a||a.next(e.inCall.currentValue)),e.team&&(null===(s=this._teamSubject$)||void 0===s||s.next(e.team.currentValue))}focusChatBox(e){this.markAsRead(),this.focusChat.emit(e)}markAsRead(){this.threadIdentifier$.pipe(Object(p.a)(e=>e.isFake),Object(y.a)(this.thread$),Object(p.a)(([e,t])=>!(e||t.isRead&&0===t.messageUnreadCount)&&this.datastore.collection("threads").update(t.id,{isRead:!0,messageUnreadCount:0}))).toPromise()}isCallSupportedBrowser(){const e=this.userAgent.getUserAgent(),{name:t}=e.getBrowser();return"Chrome"===t||"Firefox"===t}escCloseChat(e){"Escape"===e.key&&this.isFocused&&(e.stopImmediatePropagation(),this.closeChat.emit(this.threadIdentifier))}closeOnboarding(){this.projectOnboardingClosedSubject$.next(!0)}modifyChatMembers(e,t){f.a({userIds:e,actionType:t}).pipe(Object(y.a)(this.thread$,this.loggedInUser$,this.threadIdentifier$),Object(p.a)(([e,t,i,n])=>{if(t.isFake)return;const a=e.actionType===O.ADD?[...t.members,...e.userIds]:t.members.filter(t=>!e.userIds.includes(t)),s=a.filter(e=>e!==i.id),o=e.actionType===O.ADD?t.inactiveMembers.filter(t=>!e.userIds.includes(t)):[...t.inactiveMembers,...e.userIds];return this.datastore.collection("threads").update(t.id,{inactiveMembers:o,members:a,otherMembers:s}).then(t=>{"success"===t.status&&(e.actionType===O.REMOVE&&e.userIds.includes(i.id)&&this.closeChat.emit(n),this.chatboxMode&&this.messagingChatBoxComponent.showThreadView())})})).toPromise()}}return e.\u0275fac=function(t){return new(t||e)(n.Sb(v.a),n.Sb(A.a),n.Sb(w.a),n.Sb(k.a))},e.\u0275cmp=n.Mb({type:e,selectors:[["app-messaging-chat-contents"]],viewQuery:function(e,t){if(1&e&&n.jd(T.b,1),2&e){let e;n.Mc(e=n.oc())&&(t.messagingChatBoxComponent=e.first)}},hostBindings:function(e,t){1&e&&n.nc("keydown",function(e){return t.escCloseChat(e)},!1,n.Oc)},inputs:{allContacts:"allContacts",inCall:"inCall",chatboxMode:"chatboxMode",isFocused:"isFocused",isMinimised:"isMinimised",team:"team",thread:"thread",threadIdentifier:"threadIdentifier"},outputs:{closeChat:"closeChat",focusChat:"focusChat",unfocusChat:"unfocusChat",minimiseChat:"minimiseChat",toggleSize:"toggleSize",makingCall:"makingCall"},features:[n.Eb],decls:3,vars:2,consts:[[3,"allChatMembers","activeOtherMembers","callsEnabled","contextBoxState","isFocused","isHourlyProject","isLoggedInUserSupportAgent","isLoggedInUserThreadOwner","isMinimised","loggedInUser","membersActivityStatus","privateChatOtherUser","project","showOnboarding","supportAgent","team","thread","threadBidders","threadContacts","threadCollaborators","threadIdentifier","addChatMembers","focusChat","closeChat","closeOnboarding","minimiseChat","unfocusChat","makingCall","markAsRead","toggleSize",4,"ngIf","ngIfElse"],["fullInbox",""],[3,"allChatMembers","activeOtherMembers","callsEnabled","contextBoxState","isFocused","isHourlyProject","isLoggedInUserSupportAgent","isLoggedInUserThreadOwner","isMinimised","loggedInUser","membersActivityStatus","privateChatOtherUser","project","showOnboarding","supportAgent","team","thread","threadBidders","threadContacts","threadCollaborators","threadIdentifier","addChatMembers","focusChat","closeChat","closeOnboarding","minimiseChat","unfocusChat","makingCall","markAsRead","toggleSize"],[3,"activeOtherMembers","allChatMembers","callsEnabled","contextBoxState","isLoggedInUserSupportAgent","isLoggedInUserThreadOwner","loggedInUser","membersActivityStatus","supportAgent","team","thread","threadBidders","threadContacts","threadCollaborators","threadIdentifier","addChatMembers","focusChat","markAsRead"]],template:function(e,t){if(1&e&&(n.ad(0,H,17,53,"app-messaging-chat-box",0),n.ad(1,V,13,39,"ng-template",null,1,n.bd)),2&e){const e=n.Nc(2);n.zc("ngIf",t.chatboxMode)("ngIfElse",e)}},directives:[z.q,T.b,X],pipes:[Y.a],styles:["[_nghost-%COMP%]{display:block;height:100%}"],changeDetection:0}),e})()},WcJj:function(e,t,i){"use strict";i.d(t,"a",function(){return us});var n=i("SVse"),a=i("s7LF"),s=i("oA5+"),o=i("jZoe"),r=i("9u4R"),c=i("tqRt"),l=i("OpNG");function d(){return{defaultOrder:{field:"maxWeight",direction:l.a.DESC},fetch:(e,t,i,n)=>({endpoint:"contacts/0.1/contacts",params:{}}),push:void 0,set:void 0,update:void 0,remove:void 0}}var h=i("cUs2"),g=i("f6cb"),u=i("Z9nB");function b(e){const t=e.relationships?Object.values(e.relationships).filter(g.g).map(e=>e.weight).filter(g.g):[];return Object.assign(Object.assign({},Object(u.a)(e.user)),{maxWeight:Math.max(0,...t)})}function f(e={},t){switch(t.type){case"API_FETCH_SUCCESS":if("contacts"===t.payload.type){const{result:i,ref:n,order:a}=t.payload;return Object(h.o)(e,Object(h.z)(i.contacts,b,n.path.authUid),a,n)}return e;default:return e}}var p=i("8Y7J");let m=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=p.Qb({type:e}),e.\u0275inj=p.Pb({imports:[[c.j.forFeature("contacts",f),r.d.forFeature("contacts",d)]]}),e})();var C=i("VFv1"),M=i("7bNT");function S(){return{defaultOrder:{field:"timeCreated",direction:l.a.DESC},fetch:(e,t,i,n)=>({endpoint:"messages/0.1/messages",params:{threads:Object(h.h)(i,"threadId"),thread_details:"true"}}),push:(e,t)=>({endpoint:`messages/0.1/threads/${t.threadId}/messages/`,asFormData:!0,payload:{message:t.message,client_message_id:String(t.clientMessageId?t.clientMessageId:Date.now()),source:t.messageSource}}),set:void 0,update:void 0,remove:void 0}}var x=i("mrSG"),y=i("FRAM"),T=i("pLZG"),I=i("lJxs"),O=i("zp1y"),v=i("/wLE"),A=i("yeKy");let w=(()=>{class e{constructor(e,t,i,n){this.actions$=e,this.auth=t,this.store$=i,this.messagingChat=n,this.fetchData$=this.actions$.pipe(Object(T.a)(y.c),Object(I.a)(e=>e.payload),Object(T.a)(k),Object(O.a)(this.store$,this.auth.authState$),Object(T.a)(([e])=>!!e),Object(I.a)(([e,t,i])=>{if(i&&e.data.notify_user&&e.data.from_user!==Object(g.r)(i.userId)&&this.messagingChat.canStartChat())return void this.messagingChat.startChat({userIds:e.data.thread_details.members,threadType:e.data.thread_details.thread_type,origin:"websocket",context:e.data.thread_details.context,threadId:e.data.thread_id,focus:!1,doNotRedirect:!0});const n={collection:"threads",authUid:e.toUserId,ids:[String(e.data.thread_id)]};return Object(h.s)(t.threads,n,e.data.thread_id)?void 0:{type:"REQUEST_DATA",payload:{type:"threads",ref:{path:n},clientRequestIds:[]}}}),Object(T.a)(g.g))}}return e.\u0275fac=function(t){return new(t||e)(p.jc(M.a),p.jc(v.a),p.jc(c.h),p.jc(A.d))},e.\u0275prov=p.Ob({token:e,factory:e.\u0275fac}),Object(x.b)([Object(M.b)()],e.prototype,"fetchData$",void 0),e})();function k(e){return"private"===e.type&&"messages"===e.parent_type}var z=i("etQe"),E=i("OI7T");function L(e={},t){switch(t.type){case"API_FETCH_SUCCESS":if("messages"===t.payload.type){const{result:i,ref:n,order:a}=t.payload;return Object(h.o)(e,Object(h.z)(i.messages,E.a),a,n)}return e;case"API_PUSH_SUCCESS":if("messages"===t.payload.type){const{result:i,ref:n}=t.payload;return Object(h.q)(e,Object(h.z)([i],E.a),n)}return e;case"WS_MESSAGE":{const{payload:i}=t;if("messages"===i.parent_type&&"private"===i.type){const t={path:{collection:"messages",authUid:i.toUserId}};return Object(h.q)(e,Object(h.z)([i],E.b),t)}if("messages"===i.parent_type&&"attach"===i.type){const t={collection:"messages",authUid:i.toUserId},n=i.data.message_id,a={path:t};return Object(h.q)(e,Object(h.z)([i.data.thread_id],a=>{const s=Object(h.s)(e,t,n);return s?Object.assign(Object.assign({},s),{attachments:[...s.attachments||[],...i.data.filenames]}):{id:i.data.message_id,attachments:i.data.filenames,fromUser:i.data.from_user,message:"",messageSource:"chat_box",threadId:i.data.thread_id,timeCreated:i.timestamp,sendStatus:z.a.SENT}}),a)}return e}default:return e}}let _=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=p.Qb({type:e}),e.\u0275inj=p.Pb({imports:[[c.j.forFeature("messages",L),M.c.forFeature([w]),r.d.forFeature("messages",S)]]}),e})();var j=i("O3cg"),P=i("QcR0"),R=i("fejZ"),B=i("eI96"),$=i("EgRV"),U=i("I0A4"),G=i("ynQg"),N=i("jnT3"),F=i("7LCa");function D(){return{defaultOrder:{field:"id",direction:l.a.DESC},fetch:(e,t,i,n)=>({endpoint:"messages/0.1/threads/search",params:{query:i&&i.searchQueryParams&&i.searchQueryParams.searchTerm}}),push:void 0,set:void 0,update:void 0,remove:void 0}}var X=i("AO4K");function Y(e={},t){switch(t.type){case"API_FETCH_SUCCESS":if("searchThreads"===t.payload.type){const{result:i,ref:n,order:a}=t.payload;return Object(h.o)(e,Object(h.z)(i.threads,X.b,n.path.authUid),a,n)}return e;default:return e}}let H=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=p.Qb({type:e}),e.\u0275inj=p.Pb({imports:[[c.j.forFeature("searchThreads",Y),r.d.forFeature("searchThreads",D)]]}),e})();var V=i("gKBM"),Q=i("pjJp"),W=i("c/oE"),q=i("v7L1"),K=i("VkX4"),Z=i("CJMb"),J=i("cNBb"),ee=i("EXHp"),te=i("18b0"),ie=i("cokP"),ne=i("OS7q"),ae=i("yotz"),se=i("iAS6"),oe=i("gJiX"),re=i("eiII"),ce=i("sfSt"),le=i("HsDr"),de=i("o9eT"),he=i("yvyY"),ge=i("NtPp"),ue=i("UlxN"),be=i("dO68"),fe=i("B23V"),pe=i("lDT0"),me=i("9Aot"),Ce=i("4ykm"),Me=i("Rnop"),Se=i("cs8y"),xe=i("ueDg"),ye=i("b6KT"),Te=i("iInd"),Ie=i("3A0Z"),Oe=i("eCtd"),ve=i("HEOu"),Ae=i("DSso"),we=i("ni7p"),ke=i("w13q"),ze=i("SMHo"),Ee=i("Bxc1"),Le=i("pZRy"),_e=i("565b"),je=i("al+g");function Pe(e,t){1&e&&(p.Yb(0,"fl-text",6),p.cc(1,7),p.Xb())}function Re(e,t){if(1&e&&(p.Yb(0,"fl-link",8),p.cd(1),p.Xb()),2&e){const e=p.rc(3);p.Ac("link",null==e.state?null:e.state.linkUrl),p.zc("queryParams",null==e.state?null:e.state.linkQueryParams),p.Gb(1),p.ed(" ",null==e.state?null:e.state.linkText," ")}}function Be(e,t){}function $e(e,t){if(1&e&&(p.Wb(0),p.ad(1,Pe,2,0,"fl-text",3),p.ad(2,Re,2,3,"fl-link",4),p.ad(3,Be,0,0,"ng-template",5),p.Vb()),2&e){p.rc();const e=p.Nc(4),t=p.rc();p.Gb(1),p.zc("ngIf","hireme"===t.state.name),p.Gb(1),p.zc("ngIf","hireme"!==t.state.name),p.Gb(1),p.zc("ngTemplateOutlet",e)}}function Ue(e,t){if(1&e&&(p.Yb(0,"fl-text",19),p.cd(1),p.Tb(2,"fl-online-indicator",20),p.Xb()),2&e){const e=p.rc(4);p.zc("flMarginBottom",e.Margin.XXSMALL)("weight",e.FontWeight.BOLD),p.Gb(1),p.ed(" ",e.state.otherUserName," "),p.Gb(1),p.zc("isOnline",e.isOnline)("flMarginRight",e.Margin.SMALL)}}function Ge(e,t){if(1&e&&(p.Yb(0,"fl-text",19),p.cd(1),p.Xb()),2&e){const e=p.rc(4);p.zc("flMarginBottom",e.Margin.XXSMALL)("weight",e.FontWeight.BOLD),p.Gb(1),p.ed(" ",e.otherMembersList," ")}}function Ne(e,t){1&e&&(p.Yb(0,"fl-text"),p.cc(1,21),p.Xb())}function Fe(e,t){if(1&e&&(p.Yb(0,"fl-link",22),p.cd(1),p.Xb()),2&e){const e=p.rc(4);p.zc("link",e.state.linkUrl)("queryParams",e.state.linkQueryParams)("color",e.chatBoxMode?e.LinkColor.INHERIT:e.LinkColor.DARK)("hoverColor",e.LinkHoverColor.INHERIT),p.Gb(1),p.ed(" ",e.state.linkText," ")}}function De(e,t){if(1&e&&(p.Yb(0,"fl-text",23),p.ic(1,24),p.Tb(2,"fl-relative-time",25),p.fc(),p.Xb()),2&e){const e=p.rc(4);p.zc("fontType",e.FontType.PARAGRAPH)("color",e.FontColor.MID)("size",e.TextSize.XXSMALL)("flHideMobile",!0),p.Gb(2),p.zc("date",e.state.timeSubmitted)("size",e.TextSize.XXSMALL)}}function Xe(e,t){if(1&e&&(p.Yb(0,"fl-grid",13),p.Yb(1,"fl-col",14),p.ad(2,Ue,3,5,"fl-text",15),p.ad(3,Ge,2,3,"fl-text",15),p.Xb(),p.Yb(4,"fl-col"),p.Yb(5,"fl-bit",16),p.ad(6,Ne,2,0,"fl-text",0),p.ad(7,Fe,2,5,"fl-link",17),p.Xb(),p.ad(8,De,3,6,"fl-text",18),p.Xb(),p.Xb()),2&e){const e=p.rc(3);p.zc("vAlign",e.VerticalAlignment.VERTICAL_STRETCH),p.Gb(1),p.zc("flHideDesktop",!0),p.Gb(1),p.zc("ngIf",!e.isGroupChatThread),p.Gb(1),p.zc("ngIf",e.isGroupChatThread),p.Gb(2),p.zc("flMarginBottom",e.Margin.XXSMALL),p.Gb(1),p.zc("ngIf","hireme"===e.state.name),p.Gb(1),p.zc("ngIf","hireme"!==e.state.name),p.Gb(1),p.zc("ngIf","hireme"!==e.state.name)}}function Ye(e,t){1&e&&(p.Wb(0),p.cc(1,27),p.Vb())}function He(e,t){if(1&e&&(p.Wb(0),p.cc(1,28),p.Vb()),2&e){const e=p.rc(4);p.Gb(1),p.gc(e.state.otherUserName),p.dc(1)}}function Ve(e,t){if(1&e&&(p.Wb(0),p.cc(1,29),p.Vb()),2&e){const e=p.rc(4);p.Gb(1),p.gc(e.state.otherUserName),p.dc(1)}}function Qe(e,t){if(1&e&&(p.Wb(0),p.cc(1,30),p.Vb()),2&e){const e=p.rc(4);p.Gb(1),p.gc(e.state.otherUserName),p.dc(1)}}function We(e,t){1&e&&(p.ic(0,31,1),p.Ub(1),p.fc())}function qe(e,t){if(1&e&&(p.Wb(0),p.ic(1,31),p.ad(2,We,2,0,"ng-container",0),p.fc(),p.Vb()),2&e){const e=p.rc(4);p.Gb(2),p.zc("ngIf",!(null!=e.state.otherUserName&&e.state.otherUserName.endsWith("."))),p.gc(e.state.otherUserName),p.dc(1)}}function Ke(e,t){if(1&e&&(p.Wb(0),p.cc(1,32),p.Vb()),2&e){const e=p.rc(4);p.Gb(1),p.gc(e.state.otherUserName),p.dc(1)}}function Ze(e,t){if(1&e&&(p.Wb(0),p.cc(1,33),p.Vb()),2&e){const e=p.rc(4);p.Gb(1),p.gc(e.state.otherUserName),p.dc(1)}}function Je(e,t){if(1&e&&(p.Yb(0,"fl-bit"),p.Yb(1,"fl-text",26),p.ad(2,Ye,2,0,"ng-container",0),p.ad(3,He,2,1,"ng-container",0),p.ad(4,Ve,2,1,"ng-container",0),p.ad(5,Qe,2,1,"ng-container",0),p.sc(6,"flAsync"),p.ad(7,qe,3,2,"ng-container",0),p.ad(8,Ke,2,1,"ng-container",0),p.ad(9,Ze,2,1,"ng-container",0),p.Xb(),p.Xb()),2&e){const e=p.rc(3);p.Gb(1),p.zc("flMarginBottom",e.Margin.XXSMALL),p.Gb(1),p.zc("ngIf","hireme"===e.state.name),p.Gb(1),p.zc("ngIf","projectAwardHourly"===e.state.name||"projectAwardFixed"===e.state.name),p.Gb(1),p.zc("ngIf","projectAcceptHourly"===e.state.name||"projectAcceptFixed"===e.state.name||"projectAcceptRedirect"===e.state.name),p.Gb(1),p.zc("ngIf","setupBilling"===e.state.name&&p.tc(6,8,e.billingEnabled$)),p.Gb(2),p.zc("ngIf","milestoneCreateRedirect"===e.state.name||"milestoneCreateFromRequest"===e.state.name||"milestoneCreateInitial"===e.state.name||"milestoneCreate"===e.state.name),p.Gb(1),p.zc("ngIf","trackTime"===e.state.name),p.Gb(1),p.zc("ngIf","requestMilestone"===e.state.name||"requestMilestoneRedirect"===e.state.name)}}function et(e,t){}function tt(e,t){if(1&e&&(p.Yb(0,"fl-grid",9),p.Yb(1,"fl-col",10),p.ad(2,Xe,9,8,"fl-grid",11),p.ad(3,Je,10,10,"fl-bit",0),p.Xb(),p.Yb(4,"fl-col",10),p.Yb(5,"fl-bit",12),p.ad(6,et,0,0,"ng-template",5),p.Xb(),p.Xb(),p.Xb()),2&e){p.rc();const e=p.Nc(4),t=p.rc();p.zc("hAlign",t.HorizontalAlignment.HORIZONTAL_CENTER)("vAlign",t.VerticalAlignment.VERTICAL_CENTER),p.Gb(1),p.zc("col",12)("colTablet",t.extended?12:9)("colDesktopSmall",t.extended?12:9),p.Gb(1),p.zc("ngIf",!t.extended),p.Gb(1),p.zc("ngIf",t.extended),p.Gb(1),p.zc("col",12)("colTablet",t.extended?12:3)("colDesktopSmall",t.extended?12:3),p.Gb(2),p.zc("ngTemplateOutlet",e)}}function it(e,t){1&e&&(p.Wb(0),p.cc(1,36),p.Vb())}function nt(e,t){1&e&&(p.Wb(0),p.cc(1,37),p.Vb())}function at(e,t){1&e&&(p.Wb(0),p.cc(1,38),p.Vb())}function st(e,t){1&e&&(p.Wb(0),p.cc(1,39),p.Vb())}function ot(e,t){1&e&&(p.Wb(0),p.cc(1,40),p.Vb())}function rt(e,t){1&e&&(p.Wb(0),p.cc(1,41),p.Vb())}function ct(e,t){1&e&&(p.Wb(0),p.cc(1,42),p.Vb())}function lt(e,t){1&e&&(p.Wb(0),p.cc(1,43),p.Vb())}function dt(e,t){1&e&&(p.Wb(0),p.cc(1,44),p.Vb())}function ht(e,t){if(1&e){const e=p.Zb();p.Yb(0,"fl-button",35),p.nc("click",function(){return p.Qc(e),p.rc(4).handleButtonClick()}),p.ad(1,it,2,0,"ng-container",0),p.ad(2,nt,2,0,"ng-container",0),p.ad(3,at,2,0,"ng-container",0),p.ad(4,st,2,0,"ng-container",0),p.ad(5,ot,2,0,"ng-container",0),p.ad(6,rt,2,0,"ng-container",0),p.ad(7,ct,2,0,"ng-container",0),p.ad(8,lt,2,0,"ng-container",0),p.ad(9,dt,2,0,"ng-container",0),p.Xb()}if(2&e){const e=p.rc(4);p.Bc("flTrackingLabel","contextBoxButton-",null==e.state?null:e.state.name,""),p.zc("busy",e.buttonBusy)("color",e.buttonColor)("size",e.ButtonSize.MINI)("sizeTablet",e.chatBoxMode?e.ButtonSize.MINI:e.ButtonSize.SMALL),p.Hb("data-uitest-target",null==e.state||null==e.state.button?null:e.state.button.tag),p.Gb(1),p.zc("ngIf","hireme"===e.state.name),p.Gb(1),p.zc("ngIf","projectAwardHourly"===e.state.name||"projectAwardFixed"===e.state.name),p.Gb(1),p.zc("ngIf","projectAcceptHourly"===e.state.name||"projectAcceptFixed"===e.state.name||"projectAcceptRedirect"===e.state.name),p.Gb(1),p.zc("ngIf","setupBilling"===e.state.name),p.Gb(1),p.zc("ngIf","payFailedInvoices"===e.state.name),p.Gb(1),p.zc("ngIf","milestoneCreateRedirect"===e.state.name||"milestoneCreateFromRequest"===e.state.name||"milestoneCreateInitial"===e.state.name||"milestoneCreate"===e.state.name),p.Gb(1),p.zc("ngIf","trackTime"===e.state.name),p.Gb(1),p.zc("ngIf","requestMilestone"===e.state.name||"requestMilestoneRedirect"===e.state.name),p.Gb(1),p.zc("ngIf","projectAdmin"===e.state.name||"userAdmin"===e.state.name)}}function gt(e,t){if(1&e&&(p.Wb(0),p.ad(1,ht,10,15,"fl-button",34),p.Vb()),2&e){const e=p.rc(3);p.Gb(1),p.zc("ngIf",e.state.button)}}function ut(e,t){if(1&e&&(p.ad(0,gt,2,1,"ng-container",0),p.sc(1,"flAsync")),2&e){const e=p.rc(2);p.zc("ngIf",p.tc(1,1,e.billingEnabled$)||"setupBilling"!==(null==e.state?null:e.state.name))}}function bt(e,t){if(1&e&&(p.Wb(0),p.ad(1,$e,4,3,"ng-container",0),p.ad(2,tt,7,11,"fl-grid",1),p.ad(3,ut,2,3,"ng-template",null,2,p.bd),p.Vb()),2&e){const e=p.rc();p.Gb(1),p.zc("ngIf",e.chatBoxMode),p.Gb(1),p.zc("ngIf",!e.chatBoxMode)}}function ft(e,t){if(1&e&&p.Tb(0,"fl-online-indicator",20),2&e){const e=p.rc(2);p.zc("isOnline",e.isOnline)("flMarginRight",e.Margin.SMALL)}}function pt(e,t){if(1&e&&(p.Yb(0,"fl-text",47),p.cc(1,48),p.Xb()),2&e){const e=p.rc(2);p.zc("color",e.FontColor.MID)("fontType",e.FontType.PARAGRAPH)("size",e.TextSize.XXSMALL)}}function mt(e,t){if(1&e&&(p.Wb(0),p.Yb(1,"fl-text",19),p.cd(2),p.ad(3,ft,1,2,"fl-online-indicator",45),p.Xb(),p.ad(4,pt,2,3,"fl-text",46),p.Vb()),2&e){const e=p.rc();p.Gb(1),p.zc("flMarginBottom",e.Margin.XXXSMALL)("weight",e.FontWeight.BOLD),p.Gb(1),p.ed(" ",e.otherMembersList," "),p.Gb(1),p.zc("ngIf",!e.isGroupChatThread),p.Gb(1),p.zc("ngIf",!e.isGroupChatThread&&e.isOtherMemberSupportUser)}}let Ct=(()=>{class e{constructor(e,t,i,n,a){this.router=e,this.modalService=t,this.datastore=i,this.changeDetectorRef=n,this.featureFlagService=a,this.ButtonSize=be.a,this.FontType=de.b,this.FontColor=Me.a,this.TextSize=de.f,this.FontWeight=de.c,this.HorizontalAlignment=re.b,this.LinkColor=pe.a,this.LinkHoverColor=pe.c,this.Margin=me.a,this.VerticalAlignment=re.c,this.otherMembers=[],this.extended=!1,this.buttonColor=fe.a.SECONDARY,this.buttonBusy=!1,this.greenBtnStates=["projectAwardHourly","projectAwardFixed","projectAcceptFixed","projectAcceptHourly","projectAcceptRedirect"]}ngOnInit(){this.billingEnabled$=this.featureFlagService.getFlag(ue.b.BILLING)}handleButtonClick(){if(this.state&&this.state.name)switch(this.state.name){case"hireme":case"milestoneCreateRedirect":case"projectAwardHourly":case"projectAcceptRedirect":case"setupBilling":case"trackTime":case"requestMilestoneRedirect":case"payFailedInvoices":this.state.button&&"LINK"===this.state.button.data.type&&this.goToUrl(this.state.button.data.buttonUrl,this.state.button.data.buttonExtras);break;case"projectAwardFixed":this.awardFixed();break;case"milestoneCreate":case"milestoneCreateInitial":case"milestoneCreateFromRequest":this.createMilestone();break;case"requestMilestone":this.requestMilestone();break;case"projectAcceptHourly":case"projectAcceptFixed":this.accept();break;default:console.warn("Unknown context box state button clicked")}}ngOnChanges(e){if(this.state&&this.state.name&&(this.buttonColor=this.greenBtnStates.includes(this.state.name)?fe.a.SUCCESS:fe.a.SECONDARY),"otherMembers"in e){const e=this.otherMembers.slice(0,3).map(e=>e.displayName).join(", ");this.otherMembersList=this.otherMembers.length>3?`${e}, +${this.otherMembers.length-3}`:e,this.isOtherMemberSupportUser=!!this.otherMembers.find(e=>Object(ye.f)(e))}}goToUrl(e,t){t?this.router.navigate([e],t):this.router.navigate([e])}awardFixed(){if(this.state&&this.state.button&&"AWARD_FIXED"===this.state.button.data.type){const{bidId:e,projectId:t}=this.state.button.data;this.buttonBusy=!0;const i=this.modalService.open("AwardModal",{inputs:{bidId:e,projectId:t},size:Ce.a.LARGE,edgeToEdge:!0,mobileFullscreen:!0});i.afterOpen().toPromise().then(e=>{this.buttonBusy=!1,this.changeDetectorRef.markForCheck()}),i.afterClosed().toPromise().then(e=>{e&&this.goToUrl(`/projects/${t}.html`,{fragment:"/management"})})}}createMilestone(){if(this.state&&this.state.button&&"CREATE_MILESTONE"===this.state.button.data.type&&"hireme"!==this.state.name){this.buttonBusy=!0;const{bidderId:e,bidId:t,projectId:i,currencyDetails:n}=this.state.button.data;this.modalService.open("MilestoneCreateModal",{inputs:{bidId:t,projectId:i,currencyDetails:n,username:this.state.otherUserName,bidderId:e},size:Ce.a.SMALL}).afterOpen().toPromise().then(()=>{this.changeDetectorRef.markForCheck(),this.buttonBusy=!1})}}requestMilestone(){this.state&&this.state.button&&"hireme"!==this.state.name&&"REQUEST_MILESTONE"===this.state.button.data.type&&(this.buttonBusy=!0,this.router.navigate(["/projects",this.state.button.data.projectId,"payments"],{queryParams:{request_milestone:1}}),this.buttonBusy=!1)}accept(){if(this.state&&this.state.button&&"ACCEPT"===this.state.button.data.type){this.buttonBusy=!0;const{projectId:e}=this.state.button.data;this.datastore.collection("bids",t=>t.where("projectId","==",e)).update(this.state.button.data.bidId,{awardStatus:xe.BidAwardStatusApi.AWARDED}).then(t=>{this.buttonBusy=!1,this.changeDetectorRef.markForCheck(),"error"!==t.status||t.errorCode!==Se.ErrorCodeApi.ESCROWCOM_ACCOUNT_UNLINKED&&t.errorCode!==Se.ErrorCodeApi.PROFILE_INCOMPLETE&&t.errorCode!==Se.ErrorCodeApi.NDA_NOT_SIGNED||this.goToUrl(`/projects/${e}`)})}}}return e.\u0275fac=function(t){return new(t||e)(p.Sb(Te.e),p.Sb(Ie.b),p.Sb(Oe.a),p.Sb(p.h),p.Sb(ve.a))},e.\u0275cmp=p.Mb({type:e,selectors:[["app-context-box"]],inputs:{state:"state",isOnline:"isOnline",isGroupChatThread:"isGroupChatThread",otherMembers:"otherMembers",extended:"extended",chatBoxMode:"chatBoxMode"},features:[p.Eb],decls:2,vars:2,consts:function(){let e,t,i,n,a,s,o,r,c,l,d,h,g,u,b,f,p,m,C,M;return e=" I'm available! Let's work together. ",t=" I'm available! Let's work together. ",i=" Posted " + "\ufffd#2\ufffd" + "" + "\ufffd/#2\ufffd" + "",n=" I'm available! Let's work together. ",a=" To start working with this freelancer, award " + "\ufffd0\ufffd" + " the project. They will be notified that you have chosen them for your project. ",s=" " + "\ufffd0\ufffd" + " has chosen you for their project. Accept the project to begin working. ",o=" Set up billing to allow " + "\ufffd0\ufffd" + " to track hours they work, and invoice you automatically each Monday. ",r=" Create a Milestone Payment for " + "\ufffd0\ufffd" + "" + "\ufffd*2:1\ufffd\ufffd#1:1\ufffd" + "." + "\ufffd/#1:1\ufffd\ufffd/*2:1\ufffd" + " This is a secure deposit for work they are about to do which you can release when you're happy. ",c=" Track the hours you are working, and we will automatically invoice " + "\ufffd0\ufffd" + " each Monday. ",l=" Create a request for " + "\ufffd0\ufffd" + " to make a Milestone Payment. They will be notified that you have requested a milestone payment. ",d=" Hire Me! ",h=" Award ",g=" Accept ",u=" Setup Billing ",b=" Pay Outstanding Bill ",f=" Create Milestone ",p=" Track Time ",m=" Request Milestone ",C=" View Admin ",M=" Freelancer Staff ",[[4,"ngIf"],[3,"hAlign","vAlign",4,"ngIf"],["contextButton",""],["class","ContextBox-title",4,"ngIf"],["class","ContextBox-title","flTrackingLabel","ContextBox-link",3,"queryParams","link",4,"ngIf"],[3,"ngTemplateOutlet"],[1,"ContextBox-title"],e,["flTrackingLabel","ContextBox-link",1,"ContextBox-title",3,"queryParams","link"],[3,"hAlign","vAlign"],[3,"col","colTablet","colDesktopSmall"],[3,"vAlign",4,"ngIf"],[1,"ContextBox-buttonWrapper"],[3,"vAlign"],[3,"flHideDesktop"],[3,"flMarginBottom","weight",4,"ngIf"],[1,"ContextBox-header",3,"flMarginBottom"],["class","ContextBox-projectLink","flTrackingLabel","Inbox.ProjectLink",3,"link","queryParams","color","hoverColor",4,"ngIf"],[3,"fontType","color","size","flHideMobile",4,"ngIf"],[3,"flMarginBottom","weight"],[3,"isOnline","flMarginRight"],t,["flTrackingLabel","Inbox.ProjectLink",1,"ContextBox-projectLink",3,"link","queryParams","color","hoverColor"],[3,"fontType","color","size","flHideMobile"],i,[3,"date","size"],[3,"flMarginBottom"],n,a,s,o,r,c,l,["class","ContextBox-button",3,"flTrackingLabel","busy","color","size","sizeTablet","click",4,"ngIf"],[1,"ContextBox-button",3,"flTrackingLabel","busy","color","size","sizeTablet","click"],d,h,g,u,b,f,p,m,C,[3,"isOnline","flMarginRight",4,"ngIf"],[3,"color","fontType","size",4,"ngIf"],[3,"color","fontType","size"],M]},template:function(e,t){1&e&&(p.ad(0,bt,5,2,"ng-container",0),p.ad(1,mt,5,5,"ng-container",0)),2&e&&(p.zc("ngIf",t.state),p.Gb(1),p.zc("ngIf",!t.state&&!t.chatBoxMode))},directives:[n.q,n.v,de.e,pe.b,Ae.a,re.a,we.a,ke.a,ze.a,me.b,Ee.a,Le.b,fe.b,_e.a],pipes:[je.a],styles:[".ContextBox-title[_ngcontent-%COMP%]{font-size:14px;line-height:1.43;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;flex:0 1 auto;padding-right:4px}.ContextBox-buttonWrapper[_ngcontent-%COMP%]{align-items:flex-start;display:flex;flex-direction:column}@media (min-width:768px){.ContextBox-buttonWrapper[_ngcontent-%COMP%]{align-items:flex-end}}.ContextBox-button[_ngcontent-%COMP%]{flex:0 0 auto;white-space:nowrap}.ContextBox-header[_ngcontent-%COMP%]{max-width:400px;overflow:hidden;white-space:nowrap}@media (min-width:960px){.ContextBox-header[_ngcontent-%COMP%]{max-width:600px}}.ContextBox-projectLink[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;display:block;width:100%}"],changeDetection:0}),e})();function Mt(e,t){if(1&e&&(p.Wb(0),p.Tb(1,"app-context-box",3),p.Vb()),2&e){const e=p.rc(2);p.Gb(1),p.zc("state",e.contextBoxState)("isOnline",e.isOnline)("isGroupChatThread",e.isGroupChatThread)("chatBoxMode",!1)("otherMembers",e.otherMembers)}}function St(e,t){if(1&e&&(p.Wb(0),p.Yb(1,"fl-heading",4),p.cc(2,5),p.Xb(),p.Vb()),2&e){const e=p.rc(2);p.Gb(1),p.zc("headingType",e.HeadingType.H4)("size",e.TextSize.LARGE)}}function xt(e,t){if(1&e){const e=p.Zb();p.Yb(0,"fl-view-header",1),p.nc("menuClick",function(){return p.Qc(e),p.rc().openChatOptionsDrawer()}),p.ad(1,Mt,2,5,"ng-container",2),p.ad(2,St,3,2,"ng-container",2),p.Xb()}if(2&e){const e=p.rc();p.zc("sideNotch",!1)("showMenu",!e.emptyState),p.Gb(1),p.zc("ngIf",!e.emptyState),p.Gb(1),p.zc("ngIf",e.emptyState)}}let yt=(()=>{class e{constructor(){this.ViewHeaderType=he.b,this.VerticalAlignment=re.c,this.TextSize=de.f,this.HeadingType=ce.c,this.IconColor=le.c,this.IconSize=le.e,this.chatOptionsDrawerToggle=new p.n}openChatOptionsDrawer(){this.chatOptionsDrawerToggle.emit(!0)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=p.Mb({type:e,selectors:[["app-messaging-inbox-header"]],inputs:{emptyState:"emptyState",contextBoxState:"contextBoxState",isOnline:"isOnline",isGroupChatThread:"isGroupChatThread",otherMembers:"otherMembers"},outputs:{chatOptionsDrawerToggle:"chatOptionsDrawerToggle"},decls:1,vars:2,consts:function(){let e;return e=" Messages ",[[3,"sideNotch","showMenu","menuClick",4,"flViewHeaderTemplate","flViewHeaderTemplateFullReplacement"],[3,"sideNotch","showMenu","menuClick"],[4,"ngIf"],[1,"ContextBox",3,"state","isOnline","isGroupChatThread","chatBoxMode","otherMembers"],[3,"headingType","size"],e]},template:function(e,t){1&e&&p.ad(0,xt,3,4,"fl-view-header",0),2&e&&p.zc("flViewHeaderTemplate",t.ViewHeaderType.SHOW_ALL)("flViewHeaderTemplateFullReplacement",!0)},directives:[he.a,ge.b,n.q,Ct,ce.b],styles:["[_nghost-%COMP%]{border-right:1px solid #dedede;display:block}.ContextBox[_ngcontent-%COMP%]{display:block;padding-bottom:12px;padding-top:12px}@media (min-width:960px){.ContextBox[_ngcontent-%COMP%]{padding-bottom:8px;padding-top:8px}}"],changeDetection:0}),e})();var Tt=i("HLWz");function It(e,t){if(1&e&&(p.Yb(0,"fl-bit",4),p.Tb(1,"fl-bit",5),p.Xb()),2&e){const e=p.rc();p.Gb(1),p.Xc("width",e.progressBarWidth)}}function Ot(e,t){if(1&e){const e=p.Zb();p.Yb(0,"fl-button",6),p.nc("click",function(){return p.Qc(e),p.rc().removeAttachment()}),p.Tb(1,"fl-icon",7),p.Xb()}if(2&e){const e=p.rc();p.Gb(1),p.zc("color",e.IconColor.MID)("size",e.IconSize.SMALL)("hoverColor",e.HoverColor.PRIMARY)}}let vt=(()=>{class e{constructor(){this.FontType=de.b,this.IconColor=le.c,this.IconSize=le.e,this.HoverColor=le.a,this.removeFailedUpload=new p.n,this.progressBarWidth="0%"}ngOnChanges(e){"progress"in e&&(this.progressBarWidth=this.getProgressBarWidth(e.progress.currentValue))}removeAttachment(){this.removeFailedUpload.emit(this.id)}getProgressBarWidth(e){return e&&void 0!==e.loaded&&void 0!==e.total?`${Math.round(100*e.loaded/e.total)}%`:"0%"}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=p.Mb({type:e,selectors:[["app-attachment-upload"]],hostVars:2,hostBindings:function(e,t){2&e&&p.Kb("UploadFailed",t.failed)},inputs:{id:"id",progress:"progress",filename:"filename",failed:"failed"},outputs:{removeFailedUpload:"removeFailedUpload"},features:[p.Eb],decls:5,vars:7,consts:function(){let e;return e="Failed, please re-attach",[["name","ui-file",3,"color","size","hoverColor"],[1,"TextLabel",3,"fontType"],["class","ProgressBarContainer",4,"ngIf"],["flTrackingLabel","removeAttachment",3,"click",4,"ngIf"],[1,"ProgressBarContainer"],[1,"ProgressBar"],["flTrackingLabel","removeAttachment",3,"click"],["name","ui-close","label",e,3,"color","size","hoverColor"]]},template:function(e,t){1&e&&(p.Tb(0,"fl-icon",0),p.Yb(1,"fl-text",1),p.cd(2),p.Xb(),p.ad(3,It,2,2,"fl-bit",2),p.ad(4,Ot,2,3,"fl-button",3)),2&e&&(p.zc("color",t.IconColor.MID)("size",t.IconSize.SMALL)("hoverColor",t.HoverColor.PRIMARY),p.Gb(1),p.zc("fontType",t.FontType.SPAN),p.Gb(1),p.ed(" ",t.filename," "),p.Gb(1),p.zc("ngIf",!t.failed),p.Gb(1),p.zc("ngIf",t.failed))},directives:[le.d,de.e,n.q,ke.a,fe.b,Ae.a],styles:["[_nghost-%COMP%]{font-size:13px;line-height:1.2;background-color:#ddf5d3;display:flex;padding:8px;position:relative;width:100%}.UploadFailed[_nghost-%COMP%]{background-color:#ffcdc7}.TextLabel[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;flex:1 1 100%;padding-left:4px;width:100px}.ProgressBarContainer[_ngcontent-%COMP%]{background-color:#dedede;bottom:0;height:4px;left:0;position:absolute;width:100%}.ProgressBar[_ngcontent-%COMP%]{background-color:#2a934d;height:100%}.ClearUploadBtn[_ngcontent-%COMP%]{margin-left:auto}"],changeDetection:0}),e})();var At=i("zQqY");function wt(e,t){if(1&e){const e=p.Zb();p.Yb(0,"fl-bit",3),p.Tb(1,"fl-icon",4),p.Yb(2,"fl-bit",5),p.cd(3),p.Xb(),p.Yb(4,"fl-bit",6),p.Yb(5,"fl-text",7),p.cd(6),p.sc(7,"fileSize"),p.Xb(),p.Yb(8,"fl-button",8),p.nc("click",function(){p.Qc(e);const i=t.$implicit;return p.rc(2).handleRemoveAttachment(i)}),p.Tb(9,"fl-icon",9),p.Xb(),p.Xb(),p.Xb()}if(2&e){const e=t.$implicit,i=p.rc(2);p.Gb(1),p.zc("color",i.IconColor.MID)("size",i.IconSize.SMALL)("hoverColor",i.HoverColor.PRIMARY),p.Gb(2),p.ed(" ",e.name," "),p.Gb(2),p.zc("fontType",i.FontType.SPAN),p.Gb(1),p.ed(" ",p.tc(7,9,e.size)," "),p.Gb(3),p.zc("color",i.IconColor.MID)("size",i.IconSize.SMALL)("hoverColor",i.HoverColor.PRIMARY)}}function kt(e,t){if(1&e&&(p.Wb(0),p.ad(1,wt,10,11,"fl-bit",2),p.Vb()),2&e){const e=p.rc();p.Gb(1),p.zc("ngForOf",e.attachments)("ngForTrackBy",e.identifyAttachment)}}function zt(e,t){if(1&e){const e=p.Zb();p.Yb(0,"app-attachment-upload",11),p.nc("removeFailedUpload",function(t){return p.Qc(e),p.rc(2).removeFailedUpload(t)}),p.sc(1,"flAsync"),p.Xb()}if(2&e){const e=t.$implicit;p.zc("id",e.id)("progress",p.tc(1,4,e.progress$))("filename",e.filename)("failed",e.failed)}}function Et(e,t){if(1&e&&(p.Wb(0),p.ad(1,zt,2,6,"app-attachment-upload",10),p.Vb()),2&e){const e=p.rc();p.Gb(1),p.zc("ngForOf",e.uploads)}}let Lt=(()=>{class e{constructor(){this.FontType=de.b,this.IconColor=le.c,this.IconSize=le.e,this.HoverColor=le.a,this.removeAttachment=new p.n,this.removeUpload=new p.n}removeFailedUpload(e){this.removeUpload.emit(e)}handleRemoveAttachment(e){this.removeAttachment.emit(e)}identifyAttachment(e,t){return t.name}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=p.Mb({type:e,selectors:[["app-attachment-list"]],inputs:{thread:"thread",attachments:"attachments",uploads:"uploads"},outputs:{removeAttachment:"removeAttachment",removeUpload:"removeUpload"},decls:3,vars:2,consts:function(){let e;return e="Remove File",[[1,"AttachmentList"],[4,"ngIf"],["class","AttachmentItem",4,"ngFor","ngForOf","ngForTrackBy"],[1,"AttachmentItem"],["name","ui-file",3,"color","size","hoverColor"],[1,"AttachmentItem-filename"],[1,"AttachmentItem-details"],[1,"AttachmentItem-filesize",3,"fontType"],["flTrackingLabel","removeAttachment",1,"AttachmentItem-close",3,"click"],["name","ui-close","label",e,3,"color","size","hoverColor"],[3,"id","progress","filename","failed","removeFailedUpload",4,"ngFor","ngForOf"],[3,"id","progress","filename","failed","removeFailedUpload"]]},template:function(e,t){1&e&&(p.Yb(0,"fl-scrollable-content",0),p.ad(1,kt,2,2,"ng-container",1),p.ad(2,Et,2,1,"ng-container",1),p.Xb()),2&e&&(p.Gb(1),p.zc("ngIf",t.attachments),p.Gb(1),p.zc("ngIf",t.uploads))},directives:[Tt.a,n.q,n.p,ke.a,le.d,de.e,fe.b,Ae.a,vt],pipes:[At.a,je.a],styles:["[_nghost-%COMP%]{background-color:#dbf4ff;display:flex;flex-direction:column;position:relative}.AttachmentList[_ngcontent-%COMP%]{max-height:100px}.AttachmentItem[_ngcontent-%COMP%]{font-size:14px;line-height:1.43;align-items:center;border-top:1px solid #dedede;color:#75787d;display:flex;padding:4px 8px;width:100%}.AttachmentItem-filename[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;flex:1 1 100%;padding-left:4px;width:100px}.AttachmentItem-details[_ngcontent-%COMP%]{align-self:flex-end;display:flex;flex:1 0 auto;justify-content:flex-end;margin-left:auto}.AttachmentItem-filesize[_ngcontent-%COMP%]{font-size:13px;line-height:1.2;padding-right:8px}"],changeDetection:0}),e})();var _t=i("rurT");const jt=["*"];let Pt=(()=>{class e{constructor(){this.IconColor=le.c,this.IconSize=le.e,this.HoverColor=le.a,this.close=new p.n}closeErrorAlert(){this.close.emit()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=p.Mb({type:e,selectors:[["app-error-alert"]],outputs:{close:"close"},ngContentSelectors:jt,decls:6,vars:3,consts:function(){let e;return e="Hide",[[1,"CloseButton"],["flTrackingLabel","closeErrorAlert",3,"click"],["name","ui-close","label",e,3,"color","size","hoverColor"],[1,"ErrorString"]]},template:function(e,t){1&e&&(p.yc(),p.Yb(0,"fl-bit"),p.Yb(1,"fl-bit",0),p.Yb(2,"fl-button",1),p.nc("click",function(){return t.closeErrorAlert()}),p.Tb(3,"fl-icon",2),p.Xb(),p.Xb(),p.Yb(4,"fl-bit",3),p.xc(5),p.Xb(),p.Xb()),2&e&&(p.Gb(3),p.zc("color",t.IconColor.MID)("size",t.IconSize.SMALL)("hoverColor",t.HoverColor.PRIMARY))},directives:[ke.a,fe.b,Ae.a,le.d],styles:["[_nghost-%COMP%]{align-items:flex-end;background:#ffcdc7;color:#891b21;display:block;flex-direction:column;padding:8px}.ErrorString[_ngcontent-%COMP%]{font-size:13px;line-height:1.2;font-weight:700;padding:4px;width:100%}.CloseButton[_ngcontent-%COMP%]{float:right;padding-left:4px}"]}),e})();var Rt=i("tlTr"),Bt=i("YKAE"),$t=i("tbiQ"),Ut=i("tsv4"),Gt=i("n0rP"),Nt=i("riYv"),Ft=i("Z8zW");function Dt(e,t){if(1&e&&(p.Tb(0,"fl-online-indicator",14),p.sc(1,"isOnline"),p.sc(2,"flAsync")),2&e){const e=p.rc();p.zc("username",e.otherUser.username)("isOnline",!!p.uc(1,2,e.otherUser,p.tc(2,5,e.onlineOfflineStatuses$)))}}function Xt(e,t){if(1&e){const e=p.Zb();p.Yb(0,"fl-link",15),p.nc("click",function(t){return p.Qc(e),p.rc().handleBlockedClick(t)}),p.cd(1),p.Xb()}if(2&e){const e=p.rc();p.zc("color",e.LinkColor.LIGHT)("weight",e.LinkWeight.BOLD)("link",e.titleLink)("queryParams",e.titleParams)("hoverColor",e.LinkHoverColor.LIGHT),p.Hb("data-uitest-target",e.project?"chatbox-header-project-name":"chatbox-header-username"),p.Gb(1),p.ed(" ",e.title," ")}}function Yt(e,t){if(1&e&&(p.Yb(0,"fl-bit",16),p.cd(1),p.Xb()),2&e){const e=p.rc();p.Hb("data-uitest-target",e.project?"chatbox-header-project-name":"chatbox-header-username"),p.Gb(1),p.ed(" ",e.title," ")}}function Ht(e,t){if(1&e&&(p.Yb(0,"fl-bit",16),p.cd(1),p.Xb()),2&e){const e=p.rc();p.Hb("data-uitest-target",e.project?"chatbox-header-project-name":"chatbox-header-username"),p.Gb(1),p.ed(" ",e.title," ")}}function Vt(e,t){if(1&e&&(p.Yb(0,"fl-bit",17),p.cd(1),p.Xb()),2&e){const e=p.rc();p.Gb(1),p.ed(" ",e.secondaryTitle," ")}}function Qt(e,t){if(1&e&&p.Tb(0,"fl-relative-time",18),2&e){const e=p.rc();p.zc("color",e.FontColor.LIGHT)("size",e.TextSize.XXXSMALL)("date",e.lastSeenDate)("includeSeconds",!1)("strict",!0)}}function Wt(e,t){if(1&e){const e=p.Zb();p.Yb(0,"fl-tooltip",19),p.Yb(1,"fl-button",20),p.nc("click",function(t){p.Qc(e);const i=p.rc();return i.handleAudioCallClick(t,null==i.callsEnabled?null:i.callsEnabled.audio.recorded)}),p.Tb(2,"fl-icon",21),p.Xb(),p.Xb()}if(2&e){const e=p.rc();p.zc("position",e.TooltipPosition.TOP_CENTER)("message",!(null!=e.callsEnabled&&e.callsEnabled.audio.enabled)&&(null==e.callsEnabled?null:e.callsEnabled.reason)||"Start an audio call"),p.Gb(1),p.Hb("data-uitest-target","chatbox-audiochat-button"),p.Gb(1),p.zc("color",e.IconColor.LIGHT)("size",e.IconSize.SMALL)("hoverColor",e.HoverColor.PRIMARY)("name","ui-phone")}}function qt(e,t){if(1&e){const e=p.Zb();p.Yb(0,"fl-tooltip",19),p.Yb(1,"fl-button",22),p.nc("click",function(t){return p.Qc(e),p.rc().handleVideoCallClick(t)}),p.Tb(2,"fl-icon",21),p.Xb(),p.Xb()}if(2&e){const e=p.rc();p.zc("position",e.TooltipPosition.TOP_CENTER)("message",!(null!=e.callsEnabled&&e.callsEnabled.video.enabled)&&(null==e.callsEnabled?null:e.callsEnabled.reason)||"Start a video call"),p.Gb(1),p.Hb("data-uitest-target","chatbox-videochat-button"),p.Gb(1),p.zc("color",e.IconColor.LIGHT)("size",e.IconSize.SMALL)("hoverColor",e.HoverColor.PRIMARY)("name","ui-video-camera-v2")}}function Kt(e,t){if(1&e&&p.Tb(0,"fl-icon",26),2&e){const e=p.rc(2);p.zc("color",e.IconColor.LIGHT)("size",e.IconSize.SMALL)("hoverColor",e.HoverColor.PRIMARY)}}function Zt(e,t){if(1&e&&p.Tb(0,"fl-icon",27),2&e){const e=p.rc(2);p.zc("color",e.IconColor.LIGHT)("size",e.IconSize.SMALL)("hoverColor",e.HoverColor.PRIMARY)}}function Jt(e,t){if(1&e){const e=p.Zb();p.Yb(0,"fl-button",23),p.nc("click",function(t){return p.Qc(e),p.rc().handleGroupchatButtonClick(t)}),p.ad(1,Kt,1,3,"fl-icon",24),p.ad(2,Zt,1,3,"fl-icon",25),p.Xb()}if(2&e){const e=p.rc();p.Gb(1),p.zc("ngIf",e.canManageChatMembers()),p.Gb(1),p.zc("ngIf",!e.canManageChatMembers())}}let ei=(()=>{class e{constructor(e){this.videochat=e,this.FontColor=Me.a,this.HoverColor=le.a,this.IconColor=le.c,this.IconSize=le.e,this.LinkColor=pe.a,this.LinkHoverColor=pe.c,this.LinkWeight=pe.f,this.TextSize=de.f,this.TooltipPosition=Bt.b,this.focusState=Rt.a.Neither,this.isUserSupportAgent=!1,this.closeChat=new p.n,this.handleSettingsHeaderClick=new p.n,this.handleGroupchatHeaderClick=new p.n,this.makingCall=new p.n,this.isFocused=!1,this.isUnread=!1,this.isSupportChat=!1,this.isThreadSupportSession=!1,this.isArrowProject=!1,this.threadHasContext=!1,this.showLastSeen=!1}static getSupportQueueTitle(e){switch(e.type){case Gt.SupportTypeApi.TECHNICAL:return"Technical";case Gt.SupportTypeApi.RECRUITER:return"Recruiter Chat";case Gt.SupportTypeApi.GENERAL:return"General Chat";case Gt.SupportTypeApi.LOCAL:return"Local Jobs";case Gt.SupportTypeApi.PAYMENT_SATISFACTION:return"Payment Satisfaction";case Gt.SupportTypeApi.PROJECT_MANAGEMENT:return"Project Management";case Gt.SupportTypeApi.SUCCESS_MANAGER:return"Success Manager";case Gt.SupportTypeApi.MEMBERSHIP_CURATION:return"Membership Curation";case Gt.SupportTypeApi.ARROW_CONCIERGE:return"Arrow Concierge";default:return e.type.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")}}ngOnChanges(){[this.otherUser]=this.otherMembers,this.supportAgent=this.getSupportAgent(this.currentUser,this.isUserSupportAgent,this.otherMembers,this.supportAgentMembers,this.agentSession),this.supportAgentUser=this.supportAgent?this.getSupportAgentUser(this.supportAgent,[this.currentUser,...this.otherMembers]):void 0,this.otherMembers&&this.otherMembers.length>0&&(this.isSupportChat=void 0!==this.supportAgent||"admin_preferred_chat"===this.thread.threadType,this.isGroupChat=this.thread.threadType===Ut.ThreadTypeApi.GROUP,this.isTeamChat=this.thread.threadType===Ut.ThreadTypeApi.TEAM||this.thread.threadType===Ut.ThreadTypeApi.TEAM_OFFICIAL||this.thread.context.type===Ut.ContextTypeApi.TEAM),this.isThreadSupportSession=this.thread.context&&this.thread.context.type===Ut.ContextTypeApi.SUPPORT_SESSION,this.isUnread=this.thread.messageUnreadCount>0,this.setTitles(),this.isFocused=this.focusState===Rt.a.Header||this.focusState===Rt.a.HeaderAndTypingBox,this.isArrowProject=this.project&&this.project.isArrowProject||!1}getSupportAgent(e,t,i,n,a){if(n)return t?n.find(t=>a?t.userId===e.id&&t.type===a.type:t.userId===e.id):!t&&i?n.find(e=>i.map(e=>e.id).includes(e.userId)):void 0}getSupportAgentUser(e,t){return t.find(t=>t.id===e.userId)}setTitles(){if(this.showLastSeen=!1,this.thread.threadType===Ut.ThreadTypeApi.GROUP||this.thread.threadType===Ut.ThreadTypeApi.TEAM){const e=this.otherMembers.map(e=>e.displayName).join(", ");this.project&&this.thread.context.type===Ut.ContextTypeApi.PROJECT?(this.title=this.project.title,this.titleLink=`/projects/${this.project.seoUrl}`,this.secondaryTitle=e):this.contest&&this.thread.context.type===Ut.ContextTypeApi.CONTEST?(this.title=this.contest.title,this.titleLink=this.contest.seoUrl,this.secondaryTitle=e):(this.title=e,this.titleLink=void 0,this.secondaryTitle=void 0)}else this.isSupportChat&&this.isUserSupportAgent&&this.supportAgent&&this.otherUser?(this.title=this.otherUser.displayName,this.titleLink=this.otherUser.profileUrl,this.secondaryTitle=this.otherUser.username===this.otherUser.displayName?e.getSupportQueueTitle(this.supportAgent):`(${this.otherUser.username})`):this.isSupportChat&&this.supportAgent&&this.supportAgentUser?(this.title=this.supportAgentUser.displayName,this.titleLink=this.otherUser?this.otherUser.profileUrl:void 0,this.secondaryTitle="Freelancer Staff"):this.team&&this.thread.threadType===Ut.ThreadTypeApi.TEAM_OFFICIAL?(this.title=this.team.name,this.titleLink=`/teams/${this.team.id}`,this.secondaryTitle="Official Group Chat"):this.otherUser?(this.title=this.otherUser.displayName,this.titleLink=this.otherUser.profileUrl,this.titleParams=this.project?{ref_project_id:this.project.id}:void 0,this.secondaryTitle=void 0,this.otherUser.onlineOfflineStatus&&void 0!==this.otherUser.onlineOfflineStatus.lastUpdatedTimestamp&&this.otherUser.onlineOfflineStatus.status===Nt.OnlineOfflineStatusApi.OFFLINE&&(this.lastSeenDate=new Date(this.otherUser.onlineOfflineStatus.lastUpdatedTimestamp),this.showLastSeen=!0)):(this.title="Private Chat",this.titleLink=void 0,this.secondaryTitle=void 0)}canManageChatMembers(){return!!(this.thread.context.type===Ut.ContextTypeApi.TEAM&&this.thread.threadType!==Ut.ThreadTypeApi.TEAM_OFFICIAL||this.thread.threadType===Ut.ThreadTypeApi.TEAM&&this.team)||this.thread.threadType!==Ut.ThreadTypeApi.TEAM_OFFICIAL&&(this.isThreadOwner&&!this.isSupportChat||this.isUserSupportAgent)}handleBlockedClick(e){e.stopPropagation()}handleClose(e){e.stopPropagation(),this.closeChat.emit()}handleSettingsButtonClick(e){e.stopPropagation(),this.handleSettingsHeaderClick.emit()}handleGroupchatButtonClick(e){e.stopPropagation(),this.handleGroupchatHeaderClick.emit()}handleAudioCallClick(e,t){e.stopPropagation(),this.startCall($t.a.AUDIO,t),this.makingCall.emit(!0)}handleVideoCallClick(e){e.stopPropagation(),this.startCall($t.a.VIDEO),this.makingCall.emit(!0)}startCall(e,t=!1){this.videochat.openCallWindow({action:e,threadId:this.thread.id,accepting:!1,recorded:t})}}return e.\u0275fac=function(t){return new(t||e)(p.Sb($t.b))},e.\u0275cmp=p.Mb({type:e,selectors:[["app-header"]],hostVars:16,hostBindings:function(e,t){2&e&&p.Kb("IsMinimised",t.isMinimised)("IsUserRecruiter",t.isUserSupportAgent)("IsFocused",t.isFocused)("IsUnread",t.isUnread)("IsRecruiter",t.isSupportChat)("IsThreadSupportSession",t.isThreadSupportSession)("has-secondaryTitle",t.secondaryTitle)("IsArrowProject",t.isArrowProject)},inputs:{thread:"thread",currentUserId:"currentUserId",otherMembers:"otherMembers",currentUser:"currentUser",project:"project",contest:"contest",agentSession:"agentSession",isThreadOwner:"isThreadOwner",candidatesExist:"candidatesExist",callsEnabled:"callsEnabled",onlineOfflineStatuses$:"onlineOfflineStatuses$",team:"team",focusState:"focusState",supportAgentMembers:"supportAgentMembers",isMinimised:"isMinimised",isUserSupportAgent:"isUserSupportAgent"},outputs:{closeChat:"closeChat",handleSettingsHeaderClick:"handleSettingsHeaderClick",handleGroupchatHeaderClick:"handleGroupchatHeaderClick",makingCall:"makingCall"},features:[p.Eb],decls:18,vars:22,consts:function(){let e,t,i,n;return e="Chatbox settings",t="Close chat",i="Invite more users to this chat",n="View the participants of this thread",[[1,"ChatHeader-details"],["class","ChatHeader-details-onlineStatus",3,"username","isOnline",4,"ngIf"],[1,"ChatHeader-details-text"],["class","ChatHeader-details-title","flTrackingLabel","headerLink",3,"color","weight","link","queryParams","hoverColor","click",4,"ngIf"],["class","ChatHeader-details-title",4,"ngIf"],["class","ChatHeader-details-secondaryTitle","data-uitest-target","chatbox-header-username",4,"ngIf"],["class","ChatHeader-details-secondaryTitle",3,"color","size","date","includeSeconds","strict",4,"ngIf"],[1,"ChatHeader-controls"],["class","ChatHeader-controls-btn",3,"position","message",4,"ngIf"],["flTrackingLabel","groupChat","class","ChatHeader-controls-btn",3,"click",4,"ngIf"],["flTrackingLabel","chatSettings","data-uitest-target","chatbox-settings",1,"ChatHeader-controls-btn",3,"click"],["label",e,3,"color","size","hoverColor","name"],["flTrackingLabel","closeChat","data-uitest-target","chatbox-close",1,"ChatHeader-controls-btn",3,"click"],["label",t,3,"color","size","hoverColor","name"],[1,"ChatHeader-details-onlineStatus",3,"username","isOnline"],["flTrackingLabel","headerLink",1,"ChatHeader-details-title",3,"color","weight","link","queryParams","hoverColor","click"],[1,"ChatHeader-details-title"],["data-uitest-target","chatbox-header-username",1,"ChatHeader-details-secondaryTitle"],[1,"ChatHeader-details-secondaryTitle",3,"color","size","date","includeSeconds","strict"],[1,"ChatHeader-controls-btn",3,"position","message"],["flTrackingLabel","audioCall",3,"click"],[3,"color","size","hoverColor","name"],["flTrackingLabel","videoCall",3,"click"],["flTrackingLabel","groupChat",1,"ChatHeader-controls-btn",3,"click"],["name","ui-invite-v2","label",i,3,"color","size","hoverColor",4,"ngIf"],["name","ui-invite-v2","label",n,3,"color","size","hoverColor",4,"ngIf"],["name","ui-invite-v2","label",i,3,"color","size","hoverColor"],["name","ui-invite-v2","label",n,3,"color","size","hoverColor"]]},template:function(e,t){1&e&&(p.Yb(0,"fl-bit",0),p.ad(1,Dt,3,7,"fl-online-indicator",1),p.Yb(2,"fl-bit",2),p.ad(3,Xt,2,7,"fl-link",3),p.ad(4,Yt,2,2,"fl-bit",4),p.ad(5,Ht,2,2,"fl-bit",4),p.ad(6,Vt,2,1,"fl-bit",5),p.ad(7,Qt,1,5,"fl-relative-time",6),p.sc(8,"isOnline"),p.sc(9,"flAsync"),p.Xb(),p.Xb(),p.Yb(10,"fl-bit",7),p.ad(11,Wt,3,7,"fl-tooltip",8),p.ad(12,qt,3,7,"fl-tooltip",8),p.ad(13,Jt,3,2,"fl-button",9),p.Yb(14,"fl-button",10),p.nc("click",function(e){return t.handleSettingsButtonClick(e)}),p.Tb(15,"fl-icon",11),p.Xb(),p.Yb(16,"fl-button",12),p.nc("click",function(e){return t.handleClose(e)}),p.Tb(17,"fl-icon",13),p.Xb(),p.Xb()),2&e&&(p.Gb(1),p.zc("ngIf",!t.isGroupChat&&!t.isTeamChat&&t.otherUser),p.Gb(2),p.zc("ngIf",!t.isMinimised&&void 0!==t.titleLink),p.Gb(1),p.zc("ngIf",!t.isMinimised&&void 0===t.titleLink),p.Gb(1),p.zc("ngIf",t.isMinimised),p.Gb(1),p.zc("ngIf",void 0!==t.secondaryTitle),p.Gb(1),p.zc("ngIf",t.showLastSeen&&t.otherUser&&(null==t.otherUser.onlineOfflineStatus?null:t.otherUser.onlineOfflineStatus.lastUpdatedTimestamp)&&!p.uc(8,17,t.otherUser,p.tc(9,20,t.onlineOfflineStatuses$))),p.Gb(4),p.zc("ngIf",!t.isMinimised&&(null==t.callsEnabled?null:t.callsEnabled.audio.enabled)),p.Gb(1),p.zc("ngIf",!t.isMinimised&&(null==t.callsEnabled?null:t.callsEnabled.audio.enabled)&&(null==t.callsEnabled?null:t.callsEnabled.video.enabled)),p.Gb(1),p.zc("ngIf",!t.isMinimised&&(t.isUserSupportAgent||t.isGroupChat||t.isTeamChat||t.isThreadOwner&&!t.isSupportChat)),p.Gb(2),p.zc("color",t.IconColor.LIGHT)("size",t.IconSize.SMALL)("hoverColor",t.HoverColor.PRIMARY)("name","ui-cog-v2"),p.Gb(2),p.zc("color",t.IconColor.LIGHT)("size",t.IconSize.SMALL)("hoverColor",t.HoverColor.PRIMARY)("name","ui-close"))},directives:[ke.a,n.q,fe.b,Ae.a,le.d,Ee.a,pe.b,Le.b,Bt.a],pipes:[Ft.a,je.a],styles:["@keyframes pulseUnfocus{10%{background-color:#dedede;opacity:1}50%{background-color:#1073cb;opacity:.5}to{background-color:#dedede;opacity:1}}@keyframes pulseFocus{0%{opacity:1}50%{opacity:.5}to{opacity:1}}[_nghost-%COMP%]{font-size:14px;line-height:1.43;align-items:center;background-color:#dedede;border-radius:0 0 0 0;color:#f7f7f7;cursor:pointer;display:flex;flex:0 0 auto;height:34px;padding:0 12px;width:100%}.IsFocused[_nghost-%COMP%]{background-color:#1073cb}.IsFocused.IsRecruiter[_nghost-%COMP%]{background-color:#7d30c9}.IsFocused.IsRecruiter.IsThreadSupportSession.IsUserRecruiter[_nghost-%COMP%]{background-color:#000}.IsFocused.IsRecruiter.IsThreadSupportSession.IsUserRecruiter.IsArrowProject[_nghost-%COMP%]{background-color:#eb3730}.IsRecruiter[_nghost-%COMP%]{background-color:rgba(125,48,201,.5)}.IsRecruiter.IsThreadSupportSession.IsUserRecruiter[_nghost-%COMP%]{background-color:rgba(0,0,0,.5)}.IsRecruiter.IsThreadSupportSession.IsUserRecruiter.IsArrowProject[_nghost-%COMP%]{background-color:rgba(235,55,48,.5)}.IsUnread[_nghost-%COMP%]{animation:pulseFocus 1.5s ease-in-out infinite;opacity:1}.IsUnread[_nghost-%COMP%]:not(.IsFocused):not(.IsRecruiter){animation:pulseUnfocus 1.5s ease-in-out infinite}.ChatHeader-details[_ngcontent-%COMP%]{align-items:center;display:flex;max-width:calc(100% - 72px);overflow:auto}.ChatHeader-details-text[_ngcontent-%COMP%]{align-items:flex-start;display:flex;flex-direction:column;overflow:hidden;width:100%}.ChatHeader-details-onlineStatus[_ngcontent-%COMP%]{margin-right:8px}.ChatHeader-details-title[_ngcontent-%COMP%]{color:#fff;font-weight:700;line-height:1.1}.ChatHeader-details-secondaryTitle[_ngcontent-%COMP%], .ChatHeader-details-title[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width:100%}.ChatHeader-details-secondaryTitle[_ngcontent-%COMP%]{font-size:13px;line-height:1.2;line-height:1.1}.ChatHeader-controls[_ngcontent-%COMP%]{align-items:center;display:flex;margin-left:auto}.ChatHeader-controls-btn[_ngcontent-%COMP%]{padding:4px 0 4px 4px}"],changeDetection:0}),e})();var ti=i("os2j"),ii=i("fYbj"),ni=i("Krui"),ai=function(e){return e[e.CHAT_MESSAGE=220]="CHAT_MESSAGE",e[e.ATTACHMENT_SIDEBAR=48]="ATTACHMENT_SIDEBAR",e}({}),si=function(e){return e[e.CHAT_MESSAGE=330]="CHAT_MESSAGE",e[e.ATTACHMENT_SIDEBAR=48]="ATTACHMENT_SIDEBAR",e}({});function oi(e,t,i){const n=`/api/messages/0.1/messages/${e}/${encodeURIComponent(t)}/thumbnail?height=${i.height}&width=${i.width}`;return i.method?`${n}&resizing_method=${i.method}`:n}var ri=i("DsW6"),ci=i("T2yU"),li=i("KrVf"),di=i("LE8X"),hi=i("KUXl");function gi(e,t){if(1&e){const e=p.Zb();p.Wb(0,2),p.Yb(1,"fl-button",3),p.nc("click",function(){return p.Qc(e),p.rc().openPreviewModal()}),p.Tb(2,"fl-picture",4),p.sc(3,"flAsync"),p.Xb(),p.Yb(4,"fl-link",5),p.nc("click",function(){return p.Qc(e),p.rc().openPreviewModal()}),p.cd(5),p.Xb(),p.Vb()}if(2&e){const e=p.rc();p.zc("flTrackingSection",e.trackingSection),p.Gb(1),p.zc("flMarginBottom",e.Margin.XXXSMALL),p.Gb(1),p.zc("src",e.useThumbnailService&&!e.isGifFile?e.imageThumbnailPath:p.tc(3,10,e.attachmentPathPromise))("externalSrc",!0)("boundedWidth",!0)("alt",e.attachment)("objectFit",e.PictureObjectFit.COVER),p.Gb(2),p.zc("color",e.fromMe?e.LinkColor.LIGHT:e.LinkColor.DEFAULT)("hoverColor",e.fromMe?e.LinkHoverColor.LIGHT:e.LinkHoverColor.DEFAULT),p.Gb(1),p.ed(" ",e.attachment," ")}}function ui(e,t){if(1&e){const e=p.Zb();p.Wb(0),p.Yb(1,"fl-button",6),p.nc("click",function(){return p.Qc(e),p.rc().openPreviewModal()}),p.Yb(2,"fl-bit",7),p.Tb(3,"fl-icon",8),p.Xb(),p.Yb(4,"fl-link",9),p.nc("click",function(){return p.Qc(e),p.rc().openPreviewModal()}),p.cd(5),p.Xb(),p.Xb(),p.Vb()}if(2&e){const e=p.rc();p.Gb(1),p.zc("display","block"),p.Gb(2),p.zc("color",e.IconColor.MID)("size",e.IconSize.SMALL)("hoverColor",e.HoverColor.PRIMARY)("name","ui-file"),p.Gb(1),p.zc("color",e.fromMe?e.LinkColor.LIGHT:e.LinkColor.DEFAULT)("hoverColor",e.fromMe?e.LinkHoverColor.LIGHT:e.LinkHoverColor.DEFAULT),p.Gb(1),p.ed(" ",e.attachment," ")}}let bi=(()=>{class e{constructor(e,t,i,n,a){this.modalService=e,this.tracking=t,this.fileDownload=i,this.fileStorage=n,this.userAgent=a,this.Margin=me.a,this.IconColor=le.c,this.IconSize=le.e,this.ImageAttachmentThumbnailHeight=ai,this.ImageAttachmentThumbnailWidth=si,this.HoverColor=le.a,this.LinkColor=pe.a,this.LinkHoverColor=pe.c,this.PictureObjectFit=ni.c,this.ModalSize=Ce.a,this.chatBoxMode=!0,this.useThumbnailService=!1,this.previewModalOpen=new p.n,this.previewModalClose=new p.n,this.isImage=!1}ngOnInit(){this.isImage=Object(ii.i)(this.attachment),this.trackingSection=this.chatBoxMode?"chatbox":"inbox",this.attachmentPathPromise=this.fileStorage.getDownloadURL(ti.a.MESSAGING_ATTACHMENTS,this.attachment,{messageId:this.messageId.toString()}).then(e=>"success"===e.status?e.downloadURL:void 0),this.imageThumbnailPath=oi(this.messageId,this.attachment,{height:ai.CHAT_MESSAGE,width:si.CHAT_MESSAGE,method:"fit"}),this.isGifFile="gif"===Object(ii.e)(this.attachment)}openPreviewModal(){return Object(x.a)(this,void 0,void 0,function*(){if(["IE","Edge"].includes(this.userAgent.getUserAgent().getBrowser().name||"")){const e=yield this.attachmentPathPromise;if(!e)return;return this.fileDownload.download(e,this.attachment)}const e=this.modalService.open("FileViewerModal",{inputs:{messageId:this.messageId,filename:this.attachment,filetype:Object(ii.f)(this.attachment)},edgeToEdge:!0,size:Ce.a.XLARGE});e.afterOpen().toPromise().then(e=>this.previewModalOpen.emit()),e.afterClosed().toPromise().then(e=>{this.previewModalClose.emit(),this.tracking.track("user_action",{section:"messaging_image_viewer",subsection:"header",label:"close_image_viewer"})})})}}return e.\u0275fac=function(t){return new(t||e)(p.Sb(Ie.b),p.Sb(ri.a),p.Sb(ci.a),p.Sb(li.a),p.Sb(di.a))},e.\u0275cmp=p.Mb({type:e,selectors:[["app-message-attachment"]],inputs:{attachment:"attachment",messageId:"messageId",fromMe:"fromMe",chatBoxMode:"chatBoxMode",useThumbnailService:"useThumbnailService"},outputs:{previewModalOpen:"previewModalOpen",previewModalClose:"previewModalClose"},decls:2,vars:2,consts:function(){let e;return e="Download the attachment",[["flTrackingSubSection","message_content",3,"flTrackingSection",4,"ngIf"],[4,"ngIf"],["flTrackingSubSection","message_content",3,"flTrackingSection"],["flTrackingLabel","open_image_viewer",1,"AttachmentContainer",3,"flMarginBottom","click"],["data-uitest-target","chatbox-image-thumbnail",1,"AttachmentImage",3,"src","externalSrc","boundedWidth","alt","objectFit"],["flTrackingLabel","open_image_viewer","data-uitest-target","chatbox-imagefile-link",1,"AttachmentFile-name",3,"color","hoverColor","click"],["flTrackingLabel","open_image_viewer",3,"display","click"],[1,"AttachmentFile"],["label",e,1,"AttachmentFile-icon",3,"color","size","hoverColor","name"],["flTrackingLabel","open_image_viewer","data-uitest-target","chatbox-file-link",1,"AttachmentFile-name",3,"color","hoverColor","click"]]},template:function(e,t){1&e&&(p.ad(0,gi,6,12,"ng-container",0),p.ad(1,ui,6,8,"ng-container",1)),2&e&&(p.zc("ngIf",t.isImage),p.Gb(1),p.zc("ngIf",!t.isImage))},directives:[n.q,hi.a,fe.b,Ae.a,me.b,ni.a,pe.b,ke.a,le.d],pipes:[je.a],styles:[".AttachmentContainer[_ngcontent-%COMP%], [_nghost-%COMP%]{display:block}@media (-ms-high-contrast:active),(-ms-high-contrast:none){.AttachmentContainer[_ngcontent-%COMP%]{display:flex}}.AttachmentFile[_ngcontent-%COMP%]{align-items:center;display:flex}.AttachmentFile-name[_ngcontent-%COMP%]{word-break:break-all}@media (-ms-high-contrast:active),(-ms-high-contrast:none){.AttachmentFile-name[_ngcontent-%COMP%]{flex-basis:100%}}.AttachmentFile-name--fromMe[_ngcontent-%COMP%]{color:#f7f7f7;flex:0 1 auto}.AttachmentFile-icon[_ngcontent-%COMP%]{margin-right:4px}.AttachmentImage[_ngcontent-%COMP%]{display:block;height:220px;width:100%}"]}),e})();var fi=i("71eJ"),pi=i("4kPF"),mi=i("AJ15"),Ci=i("zOIv"),Mi=i("jASZ"),Si=i("jtHE");function xi(e,t){if(1&e&&(p.Yb(0,"fl-bit",6),p.Tb(1,"fl-spinner",7),p.Xb()),2&e){const e=p.rc(2);p.Gb(1),p.zc("size",e.SpinnerSize.SMALL)("color",e.fromMe?e.SpinnerColor.LIGHT:e.SpinnerColor.PRIMARY)}}function yi(e,t){if(1&e&&p.Tb(0,"fl-icon",10),2&e){const e=p.rc(3);p.zc("color",e.IconColor.LIGHT)("name","ui-computer")}}function Ti(e,t){if(1&e&&p.Tb(0,"fl-icon",10),2&e){const e=p.rc(3);p.zc("color",e.IconColor.LIGHT)("name","ui-trophy")}}const Ii=function(e){return{"ImageContainer--inactive":e}};function Oi(e,t){if(1&e&&(p.Yb(0,"fl-bit",8),p.ad(1,yi,1,2,"fl-icon",9),p.ad(2,Ti,1,2,"fl-icon",9),p.Xb()),2&e){const e=p.rc().ngIf,t=p.rc();p.zc("ngClass",p.Ec(4,Ii,e.error))("flMarginRight",t.Margin.XXSMALL),p.Gb(1),p.zc("ngIf","share_project"===t.type&&e.ready),p.Gb(1),p.zc("ngIf","share_contest"===t.type&&e.ready)}}function vi(e,t){if(1&e&&(p.Yb(0,"fl-link",18),p.sc(1,"flAsync"),p.Yb(2,"fl-text",19),p.cd(3),p.sc(4,"flAsync"),p.Xb(),p.Xb()),2&e){const e=p.rc(3);let t=null;p.zc("link",p.tc(1,10,e.jobLink$))("color",e.fromMe?e.LinkColor.LIGHT:e.LinkColor.INHERIT)("hoverColor",e.fromMe?e.LinkHoverColor.LIGHT:e.LinkHoverColor.INHERIT)("weight",e.LinkWeight.BOLD)("flMarginBottom",e.Margin.XXSMALL)("newTab",!0),p.Gb(2),p.zc("maxLines",2)("color",e.FontColor.INHERIT)("size",e.TextSize.INHERIT),p.Gb(1),p.ed(" ",null==(t=p.tc(4,12,e.job$))?null:t.title," ")}}function Ai(e,t){if(1&e&&(p.Yb(0,"fl-text",20),p.cc(1,21),p.Xb()),2&e){const e=p.rc(3);p.zc("color",e.FontColor.DARK)("weight",e.FontWeight.BOLD)("maxLines",2)("flMarginBottom",e.Margin.XXSMALL)}}function wi(e,t){if(1&e&&p.Tb(0,"fl-icon",22),2&e){const e=p.rc(3);p.zc("color",e.fromMe?e.IconColor.LIGHT:e.IconColor.MID)("name","ui-clock-alt-v2")("size",e.IconSize.SMALL)("flMarginRight",e.Margin.XXSMALL)}}function ki(e,t){if(1&e&&(p.Yb(0,"fl-text",23),p.cd(1),p.sc(2,"date"),p.sc(3,"flAsync"),p.Xb()),2&e){const e=p.rc(3);let t=null;p.zc("color",e.fromMe?e.FontColor.LIGHT:e.FontColor.MID)("maxLines",2),p.Gb(1),p.ed(" ",p.uc(2,3,null==(t=p.tc(3,6,e.job$))?null:t.timeSubmitted,"LLL dd, yyyy")," ")}}function zi(e,t){if(1&e&&(p.Yb(0,"fl-text",24),p.cc(1,25),p.Xb()),2&e){const e=p.rc(3);p.zc("color",e.FontColor.MID)}}function Ei(e,t){if(1&e&&(p.Yb(0,"fl-bit",11),p.ad(1,vi,5,14,"fl-link",12),p.ad(2,Ai,2,4,"fl-text",13),p.Yb(3,"fl-bit",14),p.ad(4,wi,1,4,"fl-icon",15),p.ad(5,ki,4,8,"fl-text",16),p.ad(6,zi,2,1,"fl-text",17),p.Xb(),p.Xb()),2&e){const e=p.rc().ngIf;p.Gb(1),p.zc("ngIf",e.ready),p.Gb(1),p.zc("ngIf",e.error),p.Gb(2),p.zc("ngIf",e.ready),p.Gb(1),p.zc("ngIf",e.ready),p.Gb(1),p.zc("ngIf",e.error)}}const Li=function(e){return{"CardContainer--fromOther":e}},_i=function(e,t,i,n){return{"MainContainer--fromMe":e,"MainContainer--fromOther":t,"MainContainer--inactive":i,"MainContainer--loaded":n}};function ji(e,t){if(1&e&&(p.Wb(0),p.Yb(1,"fl-card",1),p.Yb(2,"fl-bit",2),p.ad(3,xi,2,2,"fl-bit",3),p.ad(4,Oi,3,6,"fl-bit",4),p.ad(5,Ei,7,5,"fl-bit",5),p.Xb(),p.Xb(),p.Vb()),2&e){const e=t.ngIf,i=p.rc();p.Gb(1),p.zc("borderRadius",i.CardBorderRadius.LARGE)("ngClass",p.Ec(9,Li,!i.fromMe))("size",i.CardSize.SMALL)("maxContent",!1)("edgeToEdge",!0),p.Gb(1),p.zc("ngClass",p.Hc(11,_i,i.fromMe,!i.fromMe,e.error,e.ready||e.error)),p.Gb(1),p.zc("ngIf",!e.ready&&!e.error),p.Gb(1),p.zc("ngIf",e.ready||e.error),p.Gb(1),p.zc("ngIf",e.ready||e.error)}}let Pi=(()=>{class e{constructor(e){this.datastore=e,this.CardBorderRadius=Ci.a,this.CardSize=Ci.g,this.FontColor=Me.a,this.FontWeight=de.c,this.IconSize=le.e,this.IconColor=le.c,this.LinkColor=pe.a,this.LinkHoverColor=pe.c,this.LinkWeight=pe.f,this.TextSize=de.f,this.Margin=me.a,this.SpinnerColor=Mi.b,this.SpinnerSize=Mi.d,this.jobId$=new Si.a(1)}ngOnInit(){if("share_project"===this.type){const e=this.datastore.document("threadProjects",this.jobId$),t=e.valueChanges();this.job$=t,this.status$=e.status$}else{const e=this.datastore.document("contests",this.jobId$),t=e.valueChanges();this.job$=t,this.status$=e.status$}this.jobLink$=this.job$.pipe(Object(I.a)(e=>"share_project"===this.type?`/projects/${e.seoUrl}`:`/${e.seoUrl}`))}ngOnChanges(e){"jobId"in e&&this.jobId$.next(e.jobId.currentValue)}}return e.\u0275fac=function(t){return new(t||e)(p.Sb(Oe.a))},e.\u0275cmp=p.Mb({type:e,selectors:[["app-share-job"]],hostVars:2,hostBindings:function(e,t){2&e&&p.Kb("FromMe",t.fromMe)},inputs:{jobId:"jobId",type:"type",fromMe:"fromMe"},features:[p.Eb],decls:2,vars:3,consts:function(){let e,t;return e=" Unavailable job ",t=" This job is no longer available to view. ",[[4,"ngIf"],[1,"CardContainer",3,"borderRadius","ngClass","size","maxContent","edgeToEdge"],[1,"MainContainer",3,"ngClass"],["class","LoadingContainer",4,"ngIf"],["class","ImageContainer",3,"ngClass","flMarginRight",4,"ngIf"],["class","DescriptionContainer",4,"ngIf"],[1,"LoadingContainer"],["flTrackingLabel","ShareJobRichMessageInitialisationSpinner",3,"size","color"],[1,"ImageContainer",3,"ngClass","flMarginRight"],[3,"color","name",4,"ngIf"],[3,"color","name"],[1,"DescriptionContainer"],["class","ShareJobTitle","flTrackingLabel","ShareJobRichMessage",3,"link","color","hoverColor","weight","flMarginBottom","newTab",4,"ngIf"],[3,"color","weight","maxLines","flMarginBottom",4,"ngIf"],[1,"BottomContainer"],[3,"color","name","size","flMarginRight",4,"ngIf"],[3,"color","maxLines",4,"ngIf"],[3,"color",4,"ngIf"],["flTrackingLabel","ShareJobRichMessage",1,"ShareJobTitle",3,"link","color","hoverColor","weight","flMarginBottom","newTab"],[3,"maxLines","color","size"],[3,"color","weight","maxLines","flMarginBottom"],e,[3,"color","name","size","flMarginRight"],[3,"color","maxLines"],[3,"color"],t]},template:function(e,t){1&e&&(p.ad(0,ji,6,16,"ng-container",0),p.sc(1,"flAsync")),2&e&&p.zc("ngIf",p.tc(1,1,t.status$))},directives:[n.q,Ci.b,n.o,ke.a,Mi.c,_e.a,Ae.a,me.b,le.d,pe.b,de.e],pipes:[je.a,n.f],styles:["[_nghost-%COMP%]{display:flex;min-width:215px;padding:8px 0}.FromMe[_nghost-%COMP%]{justify-content:flex-end}.MainContainer[_ngcontent-%COMP%]{border-radius:0;display:flex;padding:8px}.MainContainer--loaded[_ngcontent-%COMP%]{padding-right:16px}.MainContainer--fromMe[_ngcontent-%COMP%]{background-color:#007fed}.MainContainer--fromOther[_ngcontent-%COMP%], .MainContainer--inactive[_ngcontent-%COMP%]{background-color:#f0f0f0}.ImageContainer[_ngcontent-%COMP%]{align-items:center;background-color:#2259b5;border-radius:0;display:flex;height:50px;justify-content:center;min-width:50px;width:50px}.ImageContainer--inactive[_ngcontent-%COMP%]{background-color:#bec0c2}.BottomContainer[_ngcontent-%COMP%]{align-items:center;display:flex;justify-content:flex-start}.CardContainer[_ngcontent-%COMP%]{display:flex;max-width:80%}.CardContainer--fromOther[_ngcontent-%COMP%]{margin-left:36px}.LoadingContainer[_ngcontent-%COMP%]{align-items:center;display:flex;height:54px;justify-content:center;width:56px}.DescriptionContainer[_ngcontent-%COMP%]{width:100%}.ShareJobTitle[_ngcontent-%COMP%]{display:inline-block}"],changeDetection:0}),e})();function Ri(e,t){if(1&e&&(p.Yb(0,"fl-picture",6),p.ec(1,7),p.Xb()),2&e){const e=p.rc(2);p.gc(e.user.displayName),p.dc(1),p.zc("src",e.user.avatar)("externalSrc",!0)("boundedWidth",!0)}}function Bi(e,t){if(1&e&&(p.Yb(0,"fl-bit",8),p.cd(1),p.Xb()),2&e){const e=p.rc(2);p.Gb(1),p.ed(" ",e.user.displayName[0].toUpperCase()," ")}}function $i(e,t){if(1&e&&(p.Yb(0,"fl-bit",2),p.sc(1,"date"),p.ec(2,3),p.ad(3,Ri,2,4,"fl-picture",4),p.ad(4,Bi,2,1,"fl-bit",5),p.Xb()),2&e){const e=p.rc();p.gc(e.user.displayName)(p.uc(1,4,e.time,"h:mma d MMMM y")),p.dc(2),p.Gb(3),p.zc("ngIf",e.user.avatar),p.Gb(1),p.zc("ngIf",!e.user.avatar)}}function Ui(e,t){1&e&&p.Tb(0,"fl-icon",9)}let Gi=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=p.Mb({type:e,selectors:[["app-read-marker"]],inputs:{user:"user",time:"time",isTyping:"isTyping"},decls:2,vars:2,consts:function(){let e,t;return e="Seen by " + "\ufffd0\ufffd" + " at " + "\ufffd1\ufffd" + "",t="Seen by " + "\ufffd0\ufffd" + "",[["class","ReadMarkerContainer",3,"title",4,"ngIf"],["name","typing-icon",4,"ngIf"],[1,"ReadMarkerContainer",6,"title"],["title",e],["class","ReadMarker",3,"src","externalSrc","boundedWidth","alt",4,"ngIf"],["class","ReadMarkerText",4,"ngIf"],[1,"ReadMarker",3,"src","externalSrc","boundedWidth",6,"alt"],["alt",t],[1,"ReadMarkerText"],["name","typing-icon"]]},template:function(e,t){1&e&&(p.ad(0,$i,5,7,"fl-bit",0),p.ad(1,Ui,1,0,"fl-icon",1)),2&e&&(p.zc("ngIf",t.user),p.Gb(1),p.zc("ngIf",t.isTyping))},directives:[n.q,ke.a,ni.a,le.d],pipes:[n.f],styles:["[_nghost-%COMP%]{display:flex}.ReadMarker[_ngcontent-%COMP%], .ReadMarkerText[_ngcontent-%COMP%]{height:16px;width:16px}.ReadMarkerText[_ngcontent-%COMP%]{align-items:center;color:#139ff0;display:flex;justify-content:center;overflow:hidden}.ReadMarkerContainer[_ngcontent-%COMP%]{margin:0;padding-left:4px}"],changeDetection:0}),e})();function Ni(e,t){if(1&e&&(p.Yb(0,"fl-bit",7),p.cd(1),p.sc(2,"uppercase"),p.sc(3,"date"),p.Xb()),2&e){const e=p.rc(2);p.Gb(1),p.dd(p.tc(2,1,p.uc(3,3,e.message.timeCreated,"dd MMM yyyy \xb7 h:mm a")||""))}}function Fi(e,t){if(1&e&&(p.Yb(0,"fl-bit",8),p.cd(1),p.Xb()),2&e){const e=p.rc(2);p.Gb(1),p.ed(" ",null==e.author?null:e.author.displayName," ")}}const Di=function(e){return[e]};function Xi(e,t){if(1&e&&p.Tb(0,"fl-user-avatar",17),2&e){const e=p.rc(3);p.zc("users",p.Ec(4,Di,e.author))("size",e.AvatarSize.SMALL)("flMarginRight",e.Margin.XXXSMALL),p.Hb("title",null==e.author?null:e.author.displayName)}}function Yi(e,t){if(1&e){const e=p.Zb();p.Yb(0,"fl-button",20),p.nc("click",function(t){return p.Qc(e),p.rc(4).handleResend(t)}),p.Tb(1,"fl-icon",21),p.Xb()}if(2&e){const e=p.rc(4);p.zc("flMarginRight",e.Margin.XXXSMALL),p.Gb(1),p.zc("color",e.IconColor.DARK)("size",e.IconSize.SMALL)("hoverColor",e.HoverColor.PRIMARY)}}function Hi(e,t){if(1&e&&(p.Yb(0,"fl-bit",18),p.ad(1,Yi,2,4,"fl-button",19),p.Xb()),2&e){const e=p.rc(3);p.Gb(1),p.zc("ngIf",e.failed)}}function Vi(e,t){if(1&e){const e=p.Zb();p.Yb(0,"app-message-attachment",22),p.nc("click",function(e){return e.stopPropagation()})("previewModalClose",function(){return p.Qc(e),p.rc(3).previewModalClose.emit()})("previewModalOpen",function(){return p.Qc(e),p.rc(3).previewModalOpen.emit()}),p.Xb()}if(2&e){const e=t.$implicit,i=p.rc(3);p.zc("attachment",e)("messageId",i.message.id)("fromMe",i.fromMe)("chatBoxMode",i.chatBoxMode)("useThumbnailService",i.useThumbnailService)}}const Qi=function(e){return{"Message--hasName":e}},Wi=function(e){return{"AvatarContainer--other":e}},qi=function(e,t,i,n,a,s,o,r){return{"MessageBody--failed":e,"MessageBody--unsent":t,"MessageBody--mine":i,"MessageBody--other":n,"MessageBody--first":a,"MessageBody--mid":s,"MessageBody--last":o,"MessageBody--solo":r}};function Ki(e,t){if(1&e&&(p.Yb(0,"fl-bit",9),p.Yb(1,"fl-bit",10),p.ad(2,Xi,1,6,"fl-user-avatar",11),p.Xb(),p.ad(3,Hi,2,1,"fl-bit",12),p.Yb(4,"fl-bit",13),p.Yb(5,"fl-tooltip",14),p.sc(6,"date"),p.Tb(7,"fl-interactive-text",15),p.ad(8,Vi,1,5,"app-message-attachment",16),p.Xb(),p.Xb(),p.Xb()),2&e){const e=p.rc(2);p.zc("ngClass",p.Ec(16,Qi,e.isFirst&&!e.fromMe&&(null==e.otherMembers?null:e.otherMembers.length)>1)),p.Gb(1),p.zc("ngClass",p.Ec(18,Wi,!e.fromMe)),p.Gb(1),p.zc("ngIf",void 0!==e.author&&e.hasUserImg),p.Gb(1),p.zc("ngIf",e.fromMe),p.Gb(1),p.zc("ngClass",p.Lc(20,qi,e.fromMe&&e.failed,e.fromMe&&e.sending,e.fromMe,!e.fromMe,e.isFirst,!e.isFirst&&!e.isLast,e.isLast,e.isFirst&&e.isLast)),p.Gb(1),p.zc("message",p.uc(6,13,e.message.timeCreated,"dd MMM yyyy \xb7 h:mm a")),p.Gb(2),p.zc("content",e.message.message)("emoji",!0)("link",!0)("fontColor",e.fromMe?e.FontColor.LIGHT:e.FontColor.DARK)("highlightColor",e.HighlightColor.BLUE)("linkColor",e.fromMe?e.LinkColor.LIGHT:e.LinkColor.DEFAULT),p.Gb(1),p.zc("ngForOf",e.message.attachments)}}function Zi(e,t){1&e&&(p.Yb(0,"fl-bit",23),p.cc(1,24),p.Xb())}function Ji(e,t){if(1&e&&p.Tb(0,"app-rich-message",25),2&e){const e=p.rc(2);p.zc("richMessage",e.message.richMessage)("messageId",e.message.id)("currentUserId",e.currentUserId)}}function en(e,t){if(1&e&&p.Tb(0,"app-share-job",27),2&e){const e=p.rc().$implicit,t=p.rc(2);p.zc("jobId","share_project"===e.type?e.metadata.project_id:e.metadata.contest_id)("type",e.type)("fromMe",t.richMessageFromMe)}}function tn(e,t){if(1&e&&(p.Wb(0),p.ad(1,en,1,3,"app-share-job",26),p.Vb()),2&e){const e=t.$implicit;p.Gb(1),p.zc("ngIf","share_project"===e.type||"share_contest"===e.type)}}function nn(e,t){if(1&e&&(p.Tb(0,"app-read-marker",30),p.sc(1,"flAsync")),2&e){const e=t.$implicit,i=p.rc(3);p.zc("user",e.user)("time",e.time)("isTyping",p.tc(1,3,i.usersTyping[e.user.id]))}}function an(e,t){if(1&e&&(p.Yb(0,"fl-bit",28),p.ad(1,nn,2,5,"app-read-marker",29),p.Xb()),2&e){const e=p.rc(2);p.Gb(1),p.zc("ngForOf",e.readMarkers)("ngForTrackBy",e.identifyReadMarker)}}function sn(e,t){if(1&e&&(p.Wb(0),p.ad(1,Ni,4,6,"fl-bit",1),p.ad(2,Fi,2,1,"fl-bit",2),p.ad(3,Ki,9,29,"fl-bit",3),p.ad(4,Zi,2,0,"fl-bit",4),p.ad(5,Ji,1,3,"app-rich-message",5),p.ad(6,tn,2,1,"ng-container",0),p.ad(7,an,2,2,"fl-bit",6),p.Vb()),2&e){const e=p.rc();p.Gb(1),p.zc("ngIf",e.isTimestamp),p.Gb(1),p.zc("ngIf",e.isFirst&&!e.fromMe&&(null==e.otherMembers?null:e.otherMembers.length)>1),p.Gb(1),p.zc("ngIf",!e.message.richMessage),p.Gb(1),p.zc("ngIf",e.isLastFailed),p.Gb(1),p.zc("ngIf",e.message.richMessage&&!e.getSupportedRichMessageType(e.message.richMessage)),p.Gb(1),p.zc("ngIf",e.message.richMessage&&e.getSupportedRichMessageType(e.message.richMessage)),p.Gb(1),p.zc("ngIf",e.readMarkers.length>0)}}let on=(()=>{class e{constructor(){this.AvatarSize=fi.a,this.FontColor=Me.a,this.HighlightColor=Me.b,this.HoverColor=le.a,this.IconColor=le.c,this.IconSize=le.e,this.LinkColor=pe.a,this.Margin=me.a,this.TooltipPosition=Bt.b,this.chatBoxMode=!0,this.useThumbnailService=!1,this.previewModalClose=new p.n,this.previewModalOpen=new p.n,this.resendMessage=new p.n,this.isRichMessage=!1,this.readMarkers=[],this.supportedRichMessageType=["share_project","share_contest"],this.author=void 0,this.options=["Resend","Resend All","Remove"]}ngOnInit(){this.message.richMessage&&(this.isRichMessage=void 0!==this.message.richMessage),this.updateMessageAttributes()}ngOnChanges(){this.updateMessageAttributes()}getAuthor(){return this.threadMembers?this.threadMembers.find(e=>e.id===this.message.fromUser):void 0}differentAuthor(e){return this.message.fromUser!==e.fromUser}shouldShowTimestamp(e,t){return e.timeCreated-t.timeCreated>144e5}updateMessageAttributes(){this.fromMe=this.message.fromUser===Number(this.currentUserId),this.richMessageFromMe=Object(g.g)(this.message.richMessage)&&Object(g.g)(this.message.richMessage.fromUser)&&this.message.richMessage.fromUser===Object(g.r)(this.currentUserId),this.isTimestamp=!this.before||this.shouldShowTimestamp(this.message,this.before),this.isFirst=!this.before||this.differentAuthor(this.before)||this.isTimestamp,this.isLast=!this.after||this.differentAuthor(this.after)||this.shouldShowTimestamp(this.after,this.message),this.hasUserImg=!this.fromMe&&this.isLast,this.sent=void 0!==this.message.messageId,this.sent=this.message.sendStatus===z.a.SENT,this.sending=this.message.sendStatus===z.a.SENDING,this.failed=this.fromMe&&this.message.sendStatus===z.a.FAILED,this.isLastFailed=this.failed&&(!this.after||this.after.sendStatus!==z.a.FAILED),this.shouldRender=!(this.message.richMessage&&0===this.message.richMessage.long.length&&0===this.message.richMessage.short.length),this.otherMembers&&this.userReadTimes&&(this.readMarkers=this.otherMembers.filter(e=>{const t=this.userReadTimes[e.id];return t>=this.message.timeCreated&&(!this.after||t<this.after.timeCreated)}).map(e=>({time:this.userReadTimes[e.id],user:e}))),this.author=this.getAuthor()}handleResend(e){e.stopPropagation(),this.resendMessage.emit(this.message)}identifyReadMarker(e,t){return`${t.user.id}${t.time}`}getSupportedRichMessageType(e){if(e.types)return e.types.find(e=>this.supportedRichMessageType.includes(e.type))}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=p.Mb({type:e,selectors:[["app-message-item"]],hostVars:2,hostBindings:function(e,t){2&e&&p.Kb("IsRichMessage",t.isRichMessage)},inputs:{otherMembers:"otherMembers",threadMembers:"threadMembers",userReadTimes:"userReadTimes",message:"message",after:"after",before:"before",currentUserId:"currentUserId",chatBoxMode:"chatBoxMode",usersTyping:"usersTyping",useThumbnailService:"useThumbnailService"},outputs:{previewModalClose:"previewModalClose",previewModalOpen:"previewModalOpen",resendMessage:"resendMessage"},features:[p.Eb],decls:1,vars:1,consts:function(){let e,t;return e="Retry",t=" Message not delivered. ",[[4,"ngIf"],["class","Timestamp",4,"ngIf"],["class","Username",4,"ngIf"],["class","Message","data-uitest-target","chat-messages",3,"ngClass",4,"ngIf"],["class","FailedMessage",4,"ngIf"],[3,"richMessage","messageId","currentUserId",4,"ngIf"],["class","ReadMarkersContainer",4,"ngIf"],[1,"Timestamp"],[1,"Username"],["data-uitest-target","chat-messages",1,"Message",3,"ngClass"],[1,"AvatarContainer",3,"ngClass"],[3,"users","size","flMarginRight",4,"ngIf"],["class","ResendButtonContainer",4,"ngIf"],[1,"MessageBody",3,"ngClass"],[1,"MessageContainer",3,"message"],["data-uitest-target","chatbox-thread-message",1,"MessageText",3,"content","emoji","link","fontColor","highlightColor","linkColor"],["class","MessageAttachmentContainer",3,"attachment","messageId","fromMe","chatBoxMode","useThumbnailService","click","previewModalClose","previewModalOpen",4,"ngFor","ngForOf"],[3,"users","size","flMarginRight"],[1,"ResendButtonContainer"],["class","ResendButton","flTrackingLabel","resendButton",3,"flMarginRight","click",4,"ngIf"],["flTrackingLabel","resendButton",1,"ResendButton",3,"flMarginRight","click"],["name","ui-refresh","label",e,3,"color","size","hoverColor"],[1,"MessageAttachmentContainer",3,"attachment","messageId","fromMe","chatBoxMode","useThumbnailService","click","previewModalClose","previewModalOpen"],[1,"FailedMessage"],t,[3,"richMessage","messageId","currentUserId"],[3,"jobId","type","fromMe",4,"ngIf"],[3,"jobId","type","fromMe"],[1,"ReadMarkersContainer"],[3,"user","time","isTyping",4,"ngFor","ngForOf","ngForTrackBy"],[3,"user","time","isTyping"]]},template:function(e,t){1&e&&p.ad(0,sn,8,7,"ng-container",0),2&e&&p.zc("ngIf",t.shouldRender)},directives:[n.q,ke.a,n.o,Bt.a,pi.a,n.p,fi.b,me.b,fe.b,Ae.a,le.d,bi,mi.a,Pi,Gi],pipes:[n.B,n.f,je.a],styles:["[_nghost-%COMP%]{background:#fff;display:flex;flex:0 0 auto;flex-direction:column}.IsRichMessage[_nghost-%COMP%]{background:none}[_nghost-%COMP%]:last-child{margin-bottom:8px}.ReadMarkersContainer[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;padding-top:16px;width:100%}.Timestamp[_ngcontent-%COMP%]{font-size:11px;line-height:1.45;color:#4d525b;margin-bottom:4px;margin-top:20px;text-align:center}.AvatarContainer[_ngcontent-%COMP%]{height:32px;width:32px}@media (-ms-high-contrast:active),(-ms-high-contrast:none){.AvatarContainer--other[_ngcontent-%COMP%]{flex:0 0 32px}}.Message[_ngcontent-%COMP%]{align-items:flex-end;display:flex;justify-content:flex-start;margin-top:4px}.Message[_ngcontent-%COMP%]:hover   .ResendButton[_ngcontent-%COMP%]{display:inline-block}.Message--hasName[_ngcontent-%COMP%]{margin-top:0}.MessageBody[_ngcontent-%COMP%]{font-size:13px;line-height:1.2;word-break:break-word;word-wrap:break-word;max-width:75%;padding:8px}@media (-ms-high-contrast:active),(-ms-high-contrast:none){.MessageBody[_ngcontent-%COMP%]{-ms-word-break:break-all}}@supports (-ms-accelerator:true){.MessageBody[_ngcontent-%COMP%]{word-break:break-all}}@supports (-ms-ime-align:auto){.MessageBody[_ngcontent-%COMP%]{word-break:break-all}}.MessageBody--mine[_ngcontent-%COMP%]{background-color:#007fed}.MessageBody--failed[_ngcontent-%COMP%], .MessageBody--unsent[_ngcontent-%COMP%]{background-color:#dedede}.MessageBody--other[_ngcontent-%COMP%]{background-color:#f0f0f0;margin-left:4px}.MessageBody--first.MessageBody--mine[_ngcontent-%COMP%]{border-radius:8px 8px 0}.MessageBody--first.MessageBody--other[_ngcontent-%COMP%]{border-radius:8px 8px 8px 0}.MessageBody--mid.MessageBody--mine[_ngcontent-%COMP%]{border-radius:8px 0 0 8px}.MessageBody--mid.MessageBody--other[_ngcontent-%COMP%]{border-radius:0 8px 8px 0}.MessageBody--last.MessageBody--mine[_ngcontent-%COMP%]{border-radius:8px 0 8px 8px}.MessageBody--last.MessageBody--other[_ngcontent-%COMP%]{border-radius:0 8px 8px 8px}.MessageBody--solo.MessageBody[_ngcontent-%COMP%]{border-radius:8px}.MessageContainer[_ngcontent-%COMP%]{align-items:flex-start;display:flex;flex-direction:column;flex-wrap:wrap}@media (-ms-high-contrast:active),(-ms-high-contrast:none){.MessageContainer[_ngcontent-%COMP%]{display:block}}.MessageText[_ngcontent-%COMP%]{min-width:1px;-webkit-user-select:auto;-ms-user-select:auto;user-select:auto}.FailedMessage[_ngcontent-%COMP%]{font-size:11px;line-height:1.45;color:#ff624d;text-align:right}.ResendButtonContainer[_ngcontent-%COMP%]{align-self:center;display:flex;margin-left:auto;position:relative}.ResendButtonContainer[_ngcontent-%COMP%]   .ResendButton[_ngcontent-%COMP%]{display:none}.ResendButtonContainer[_ngcontent-%COMP%]   .Menu[_ngcontent-%COMP%]{bottom:16px;position:absolute;width:auto}.Username[_ngcontent-%COMP%]{font-size:11px;line-height:1.45;color:#4d525b;margin-left:40px;margin-top:4px}@media (-ms-high-contrast:active),(-ms-high-contrast:none){.MessageAttachmentContainer[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}}"],changeDetection:0}),e})();var rn=i("M5XV"),cn=i("v01h");const ln=["scrollableContent"];function dn(e,t){1&e&&p.Tb(0,"fl-spinner",11),2&e&&p.zc("overlay",!0)}function hn(e,t){if(1&e){const e=p.Zb();p.Yb(0,"fl-link",12),p.nc("click",function(){return p.Qc(e),p.rc().handleLoadMessages()}),p.cc(1,13),p.Xb()}}function gn(e,t){if(1&e&&p.Tb(0,"fl-spinner",14),2&e){const e=p.rc();p.zc("size",e.SpinnerSize.SMALL)}}const un=function(e,t){return{"MessageList-content-wrapper":e,"MessageList-content-chatbox-wrapper":t}};function bn(e,t){if(1&e){const e=p.Zb();p.Yb(0,"app-message-item",16),p.nc("previewModalClose",function(){return p.Qc(e),p.rc(2).previewModalClose.emit()})("previewModalOpen",function(){return p.Qc(e),p.rc(2).previewModalOpen.emit()})("resendMessage",function(t){return p.Qc(e),p.rc(2).handleMessageResend(t)}),p.Xb()}if(2&e){const e=p.rc(),t=e.index,i=e.$implicit,n=p.rc();p.zc("ngClass",p.Fc(11,un,!n.chatBoxMode,n.chatBoxMode))("after",n.messages[t+1])("before",n.messages[t-1])("currentUserId",n.currentUserId)("usersTyping",n.usersTyping)("message",i)("otherMembers",n.otherMembers)("threadMembers",n.members)("userReadTimes",n.thread.userReadTimes)("chatBoxMode",n.chatBoxMode)("useThumbnailService",n.useThumbnailService)}}function fn(e,t){if(1&e&&(p.Wb(0),p.ad(1,bn,1,14,"app-message-item",15),p.Vb()),2&e){const e=t.$implicit;p.Gb(1),p.zc("ngIf",e.message&&e.message.length>0||e.attachments&&e.attachments.length>0||e.richMessage)}}function pn(e,t){if(1&e){const e=p.Zb();p.Yb(0,"fl-floating-action",17),p.nc("click",function(){return p.Qc(e),p.rc().handleShowNewMessages()}),p.Xb()}2&e&&p.zc("icon","ui-arrow-down")}const mn=function(e,t){return{"MessageList-content-wrapper":e,"MessageList-placeholder":t}};function Cn(e,t){if(1&e&&(p.Yb(0,"fl-bit",18),p.Yb(1,"fl-text",19),p.cc(2,20),p.Xb(),p.Xb()),2&e){const e=p.rc();p.zc("ngClass",p.Fc(4,mn,!e.chatBoxMode,e.chatBoxMode)),p.Gb(1),p.zc("textAlign",e.TextAlign.CENTER)("flMarginBottom",e.Margin.SMALL)("color",e.FontColor.MID)}}let Mn=(()=>{class e{constructor(e){this.clipboard=e,this.FontColor=Me.a,this.Margin=me.a,this.SpinnerSize=Mi.d,this.TextAlign=de.d,this.chatBoxMode=!0,this.showLoadingMoreSpinner=!1,this.useThumbnailService=!1,this.previewModalClose=new p.n,this.previewModalOpen=new p.n,this.resendMessage=new p.n,this.loadMoreMessages=new p.n,this.showLoadingSpinner=!0,this.showNewMessageFloatingAction=!1}ngAfterViewInit(){this.scrollToBottom()}ngOnChanges(e){if(e.messages&&(!e.messages.previousValue||this.isAtBottom()||this.isMessageSent(e.messages.currentValue,e.messages.previousValue))&&setTimeout(()=>this.scrollToBottom(),0),e.messages&&this.isMessageReceived(e.messages.currentValue,e.messages.previousValue)&&!this.isAtBottom()&&(this.showNewMessageFloatingAction=!0),e.thread||e.messages){const e=this.messages&&this.messages.length>0?this.messages[0].threadId:void 0;this.showLoadingSpinner=!this.thread||!this.thread.isFake&&!this.messages||!this.thread.isFake&&!!e&&this.thread.id!==e}}ignoreSelection(e){const t=this.clipboard.getSelectedText();t&&t.rangeCount&&!t.getRangeAt(0).collapsed&&e.stopPropagation()}handleMessageResend(e){this.resendMessage.emit(e)}handleShowNewMessages(){this.scrollToBottom()}isMessageReceived(e,t){const i=e?e[e.length-1]:void 0,n=t?t[t.length-1]:void 0;return!!i&&i.fromUser!==Object(g.r)(this.currentUserId)&&!Object(ye.e)(i,n)}isMessageSent(e,t){const i=e[e.length-1],n=t[t.length-1];return i&&i.fromUser?!Object(ye.e)(i,n)&&i.fromUser===Object(g.r)(this.currentUserId):!Object(ye.e)(i,n)}scrollToBottom(){this.scrollableContent.scrollToBottom(),this.showNewMessageFloatingAction=!1}isAtBottom(){return!this.messageComponents||0===this.messageComponents.length||this.scrollableContent.isAtBottom(this.messageComponents.last.nativeElement.clientHeight)}handleScrollAtBottom(){this.showNewMessageFloatingAction=!1}identifyMessage(e,t){return t.id||t.clientMessageId}handleLoadMessages(){this.loadMoreMessages.emit(!0)}}return e.\u0275fac=function(t){return new(t||e)(p.Sb(rn.a))},e.\u0275cmp=p.Mb({type:e,selectors:[["app-message-list"]],viewQuery:function(e,t){if(1&e&&(p.jd(ln,1),p.jd(on,1,p.l)),2&e){let e;p.Mc(e=p.oc())&&(t.scrollableContent=e.first),p.Mc(e=p.oc())&&(t.messageComponents=e)}},hostBindings:function(e,t){1&e&&p.nc("click",function(e){return t.ignoreSelection(e)})},inputs:{currentUserId:"currentUserId",members:"members",messages:"messages",otherMembers:"otherMembers",thread:"thread",chatBoxMode:"chatBoxMode",canLoadMore:"canLoadMore",showLoadingMoreSpinner:"showLoadingMoreSpinner",usersTyping:"usersTyping",useThumbnailService:"useThumbnailService"},outputs:{previewModalClose:"previewModalClose",previewModalOpen:"previewModalOpen",resendMessage:"resendMessage",loadMoreMessages:"loadMoreMessages"},features:[p.Eb],decls:11,vars:7,consts:function(){let e,t,i;return e="Show new messages",t=" Load more... ",i=" This is the start of your conversation ",[[1,"MessageList-content"],[1,"MessageList-scrollable"],["scrollableContent",""],["flTrackingLabel","ChatboxInitialisationSpinner",3,"overlay",4,"ngIf"],[1,"MessageList-loadMore"],["flTrackingLabel","LoadMoreMessages",3,"click",4,"ngIf"],["flTrackingLabel","ChatboxLoadMessagesSpinner",3,"size",4,"ngIf"],[4,"ngFor","ngForOf","ngForTrackBy"],["flTrackingLabel","show_new_messages","text",e,3,"icon","click",4,"ngIf"],["class","MessageList-emptyStateText",3,"ngClass",4,"ngIf"],["name","ui-refresh",1,"MessageList-preloadIcon"],["flTrackingLabel","ChatboxInitialisationSpinner",3,"overlay"],["flTrackingLabel","LoadMoreMessages",3,"click"],t,["flTrackingLabel","ChatboxLoadMessagesSpinner",3,"size"],[3,"ngClass","after","before","currentUserId","usersTyping","message","otherMembers","threadMembers","userReadTimes","chatBoxMode","useThumbnailService","previewModalClose","previewModalOpen","resendMessage",4,"ngIf"],[3,"ngClass","after","before","currentUserId","usersTyping","message","otherMembers","threadMembers","userReadTimes","chatBoxMode","useThumbnailService","previewModalClose","previewModalOpen","resendMessage"],["flTrackingLabel","show_new_messages","text",e,3,"icon","click"],[1,"MessageList-emptyStateText",3,"ngClass"],[3,"textAlign","flMarginBottom","color"],i]},template:function(e,t){1&e&&(p.Yb(0,"fl-bit",0),p.Yb(1,"fl-scrollable-content",1,2),p.ad(3,dn,1,1,"fl-spinner",3),p.Yb(4,"fl-bit",4),p.ad(5,hn,2,0,"fl-link",5),p.ad(6,gn,1,1,"fl-spinner",6),p.Xb(),p.ad(7,fn,2,1,"ng-container",7),p.ad(8,pn,1,1,"fl-floating-action",8),p.Xb(),p.Xb(),p.ad(9,Cn,3,7,"fl-bit",9),p.Tb(10,"fl-icon",10)),2&e&&(p.Gb(3),p.zc("ngIf",t.showLoadingSpinner),p.Gb(2),p.zc("ngIf",!t.showLoadingMoreSpinner&&t.canLoadMore),p.Gb(1),p.zc("ngIf",t.showLoadingMoreSpinner),p.Gb(1),p.zc("ngForOf",t.messages)("ngForTrackBy",t.identifyMessage),p.Gb(1),p.zc("ngIf",t.showNewMessageFloatingAction),p.Gb(1),p.zc("ngIf",t.thread.isFake))},directives:[ke.a,Tt.a,n.q,n.p,le.d,Mi.c,_e.a,Ae.a,pe.b,on,n.o,cn.a,de.e,me.b],styles:["[_nghost-%COMP%]{background:#fff;display:flex;flex:1 0;flex-direction:column;justify-content:space-between;position:relative}.MessageList-scrollable[_ngcontent-%COMP%]{padding-right:8px}@media (min-width:768px){.MessageList-scrollable[_ngcontent-%COMP%]{padding-right:0}}.MessageList-content[_ngcontent-%COMP%]{bottom:0;left:0;position:absolute;right:0;top:0;flex:1 0 100%;padding-left:8px}.MessageList-content-wrapper[_ngcontent-%COMP%]{margin:0 auto 4px;width:95%}@media (-ms-high-contrast:active),(-ms-high-contrast:none){.MessageList-content-wrapper[_ngcontent-%COMP%]{display:block}}@media (-ms-high-contrast:active),(-ms-high-contrast:none){.MessageList-content-chatbox-wrapper[_ngcontent-%COMP%]{display:block}}.MessageList-placeholder[_ngcontent-%COMP%]{align-items:flex-end;display:flex;flex:1 0 100%;justify-content:center}.MessageList-preloadIcon[_ngcontent-%COMP%]{display:none}.MessageList-loadMore[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;padding-top:16px}.MessageList-emptyStateText[_ngcontent-%COMP%]{left:50%;position:absolute;transform:translateX(-50%);bottom:0;width:100%}"],changeDetection:0}),e})();i("7A1k");var Sn=i("KtYJ"),xn=i("2Vo4"),yn=i("C825");function Tn(e,t){1&e&&(p.Wb(0),p.cc(1,7),p.Vb())}function In(e,t){if(1&e&&(p.Yb(0,"fl-text"),p.cd(1),p.Xb()),2&e){const e=p.rc().$implicit;p.Gb(1),p.ed(" ",e.username," ")}}function On(e,t){if(1&e&&p.Tb(0,"fl-relative-time",11),2&e){const e=p.rc(2).$implicit,t=p.rc();p.zc("size",t.TextSize.XXXSMALL)("date",e.onlineOfflineStatus.lastUpdatedTimestamp)("includeSeconds",!1)("strict",!0)}}function vn(e,t){if(1&e&&(p.Yb(0,"fl-bit"),p.Yb(1,"fl-text",8),p.cc(2,9),p.Xb(),p.ad(3,On,1,4,"fl-relative-time",10),p.Xb()),2&e){const e=p.rc().$implicit,t=p.rc();p.Gb(1),p.zc("fontType",t.FontType.SPAN)("size",t.TextSize.XXXSMALL)("color",t.FontColor.MID),p.Gb(2),p.zc("ngIf",e.onlineOfflineStatus)}}function An(e,t){if(1&e&&p.Tb(0,"fl-icon",15),2&e){const e=p.rc(3);p.zc("color",e.IconColor.MID)("size",e.IconSize.SMALL)("hoverColor",e.HoverColor.PRIMARY)}}function wn(e,t){if(1&e&&p.Tb(0,"fl-icon",16),2&e){const e=p.rc(3);p.zc("color",e.IconColor.MID)("size",e.IconSize.SMALL)("hoverColor",e.HoverColor.PRIMARY)}}function kn(e,t){if(1&e){const e=p.Zb();p.Yb(0,"fl-button",12),p.nc("click",function(){p.Qc(e);const t=p.rc().$implicit;return p.rc().handleRemove(t)}),p.ad(1,An,1,3,"fl-icon",13),p.ad(2,wn,1,3,"fl-icon",14),p.Xb()}if(2&e){const e=p.rc().$implicit,t=p.rc();p.Gb(1),p.zc("ngIf",e.id===t.currentUser.id),p.Gb(1),p.zc("ngIf",e.id!==t.currentUser.id)}}const zn=function(e){return[e]};function En(e,t){if(1&e&&(p.Yb(0,"fl-bit",2),p.Tb(1,"fl-user-avatar",3),p.sc(2,"isOnline"),p.sc(3,"flAsync"),p.Yb(4,"fl-bit"),p.Yb(5,"fl-link",4),p.cd(6),p.ad(7,Tn,2,0,"ng-container",5),p.Xb(),p.ad(8,In,2,1,"fl-text",5),p.ad(9,vn,4,4,"fl-bit",5),p.sc(10,"isOnline"),p.sc(11,"flAsync"),p.Xb(),p.ad(12,kn,3,2,"fl-button",6),p.Xb()),2&e){const e=t.$implicit,i=t.last,n=p.rc();p.zc("flMarginBottom",i?n.Margin.NONE:n.Margin.SMALL),p.Gb(1),p.zc("users",p.Ec(20,zn,e))("isOnline",p.uc(2,10,e,p.tc(3,13,n.onlineOfflineStatuses$)))("flMarginRight",n.Margin.XXXSMALL),p.Gb(4),p.zc("link",e.profileUrl),p.Gb(1),p.ed(" ",e.displayName," "),p.Gb(1),p.zc("ngIf",e.id===n.currentUser.id),p.Gb(1),p.zc("ngIf",n.isRecruiter&&e.username!==e.displayName),p.Gb(1),p.zc("ngIf",e.id!==n.currentUser.id&&!p.uc(10,15,e,p.tc(11,18,n.onlineOfflineStatuses$))&&(null==e||null==e.onlineOfflineStatus?null:e.onlineOfflineStatus.lastUpdatedTimestamp)),p.Gb(3),p.zc("ngIf",n.showRemoveButton(e))}}function Ln(e,t){if(1&e&&(p.Yb(0,"fl-text",17),p.cc(1,18),p.Xb()),2&e){const e=p.rc();p.zc("color",e.FontColor.MID)("size",e.TextSize.XXSMALL)}}let _n=(()=>{class e{constructor(){this.Margin=me.a,this.ButtonColor=fe.a,this.FontColor=Me.a,this.TextSize=de.f,this.FontType=de.b,this.IconColor=le.c,this.IconSize=le.e,this.HoverColor=le.a,this.userRemoval=new p.n}showRemoveButton(e){return this.thread.threadType===Ut.ThreadTypeApi.TEAM?!!this.team&&e.id!==this.team.ownerUserId&&this.team.members.includes(e.id):this.thread.threadType!==Ut.ThreadTypeApi.TEAM_OFFICIAL&&(e.id===this.currentUser.id||this.isThreadOwner||this.isRecruiter)&&this.thread.threadType!==Ut.ThreadTypeApi.PRIVATE_CHAT}showGroupChatHelperText(){return 2===this.participants.length&&this.thread.context.type!==Ut.ContextTypeApi.NONE&&(this.isThreadOwner&&this.candidatesExist||this.isRecruiter)}handleRemove(e){this.userRemoval.emit(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=p.Mb({type:e,selectors:[["app-participants-view-content"]],inputs:{participants:"participants",onlineOfflineStatuses$:"onlineOfflineStatuses$",isThreadOwner:"isThreadOwner",candidatesExist:"candidatesExist",isRecruiter:"isRecruiter",currentUser:"currentUser",thread:"thread",team:"team"},outputs:{userRemoval:"userRemoval"},decls:2,vars:2,consts:function(){let e,t,i,n,a;return e=" (you) ",t=" Last seen ",i="Leave this chat",n="Remove the user from this chat",a=" You are currently talking to one user, add more people to start a new group chat. ",[["class","ParticipantItem",3,"flMarginBottom",4,"ngFor","ngForOf"],["class","AsideText",3,"color","size",4,"ngIf"],[1,"ParticipantItem",3,"flMarginBottom"],[3,"users","isOnline","flMarginRight"],["flTrackingSection","ParticipantsView","flTrackingLabel","UsernameLink",3,"link"],[4,"ngIf"],["class","RemoveButton","flTrackingLabel","GroupChatRemoveParticipant",3,"click",4,"ngIf"],e,[3,"fontType","size","color"],t,[3,"size","date","includeSeconds","strict",4,"ngIf"],[3,"size","date","includeSeconds","strict"],["flTrackingLabel","GroupChatRemoveParticipant",1,"RemoveButton",3,"click"],["name","ui-close","label",i,3,"color","size","hoverColor",4,"ngIf"],["name","ui-close","label",n,3,"color","size","hoverColor",4,"ngIf"],["name","ui-close","label",i,3,"color","size","hoverColor"],["name","ui-close","label",n,3,"color","size","hoverColor"],[1,"AsideText",3,"color","size"],a]},template:function(e,t){1&e&&(p.ad(0,En,13,22,"fl-bit",0),p.ad(1,Ln,2,2,"fl-text",1)),2&e&&(p.zc("ngForOf",t.participants),p.Gb(1),p.zc("ngIf",t.showGroupChatHelperText()))},directives:[n.p,n.q,ke.a,me.b,fi.b,pe.b,hi.a,Ae.a,de.e,Le.b,fe.b,le.d],pipes:[Ft.a,je.a],styles:[".ParticipantItem[_ngcontent-%COMP%]{align-items:center;display:flex}.ParticipantItem[_ngcontent-%COMP%]:hover   .RemoveButton[_ngcontent-%COMP%]{opacity:1}.RemoveButton[_ngcontent-%COMP%]{flex:0 0 auto;margin-left:auto;opacity:0;transition:opacity .1s ease-in}.AsideText[_ngcontent-%COMP%]{padding:12px}"],changeDetection:0}),e})();var jn=i("/zj7");function Pn(e,t){if(1&e){const e=p.Zb();p.Yb(0,"fl-list-item",5),p.nc("click",function(){return p.Qc(e),p.rc().inboxRedirect()}),p.Tb(1,"fl-icon",6),p.Yb(2,"fl-text",7),p.cc(3,8),p.Xb(),p.Xb()}if(2&e){const e=p.rc();p.Gb(1),p.zc("color",e.IconColor.PRIMARY)("size",e.IconSize.SMALL)("flMarginRight",e.Margin.XSMALL)("name","ui-inbox"),p.Gb(1),p.zc("size",e.TextSize.XSMALL)("fontType",e.FontType.SPAN)}}function Rn(e,t){if(1&e){const e=p.Zb();p.Yb(0,"fl-list-item",10),p.nc("click",function(){return p.Qc(e),p.rc(2).handleArchiveClick()}),p.Yb(1,"fl-bit",11),p.Yb(2,"fl-text",12),p.cc(3,13),p.Xb(),p.Yb(4,"fl-text",14),p.cc(5,15),p.Xb(),p.Xb(),p.Xb()}if(2&e){const e=p.rc().ngIf,t=p.rc();p.zc("control",e),p.Gb(2),p.zc("size",t.TextSize.XSMALL),p.Gb(2),p.zc("color",t.FontColor.MID)("size",t.TextSize.XXSMALL)}}function Bn(e,t){if(1&e&&(p.Wb(0),p.ad(1,Rn,6,4,"fl-list-item",9),p.Vb()),2&e){const e=t.ngIf,i=p.rc();p.Gb(1),p.zc("ngIf",i.isFormControl(e))}}function $n(e,t){if(1&e){const e=p.Zb();p.Yb(0,"fl-list-item",17),p.nc("click",function(){return p.Qc(e),p.rc(2).handleMuteClick()}),p.Yb(1,"fl-bit",11),p.Yb(2,"fl-text",12),p.cc(3,18),p.Xb(),p.Yb(4,"fl-text",14),p.cc(5,19),p.Xb(),p.Xb(),p.Xb()}if(2&e){const e=p.rc().ngIf,t=p.rc();p.zc("control",e),p.Gb(2),p.zc("size",t.TextSize.XSMALL),p.Gb(2),p.zc("color",t.FontColor.MID)("size",t.TextSize.XXSMALL)}}function Un(e,t){if(1&e&&(p.Wb(0),p.ad(1,$n,6,4,"fl-list-item",16),p.Vb()),2&e){const e=t.ngIf,i=p.rc();p.Gb(1),p.zc("ngIf",i.isFormControl(e))}}function Gn(e,t){if(1&e){const e=p.Zb();p.Yb(0,"fl-list-item",21),p.nc("click",function(){return p.Qc(e),p.rc(2).handleBlockClick()}),p.Yb(1,"fl-bit",11),p.Yb(2,"fl-text",12),p.cc(3,22),p.Xb(),p.Yb(4,"fl-text",14),p.cc(5,23),p.Xb(),p.Xb(),p.Xb()}if(2&e){const e=p.rc().ngIf,t=p.rc();p.zc("control",e),p.Gb(2),p.zc("size",t.TextSize.XSMALL),p.Gb(2),p.zc("color",t.FontColor.MID)("size",t.TextSize.XXSMALL)}}const Nn=function(){return["group","team","team_official"]};function Fn(e,t){if(1&e&&(p.Wb(0),p.ad(1,Gn,6,4,"fl-list-item",20),p.Vb()),2&e){const e=t.ngIf,i=p.rc();p.Gb(1),p.zc("ngIf",1===i.thread.otherMembers.length&&!p.Dc(1,Nn).includes(i.thread.threadType)&&"owner_autochat"!==i.thread.writePrivacy&&i.isFormControl(e))}}function Dn(e,t){if(1&e){const e=p.Zb();p.Yb(0,"fl-list",24),p.Yb(1,"fl-list-item",25),p.nc("click",function(){return p.Qc(e),p.rc().handleReportClick()}),p.Yb(2,"fl-bit",26),p.Tb(3,"fl-icon",27),p.Yb(4,"fl-bit"),p.Yb(5,"fl-text"),p.cc(6,28),p.Xb(),p.Yb(7,"fl-text",14),p.cc(8,29),p.Xb(),p.Xb(),p.Xb(),p.Xb(),p.Xb()}if(2&e){const e=p.rc();p.zc("clickable",!0)("padding",e.ListItemPadding.XXSMALL),p.Gb(3),p.zc("flMarginRight",e.Margin.XSMALL)("name","ui-warning-alt-v2")("size",e.IconSize.SMALL),p.Gb(4),p.zc("color",e.FontColor.MID)("size",e.TextSize.XXSMALL)}}let Xn=(()=>{class e{constructor(e,t){this.modalService=e,this.router=t,this.ContextTypeApi=Ut.ContextTypeApi,this.Margin=me.a,this.IconColor=le.c,this.IconSize=le.e,this.isFormControl=g.k,this.FontColor=Me.a,this.TextSize=de.f,this.FontType=de.b,this.ListItemType=Sn.f,this.ListItemPadding=Sn.e,this.showReportCta=!1,this.chatBoxMode=!0,this.archiveChatToggle=new p.n,this.muteChatToggle=new p.n,this.blockChatToggle=new p.n,this.formGroup=new a.h({archive:new a.f,mute:new a.f,block:new a.f})}ngOnInit(){this.formGroup.controls.archive.setValue(this.thread.folder===Ut.FolderApi.ARCHIVED),this.formGroup.controls.mute.setValue(this.thread.isMuted),this.formGroup.controls.block.setValue(this.thread.isBlocked)}ngOnChanges(e){if(e.thread&&e.thread.previousValue){const t=this.thread.folder===Ut.FolderApi.ARCHIVED;e.thread.previousValue.folder!==this.thread.folder&&(this.formGroup.controls.archive.setValue(t),this.formGroup.controls.archive.enable()),e.thread.previousValue.isMuted!==this.thread.isMuted&&(this.formGroup.controls.mute.setValue(this.thread.isMuted),this.formGroup.controls.mute.enable()),e.thread.previousValue.isBlocked!==this.thread.isBlocked&&(this.formGroup.controls.block.setValue(this.thread.isBlocked),this.formGroup.controls.block.enable())}}handleArchiveClick(){this.formGroup.controls.archive.enabled&&(this.formGroup.controls.archive.disable(),this.archiveChatToggle.emit(!0))}handleMuteClick(){this.formGroup.controls.mute.enabled&&(this.formGroup.controls.mute.disable(),this.muteChatToggle.emit(!0))}handleBlockClick(){this.formGroup.controls.block.enabled&&(this.formGroup.controls.block.disable(),this.blockChatToggle.emit(!0))}handleReportClick(){this.thread.context.type===Ut.ContextTypeApi.PROJECT&&this.modalService.open("ViolationReportModal",{inputs:{violatorUserId:this.thread.owner,contextId:this.thread.context.id,contextType:Nt.ViolationReportContextTypeApi.PROJECT},size:Ce.a.MID,mobileFullscreen:!0})}inboxRedirect(){if(this.thread.isFake){const{threadType:e,members:t,context:i}=this.thread;this.router.navigate(["/messages/new"],{queryParams:{newMessageOptions:{thread_type:e,context_type:i.type,context_id:i.type!==Ut.ContextTypeApi.NONE?i.id:void 0,members:t}}})}this.router.navigate(["/messages/thread",this.thread.id])}}return e.\u0275fac=function(t){return new(t||e)(p.Sb(Ie.b),p.Sb(Te.e))},e.\u0275cmp=p.Mb({type:e,selectors:[["app-settings-overlay-content"]],inputs:{showReportCta:"showReportCta",thread:"thread",chatBoxMode:"chatBoxMode"},outputs:{archiveChatToggle:"archiveChatToggle",muteChatToggle:"muteChatToggle",blockChatToggle:"blockChatToggle"},features:[p.Eb],decls:7,vars:12,consts:function(){let e,t,i,n,a,s,o,r,c;return e="Open this chat in your inbox ",t=" Archive ",i=" Hide this chat from your active chats. You will still receive notifications. ",n=" Mute ",a=" You will receive no notifications for future messages. ",s=" Block ",o=" No members of this chat will be able to send any messages in it. ",r="Report",c=" There is something wrong with this conversation. ",[[3,"bottomBorder","clickable","padding","type"],["flTrackingLabel","settingsInbox",3,"click",4,"ngIf"],[3,"bottomBorder","type","padding"],[4,"ngIf"],[3,"clickable","padding",4,"ngIf"],["flTrackingLabel","settingsInbox",3,"click"],[3,"color","size","flMarginRight","name"],[3,"size","fontType"],e,["flTrackingLabel","settingsArchive",3,"control","click",4,"ngIf"],["flTrackingLabel","settingsArchive",3,"control","click"],[1,"SettingListItem"],[3,"size"],t,[3,"color","size"],i,["flTrackingLabel","settingsMute",3,"control","click",4,"ngIf"],["flTrackingLabel","settingsMute",3,"control","click"],n,a,["flTrackingLabel","settingsBlock",3,"control","click",4,"ngIf"],["flTrackingLabel","settingsBlock",3,"control","click"],s,o,[3,"clickable","padding"],["flTrackingLabel","ChatboxReportCta",3,"click"],[1,"ChatboxReportCta"],[3,"flMarginRight","name","size"],r,c]},template:function(e,t){1&e&&(p.Yb(0,"fl-list",0),p.ad(1,Pn,4,6,"fl-list-item",1),p.Xb(),p.Yb(2,"fl-list",2),p.ad(3,Bn,2,1,"ng-container",3),p.ad(4,Un,2,1,"ng-container",3),p.ad(5,Fn,2,2,"ng-container",3),p.Xb(),p.ad(6,Dn,9,7,"fl-list",4)),2&e&&(p.zc("bottomBorder",!0)("clickable",!0)("padding",t.ListItemPadding.XXSMALL)("type",t.ListItemType.DEFAULT),p.Gb(1),p.zc("ngIf",t.chatBoxMode),p.Gb(1),p.zc("bottomBorder",t.showReportCta)("type",t.ListItemType.CHECKBOX)("padding",t.ListItemPadding.XXSMALL),p.Gb(1),p.zc("ngIf",t.formGroup.get("archive")),p.Gb(1),p.zc("ngIf",t.formGroup.get("mute")),p.Gb(1),p.zc("ngIf",t.formGroup.get("block")),p.Gb(1),p.zc("ngIf",t.showReportCta))},directives:[jn.a,n.q,Sn.b,Ae.a,le.d,me.b,de.e,ke.a],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column}.ChatboxReportCta[_ngcontent-%COMP%]{align-items:center;display:flex}"],changeDetection:0}),e})();var Yn=i("2Gc0");function Hn(e,t){1&e&&p.Ub(0)}function Vn(e,t){if(1&e&&p.Tb(0,"fl-picture",9),2&e){const e=p.rc();p.zc("src",e.imageThumbnailPath)("boundedWidth",!0)("alt",e.filename)("externalSrc",!0)("flMarginRight",e.Margin.XXSMALL)}}function Qn(e,t){if(1&e&&(p.Tb(0,"fl-file-display",10),p.sc(1,"flAsync")),2&e){const e=p.rc();p.zc("src",p.tc(1,4,e.pathPromise))("alt",e.filename)("size",e.FileDisplaySize.SMALL)("flMarginRight",e.Margin.XXSMALL)}}let Wn=(()=>{class e{constructor(e){this.fileStorage=e,this.Margin=me.a,this.FileDisplaySize=Yn.c,this.FontColor=Me.a,this.TextSize=de.f,this.ImageAttachmentThumbnailHeight=ai,this.ImageAttachmentThumbnailWidth=si,this.useThumbnailService=!1}set attachment(e){this.filename=e.filename,this.pathPromise=this.fileStorage.getDownloadURL(ti.a.MESSAGING_ATTACHMENTS,e.filename,{messageId:e.messageId.toString()}).then(e=>"success"===e.status?e.downloadURL:void 0),this.date=new Date(e.timeCreated),this.isImageFile=Object(ii.i)(this.filename),this.imageThumbnailPath=oi(e.messageId,e.filename,{height:ai.ATTACHMENT_SIDEBAR,width:si.ATTACHMENT_SIDEBAR}),this.isGifFile="gif"===Object(ii.e)(e.filename)}}return e.\u0275fac=function(t){return new(t||e)(p.Sb(li.a))},e.\u0275cmp=p.Mb({type:e,selectors:[["app-sidebar-attachment-item"]],inputs:{attachment:"attachment",useThumbnailService:"useThumbnailService"},decls:13,vars:8,consts:function(){let e;return e=" Uploaded " + "\ufffd0\ufffd" + " ",[[1,"SidebarAttachment"],[4,"ngTemplateOutlet"],[1,"SidebarAttachment-details"],[3,"size"],[1,"SidebarAttachment-fileName"],[3,"size","color"],e,["imageThumbnail",""],["fileDisplay",""],[1,"SidebarAttachment-icon",3,"src","boundedWidth","alt","externalSrc","flMarginRight"],[1,"SidebarAttachment-icon",3,"src","alt","size","flMarginRight"]]},template:function(e,t){if(1&e&&(p.Yb(0,"fl-bit",0),p.ad(1,Hn,1,0,"ng-container",1),p.Yb(2,"fl-bit",2),p.Yb(3,"fl-text",3),p.Yb(4,"fl-bit",4),p.cd(5),p.Xb(),p.Xb(),p.Yb(6,"fl-text",5),p.cc(7,6),p.sc(8,"date"),p.Xb(),p.Xb(),p.Xb(),p.ad(9,Vn,1,5,"ng-template",null,7,p.bd),p.ad(11,Qn,2,6,"ng-template",null,8,p.bd)),2&e){const e=p.Nc(10),i=p.Nc(12);p.Gb(1),p.zc("ngTemplateOutlet",t.isImageFile&&!t.isGifFile&&t.useThumbnailService?e:i),p.Gb(2),p.zc("size",t.TextSize.XSMALL),p.Gb(2),p.dd(t.filename),p.Gb(1),p.zc("size",t.TextSize.XXSMALL)("color",t.FontColor.MID),p.Gb(2),p.gc(p.tc(8,6,t.date)),p.dc(7)}},directives:[ke.a,n.v,de.e,ni.a,me.b,Yn.a],pipes:[n.f,je.a],styles:[".SidebarAttachment[_ngcontent-%COMP%]{align-items:center;display:flex;flex-direction:row}.SidebarAttachment-icon[_ngcontent-%COMP%]{flex-shrink:0}.SidebarAttachment-details[_ngcontent-%COMP%]{flex:1 1 100%;min-width:0}.SidebarAttachment-fileName[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}"],changeDetection:0}),e})();function qn(e,t){if(1&e){const e=p.Zb();p.Yb(0,"fl-list-item",2),p.nc("click",function(){p.Qc(e);const i=t.$implicit;return p.rc().openPreviewModal(i)}),p.Tb(1,"app-sidebar-attachment-item",3),p.Xb()}if(2&e){const e=t.$implicit,i=p.rc();p.Ac("flTrackingReferenceId",e.threadId),p.Gb(1),p.zc("attachment",e)("useThumbnailService",i.useThumbnailService)}}let Kn=(()=>{class e{constructor(e,t,i,n,a){this.modalService=e,this.tracking=t,this.fileDownload=i,this.fileStorage=n,this.userAgent=a,this.TextSize=de.f,this.FontWeight=de.c,this.ListItemPadding=Sn.e,this.ListItemType=Sn.f,this.ModalSize=Ce.a,this.useThumbnailService=!1}identifyAttachment(e,t){return t.id}openPreviewModal(e){return Object(x.a)(this,void 0,void 0,function*(){if(["IE","Edge"].includes(this.userAgent.getUserAgent().getBrowser().name||"")){const t=yield this.fileStorage.getDownloadURL(ti.a.MESSAGING_ATTACHMENTS,e.filename,{messageId:e.messageId.toString()});if("error"===t.status)return;return this.fileDownload.download(t.downloadURL,e.filename)}this.modalService.open("FileViewerModal",{inputs:{messageId:e.messageId,filename:e.filename,filetype:Object(ii.f)(e.filename)},edgeToEdge:!0,size:Ce.a.XLARGE}).afterClosed().toPromise().then(()=>{this.tracking.track("user_action",{section:"messaging_image_viewer",subsection:"header",label:"close_image_viewer"})})})}}return e.\u0275fac=function(t){return new(t||e)(p.Sb(Ie.b),p.Sb(ri.a),p.Sb(ci.a),p.Sb(li.a),p.Sb(di.a))},e.\u0275cmp=p.Mb({type:e,selectors:[["app-sidebar-attachments"]],inputs:{attachments:"attachments",useThumbnailService:"useThumbnailService"},decls:2,vars:5,consts:[[3,"clickable","padding","type"],["flTrackingLabel","open_image_viewer","flTrackingReferenceType","thread_id",3,"flTrackingReferenceId","click",4,"ngFor","ngForOf","ngForTrackBy"],["flTrackingLabel","open_image_viewer","flTrackingReferenceType","thread_id",3,"flTrackingReferenceId","click"],[3,"attachment","useThumbnailService"]],template:function(e,t){1&e&&(p.Yb(0,"fl-list",0),p.ad(1,qn,2,3,"fl-list-item",1),p.Xb()),2&e&&(p.zc("clickable",!0)("padding",t.ListItemPadding.XXSMALL)("type",t.ListItemType.NON_BORDERED),p.Gb(1),p.zc("ngForOf",t.attachments)("ngForTrackBy",t.identifyAttachment))},directives:[jn.a,n.p,Sn.b,Ae.a,Wn],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column}.SidebarImages[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:wrap}"],changeDetection:0}),e})();function Zn(e,t){if(1&e&&(p.Yb(0,"fl-bit",13),p.Yb(1,"fl-text",3),p.cc(2,14),p.Xb(),p.Yb(3,"fl-bit",5),p.Tb(4,"app-context-box",15),p.Xb(),p.Xb()),2&e){const e=p.rc();p.zc("flHideTablet",!0)("flHideMobile",!0),p.Gb(1),p.zc("weight",e.FontWeight.BOLD)("size",e.TextSize.SMALL)("flMarginBottom",e.Margin.XXSMALL),p.Gb(2),p.zc("flMarginBottom",e.Margin.XXSMALL),p.Gb(1),p.zc("extended",!0)("chatBoxMode",!1)("state",e.contextBoxState)}}function Jn(e,t){1&e&&(p.Wb(0),p.cc(1,23),p.Vb())}function ea(e,t){1&e&&(p.Wb(0),p.cc(1,24),p.Vb())}function ta(e,t){if(1&e&&(p.Yb(0,"fl-bit",13),p.Yb(1,"fl-text",9),p.ad(2,Jn,2,0,"ng-container",16),p.ad(3,ea,2,0,"ng-container",16),p.Xb(),p.Yb(4,"fl-list",17),p.Yb(5,"fl-list-item"),p.Yb(6,"fl-link",18),p.Tb(7,"fl-icon",19),p.cd(8),p.Xb(),p.Xb(),p.Yb(9,"fl-list-item"),p.Tb(10,"fl-icon",19),p.Yb(11,"fl-text",20),p.cc(12,21),p.Xb(),p.Tb(13,"fl-relative-time",22),p.Xb(),p.Xb(),p.Xb()),2&e){const e=p.rc();p.zc("flHideTablet",!0)("flHideMobile",!0),p.Gb(1),p.zc("weight",e.FontWeight.BOLD)("size",e.TextSize.SMALL),p.Gb(1),p.zc("ngIf","project"===e.thread.context.type),p.Gb(1),p.zc("ngIf","contest"===e.thread.context.type),p.Gb(1),p.zc("type",e.ListItemType.NON_BORDERED)("padding",e.ListItemPadding.XXSMALL),p.Gb(2),p.zc("link",e.contextBoxState.linkUrl)("queryParams",e.contextBoxState.linkQueryParams),p.Gb(1),p.zc("flMarginRight",e.Margin.XXXSMALL)("name","ui-link")("size",e.IconSize.SMALL),p.Gb(1),p.ed(" ",e.contextBoxState.linkText," "),p.Gb(2),p.zc("flMarginRight",e.Margin.XXXSMALL)("name","ui-hourglass")("size",e.IconSize.SMALL),p.Gb(1),p.zc("fontType",e.FontType.SPAN)("size",e.TextSize.XSMALL),p.Gb(2),p.zc("date",e.contextBoxState.timeSubmitted)("size",e.TextSize.XSMALL)("color",e.FontColor.DARK)}}function ia(e,t){if(1&e){const e=p.Zb();p.Yb(0,"fl-link",25),p.nc("click",function(){return p.Qc(e),p.rc().onAddPeopleClick()}),p.cc(1,26),p.Xb()}if(2&e){const e=p.rc();p.zc("flMarginBottom",e.Margin.XXSMALL)}}function na(e,t){if(1&e){const e=p.Zb();p.Yb(0,"fl-link",32),p.nc("click",function(){return p.Qc(e),p.rc(2).handleLoadAttachments()}),p.cc(1,33),p.Xb()}if(2&e){const e=p.rc(2);p.zc("flMarginBottom",e.Margin.XSMALL)}}function aa(e,t){if(1&e&&(p.Yb(0,"fl-bit",27),p.Yb(1,"fl-text",28),p.cc(2,29),p.Xb(),p.Tb(3,"app-sidebar-attachments",30),p.sc(4,"flAsync"),p.ad(5,na,2,1,"fl-link",31),p.sc(6,"flAsync"),p.Xb()),2&e){const e=p.rc();p.Gb(1),p.zc("size",e.TextSize.SMALL)("weight",e.FontWeight.BOLD),p.Gb(2),p.zc("attachments",p.tc(4,5,e.attachmentsCollection.valueChanges()))("useThumbnailService",e.useThumbnailService),p.Gb(2),p.zc("ngIf",p.tc(6,7,e.canLoadMore$))}}let sa=(()=>{class e{constructor(e,t){this.datastore=e,this.abtestService=t,this.Margin=me.a,this.FontColor=Me.a,this.TextSize=de.f,this.FontType=de.b,this.FontWeight=de.c,this.IconSize=le.e,this.ListItemPadding=Sn.e,this.ListItemType=Sn.f,this.showReportCta=!1,this.chatOptionsMode=!1,this.archiveChatToggle=new p.n,this.blockChatToggle=new p.n,this.muteChatToggle=new p.n,this.userAdd=new p.n,this.userRemove=new p.n,this.currentLimit=50,this.attachmentsLimitSubject$=new xn.a(this.currentLimit)}ngOnInit(){this.resetSubscription=this.threadId$.subscribe(()=>{this.currentLimit=50,this.attachmentsLimitSubject$.next(this.currentLimit)}),this.attachmentsCollection=this.datastore.collection("messageAttachments",e=>e.where("threadId","==",this.threadId$).limit(this.attachmentsLimitSubject$)),this.canLoadMore$=this.attachmentsCollection.valueChanges().pipe(Object(I.a)(e=>e.length>=this.currentLimit)),this.hasAttachments$=this.attachmentsCollection.valueChanges().pipe(Object(I.a)(e=>!!e.length))}ngOnDestroy(){this.resetSubscription&&this.resetSubscription.unsubscribe()}ngOnChanges(e){e.currentUser&&e.currentUser.currentValue&&(this.useThumbnailService=this.abtestService.isWhitelistUser()||this.abtestService.shouldEnrol("T90189-image-thumbnail-service",e.currentUser.currentValue.id,.01))}handleLoadAttachments(){this.currentLimit+=50,this.attachmentsLimitSubject$.next(this.currentLimit)}identifyAttachment(e,t){return t.id}onArchiveChatToggle(){this.archiveChatToggle.emit()}onBlockChatToggle(){this.blockChatToggle.emit()}onMuteChatToggle(){this.muteChatToggle.emit()}onAddPeopleClick(){this.userAdd.emit()}handleUserRemoved(e){this.userRemove.emit(e)}}return e.\u0275fac=function(t){return new(t||e)(p.Sb(Oe.a),p.Sb(yn.a))},e.\u0275cmp=p.Mb({type:e,selectors:[["app-messaging-sidebar"]],inputs:{candidatesExist:"candidatesExist",contextBoxState:"contextBoxState",currentUser:"currentUser",isRecruiter:"isRecruiter",isThreadOwner:"isThreadOwner",onlineOfflineStatuses$:"onlineOfflineStatuses$",showAddPeopleOption:"showAddPeopleOption",showReportCta:"showReportCta",threadId$:"threadId$",thread:"thread",members:"members",team:"team",chatOptionsMode:"chatOptionsMode"},outputs:{archiveChatToggle:"archiveChatToggle",blockChatToggle:"blockChatToggle",muteChatToggle:"muteChatToggle",userAdd:"userAdd",userRemove:"userRemove"},features:[p.Eb],decls:16,vars:24,consts:function(){let e,t,i,n,a,s,o,r,c;return e=" People in Chat ",t=" Settings ",i=" Actions ",n=" Posted ",a=" Project Details ",s=" Contest Details ",o=" Add people ",r=" Thread attachments ",c=" Load more... ",[[1,"MessagingSidebar-scrollbar",3,"hideHorizontalScroll"],["class","MessagingSidebar-subsection",3,"flHideTablet","flHideMobile",4,"ngIf"],[1,"MessagingSidebar-subsection"],[3,"weight","size","flMarginBottom"],e,[3,"flMarginBottom"],[1,"MessagingSidebar-threadMembersScrollSection"],[3,"participants","onlineOfflineStatuses$","currentUser","isRecruiter","isThreadOwner","candidatesExist","thread","team","userRemoval"],["class","MessagingSidebar-actionLink","flTrackingLabel","AddUsersToChat",3,"flMarginBottom","click",4,"ngIf"],[3,"weight","size"],t,[3,"showReportCta","thread","chatBoxMode","archiveChatToggle","muteChatToggle","blockChatToggle"],["class","MessagingSidebar-subsection MessagingSidebar-attachmentsPanel",4,"ngIf"],[1,"MessagingSidebar-subsection",3,"flHideTablet","flHideMobile"],i,[1,"MessagingSidebar-contextBox",3,"extended","chatBoxMode","state"],[4,"ngIf"],[3,"type","padding"],["flTrackingLabel","Inbox.ProjectLink",1,"MessagingSidebar-detailLink",3,"link","queryParams"],[3,"flMarginRight","name","size"],[3,"fontType","size"],n,[3,"date","size","color"],a,s,["flTrackingLabel","AddUsersToChat",1,"MessagingSidebar-actionLink",3,"flMarginBottom","click"],o,[1,"MessagingSidebar-subsection","MessagingSidebar-attachmentsPanel"],[3,"size","weight"],r,[3,"attachments","useThumbnailService"],["class","MessagingSidebar-attachmentsLoad","flTrackingLabel","LoadMoreAttachments",3,"flMarginBottom","click",4,"ngIf"],["flTrackingLabel","LoadMoreAttachments",1,"MessagingSidebar-attachmentsLoad",3,"flMarginBottom","click"],c]},template:function(e,t){1&e&&(p.Yb(0,"fl-scrollable-content",0),p.ad(1,Zn,5,9,"fl-bit",1),p.ad(2,ta,14,22,"fl-bit",1),p.Yb(3,"fl-bit",2),p.Yb(4,"fl-text",3),p.cc(5,4),p.Xb(),p.Yb(6,"fl-bit",5),p.Yb(7,"fl-scrollable-content",6),p.Yb(8,"app-participants-view-content",7),p.nc("userRemoval",function(e){return t.handleUserRemoved(e)}),p.Xb(),p.Xb(),p.Xb(),p.ad(9,ia,2,1,"fl-link",8),p.Xb(),p.Yb(10,"fl-bit",2),p.Yb(11,"fl-text",9),p.cc(12,10),p.Xb(),p.Yb(13,"app-settings-overlay-content",11),p.nc("archiveChatToggle",function(){return t.onArchiveChatToggle()})("muteChatToggle",function(){return t.onMuteChatToggle()})("blockChatToggle",function(){return t.onBlockChatToggle()}),p.Xb(),p.Xb(),p.ad(14,aa,7,9,"fl-bit",12),p.sc(15,"flAsync"),p.Xb()),2&e&&(p.zc("hideHorizontalScroll",!0),p.Gb(1),p.zc("ngIf",(null==t.contextBoxState?null:t.contextBoxState.button)&&!t.chatOptionsMode),p.Gb(1),p.zc("ngIf",t.contextBoxState&&"hireme"!==t.contextBoxState.name&&!t.chatOptionsMode),p.Gb(2),p.zc("weight",t.FontWeight.BOLD)("size",t.TextSize.SMALL)("flMarginBottom",t.Margin.XXSMALL),p.Gb(2),p.zc("flMarginBottom",t.Margin.XXSMALL),p.Gb(2),p.zc("participants",t.members)("onlineOfflineStatuses$",t.onlineOfflineStatuses$)("currentUser",t.currentUser)("isRecruiter",t.isRecruiter)("isThreadOwner",t.isThreadOwner)("candidatesExist",t.candidatesExist)("thread",t.thread)("team",t.team),p.Gb(1),p.zc("ngIf",t.showAddPeopleOption),p.Gb(2),p.zc("weight",t.FontWeight.BOLD)("size",t.TextSize.SMALL),p.Gb(2),p.zc("showReportCta",t.showReportCta)("thread",t.thread)("chatBoxMode",!1),p.Gb(1),p.zc("ngIf",!t.thread.isFake&&p.tc(15,22,t.hasAttachments$)))},directives:[Tt.a,n.q,ke.a,de.e,me.b,_n,Xn,ze.a,Ct,jn.a,Sn.b,pe.b,Ae.a,le.d,Le.b,Kn],pipes:[je.a],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column}.MessagingSidebar-attachmentsLoad[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center}.MessagingSidebar-contextBox[_ngcontent-%COMP%]{display:flex;flex:0 0 auto;flex-direction:column}.MessagingSidebar-contextDetailItem[_ngcontent-%COMP%]{align-items:center;display:flex;flex-direction:row}.MessagingSidebar-subsection[_ngcontent-%COMP%]{border-bottom:1px solid #dedede;padding-top:8px}@media (min-width:768px){.MessagingSidebar-subsection[_ngcontent-%COMP%]{padding-left:8px;padding-right:8px}}.MessagingSidebar-threadMembersScrollSection[_ngcontent-%COMP%]{max-height:300px;padding-right:12px}.MessagingSidebar-attachmentsPanel[_ngcontent-%COMP%]{display:flex;flex-direction:column;overflow-y:hidden}.MessagingSidebar-actionLink[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center}.MessagingSidebar-scrollbar[_ngcontent-%COMP%]{bottom:0;left:0;position:absolute;right:0;top:0}.MessagingSidebar-detailLink[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;display:block}"],changeDetection:0}),e})();var oa=i("IzEk");let ra=(()=>{class e{constructor(){this.FontType=de.b,this.TextSize=de.f}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=p.Mb({type:e,selectors:[["app-overlay-template-discuss"]],inputs:{otherUser:"otherUser"},decls:6,vars:3,consts:function(){let e,t;return e=" Don't forget to discuss goals and deadlines ",t=" Make sure you and " + "\ufffd0\ufffd" + " agree on exactly what the tasks to be completed are, and when each of them is due.",[[1,"OnboardingOverlayTitle"],[3,"size"],e,[1,"OnboardingOverlayBody"],[3,"fontType"],t]},template:function(e,t){1&e&&(p.Yb(0,"fl-bit",0),p.Yb(1,"fl-text",1),p.cc(2,2),p.Xb(),p.Xb(),p.Yb(3,"fl-bit",3),p.Yb(4,"fl-text",4),p.cc(5,5),p.Xb(),p.Xb()),2&e&&(p.Gb(1),p.zc("size",t.TextSize.SMALL),p.Gb(3),p.zc("fontType",t.FontType.SPAN),p.Gb(1),p.gc(t.otherUser.displayName),p.dc(5))},directives:[ke.a,de.e],styles:[".OnboardingOverlay[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;padding:16px;position:absolute;width:100%;word-wrap:break-word}.OnboardingOverlay[_ngcontent-%COMP%]   .Footer[_ngcontent-%COMP%]{align-items:center;display:flex;margin-top:auto}.OnboardingOverlay[_ngcontent-%COMP%]   .Footer[_ngcontent-%COMP%]   .LeftButton[_ngcontent-%COMP%]{min-width:64px}.OnboardingOverlay[_ngcontent-%COMP%]   .Footer[_ngcontent-%COMP%]   .RightButton[_ngcontent-%COMP%]{min-width:64px;padding-left:4px}.OnboardingOverlay[_ngcontent-%COMP%]   .Footer[_ngcontent-%COMP%]   .Progress[_ngcontent-%COMP%]{margin-left:auto;margin-right:auto;width:72px}.OnboardingOverlay[_ngcontent-%COMP%]   .Footer--nonFullFlow[_ngcontent-%COMP%]{justify-content:center}.OnboardingOverlayTitle[_ngcontent-%COMP%]{padding-top:12px;text-align:center}.OnboardingOverlayBody[_ngcontent-%COMP%]{padding-top:24px;text-align:center}"],changeDetection:0}),e})();var ca=i("/e27");function la(e,t){if(1&e&&(p.Yb(0,"fl-text",5),p.cc(1,6),p.sc(2,"truncateFilename"),p.Xb()),2&e){const e=p.rc();p.zc("size",e.TextSize.SMALL),p.Gb(2),p.gc(e.otherUser.displayName)(p.uc(2,3,e.project.title,100)),p.dc(1)}}function da(e,t){if(1&e&&(p.Yb(0,"fl-text",5),p.cc(1,7),p.Xb()),2&e){const e=p.rc();p.zc("size",e.TextSize.SMALL),p.Gb(1),p.gc(e.otherUser.displayName)(e.project.title),p.dc(1)}}let ha=(()=>{class e{constructor(){this.FontType=de.b,this.TextSize=de.f}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=p.Mb({type:e,selectors:[["app-overlay-template-intro"]],inputs:{thread:"thread",otherUser:"otherUser",project:"project"},decls:6,vars:4,consts:function(){let e,t,i;return e=" Click 'Next' to see a few tips on how to make sure you and " + "\ufffd0\ufffd" + " have a great experience working together. ",t=" " + "\ufffd0\ufffd" + " would like to chat to you about " + "\ufffd1\ufffd" + " ",i=" You are about to start chatting to " + "\ufffd0\ufffd" + " about " + "\ufffd1\ufffd" + " ",[[1,"OnboardingOverlayTitle"],[3,"size",4,"ngIf"],[1,"OnboardingOverlayBody"],[3,"fontType"],e,[3,"size"],t,i]},template:function(e,t){1&e&&(p.Yb(0,"fl-bit",0),p.ad(1,la,3,6,"fl-text",1),p.ad(2,da,2,3,"fl-text",1),p.Xb(),p.Yb(3,"fl-bit",2),p.Yb(4,"fl-text",3),p.cc(5,4),p.Xb(),p.Xb()),2&e&&(p.Gb(1),p.zc("ngIf",t.thread&&t.thread.id),p.Gb(1),p.zc("ngIf",!t.thread||!t.thread.id),p.Gb(2),p.zc("fontType",t.FontType.SPAN),p.Gb(1),p.gc(t.otherUser.displayName),p.dc(5))},directives:[ke.a,n.q,de.e],pipes:[ca.a],styles:[".OnboardingOverlay[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;padding:16px;position:absolute;width:100%;word-wrap:break-word}.OnboardingOverlay[_ngcontent-%COMP%]   .Footer[_ngcontent-%COMP%]{align-items:center;display:flex;margin-top:auto}.OnboardingOverlay[_ngcontent-%COMP%]   .Footer[_ngcontent-%COMP%]   .LeftButton[_ngcontent-%COMP%]{min-width:64px}.OnboardingOverlay[_ngcontent-%COMP%]   .Footer[_ngcontent-%COMP%]   .RightButton[_ngcontent-%COMP%]{min-width:64px;padding-left:4px}.OnboardingOverlay[_ngcontent-%COMP%]   .Footer[_ngcontent-%COMP%]   .Progress[_ngcontent-%COMP%]{margin-left:auto;margin-right:auto;width:72px}.OnboardingOverlay[_ngcontent-%COMP%]   .Footer--nonFullFlow[_ngcontent-%COMP%]{justify-content:center}.OnboardingOverlayTitle[_ngcontent-%COMP%]{padding-top:12px;text-align:center}.OnboardingOverlayBody[_ngcontent-%COMP%]{padding-top:24px;text-align:center}"],changeDetection:0}),e})();function ga(e,t){if(1&e&&(p.Wb(0),p.Yb(1,"fl-bit",3),p.Yb(2,"fl-text",4),p.cc(3,5),p.Xb(),p.Xb(),p.Yb(4,"fl-bit",6),p.Yb(5,"fl-text"),p.cc(6,7),p.Xb(),p.Xb(),p.Vb()),2&e){const e=p.rc(2);p.Gb(2),p.zc("size",e.TextSize.SMALL),p.Gb(4),p.gc(e.otherUser.displayName),p.dc(6)}}function ua(e,t){if(1&e&&(p.Yb(0,"fl-text"),p.ic(1,9),p.Tb(2,"fl-link",10),p.fc(),p.Xb()),2&e){const e=p.rc(3);p.Gb(2),p.zc("link",e.MOBILE_APP_DOWNLOAD_LINK),p.gc(e.otherUser.displayName),p.dc(1)}}function ba(e,t){if(1&e&&(p.Wb(0),p.Yb(1,"fl-bit",3),p.Yb(2,"fl-text",4),p.cc(3,8),p.Xb(),p.Xb(),p.Yb(4,"fl-bit",6),p.ad(5,ua,3,2,"fl-text",2),p.Xb(),p.Vb()),2&e){const e=p.rc(2);p.Gb(2),p.zc("size",e.TextSize.SMALL),p.Gb(3),p.zc("ngIf",e.project.local)}}function fa(e,t){if(1&e&&(p.Wb(0),p.ad(1,ga,7,2,"ng-container",2),p.ad(2,ba,6,2,"ng-container",2),p.Vb()),2&e){const e=p.rc();p.Gb(1),p.zc("ngIf",!e.project.local),p.Gb(1),p.zc("ngIf",e.project.local)}}function pa(e,t){if(1&e&&(p.Yb(0,"fl-bit",3),p.Yb(1,"fl-text",4),p.cc(2,11),p.Xb(),p.Xb(),p.Yb(3,"fl-bit",6),p.Yb(4,"fl-text"),p.cc(5,12),p.Xb(),p.Xb()),2&e){const e=p.rc();p.Gb(1),p.zc("size",e.TextSize.SMALL),p.Gb(4),p.gc(e.otherUser.displayName),p.dc(5)}}let ma=(()=>{class e{constructor(){this.FontType=de.b,this.TextSize=de.f,this.MOBILE_APP_DOWNLOAD_LINK="https://bnc.lt/Ed5l/VcovUszaWr"}ngOnChanges(e){var t;("hourlyContracts"in e||"project"in e)&&(this.isHourlyProject=this.project.type===xe.ProjectTypeApi.HOURLY&&(null===(t=this.hourlyContracts)||void 0===t?void 0:t.some(e=>e.projectId===this.project.id)))}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=p.Mb({type:e,selectors:[["app-overlay-template-milestone"]],inputs:{otherUser:"otherUser",project:"project",hourlyContracts:"hourlyContracts"},features:[p.Eb],decls:3,vars:2,consts:function(){let e,t,i,n,a,s;return e=" Track time to get paid ",t=" If " + "\ufffd0\ufffd" + " has enabled time tracking, simply track time with the Desktop App or from the Time Tracking tab to get paid. ",i=" Track location to get paid ",n=" For " + "\ufffd0\ufffd" + " to see your location, you need to use our " + "\ufffd#2\ufffd" + " mobile app " + "\ufffd/#2\ufffd" + " while on the job. ",a=" Only ask for payment to be released after you have completed work ",s=" Ask " + "\ufffd0\ufffd" + " to create milestone payments for work you agree to complete, and only ask for it to be released once you complete the task. ",[[4,"ngIf","ngIfElse"],["default",""],[4,"ngIf"],[1,"OnboardingOverlayTitle"],[3,"size"],e,[1,"OnboardingOverlayBody"],t,i,n,["flTrackingLabel","DownloadMobileAppLink",3,"link"],a,s]},template:function(e,t){if(1&e&&(p.ad(0,fa,3,2,"ng-container",0),p.ad(1,pa,6,2,"ng-template",null,1,p.bd)),2&e){const e=p.Nc(2);p.zc("ngIf",t.isHourlyProject)("ngIfElse",e)}},directives:[n.q,ke.a,de.e,pe.b,Ae.a],styles:[".OnboardingOverlay[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;padding:16px;position:absolute;width:100%;word-wrap:break-word}.OnboardingOverlay[_ngcontent-%COMP%]   .Footer[_ngcontent-%COMP%]{align-items:center;display:flex;margin-top:auto}.OnboardingOverlay[_ngcontent-%COMP%]   .Footer[_ngcontent-%COMP%]   .LeftButton[_ngcontent-%COMP%]{min-width:64px}.OnboardingOverlay[_ngcontent-%COMP%]   .Footer[_ngcontent-%COMP%]   .RightButton[_ngcontent-%COMP%]{min-width:64px;padding-left:4px}.OnboardingOverlay[_ngcontent-%COMP%]   .Footer[_ngcontent-%COMP%]   .Progress[_ngcontent-%COMP%]{margin-left:auto;margin-right:auto;width:72px}.OnboardingOverlay[_ngcontent-%COMP%]   .Footer--nonFullFlow[_ngcontent-%COMP%]{justify-content:center}.OnboardingOverlayTitle[_ngcontent-%COMP%]{padding-top:12px;text-align:center}.OnboardingOverlayBody[_ngcontent-%COMP%]{padding-top:24px;text-align:center}"],changeDetection:0}),e})();var Ca=i("4BSF");let Ma=(()=>{class e{constructor(e){this.siteName=e,this.FontType=de.b,this.TextSize=de.f}}return e.\u0275fac=function(t){return new(t||e)(p.Sb(Ca.e))},e.\u0275cmp=p.Mb({type:e,selectors:[["app-overlay-template-offsite"]],decls:6,vars:5,consts:function(){let e,t;return e=" Always communicate and make payments through " + "\ufffd0\ufffd" + " ",t=" Stay protected from scams and ensure you get paid by only communicating using the " + "[\ufffd0\ufffd|\ufffd1\ufffd]" + " chat system. Never make payments outside " + "[\ufffd0\ufffd|\ufffd1\ufffd]" + ". ",t=p.hc(t),[[1,"OnboardingOverlayTitle"],[3,"size"],e,[1,"OnboardingOverlayBody"],[3,"fontType"],t]},template:function(e,t){1&e&&(p.Yb(0,"fl-bit",0),p.Yb(1,"fl-text",1),p.cc(2,2),p.Xb(),p.Xb(),p.Yb(3,"fl-bit",3),p.Yb(4,"fl-text",4),p.cc(5,5),p.Xb(),p.Xb()),2&e&&(p.Gb(1),p.zc("size",t.TextSize.SMALL),p.Gb(1),p.gc(t.siteName),p.dc(2),p.Gb(2),p.zc("fontType",t.FontType.SPAN),p.Gb(1),p.gc(t.siteName)(t.siteName),p.dc(5))},directives:[ke.a,de.e],styles:[".OnboardingOverlay[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;padding:16px;position:absolute;width:100%;word-wrap:break-word}.OnboardingOverlay[_ngcontent-%COMP%]   .Footer[_ngcontent-%COMP%]{align-items:center;display:flex;margin-top:auto}.OnboardingOverlay[_ngcontent-%COMP%]   .Footer[_ngcontent-%COMP%]   .LeftButton[_ngcontent-%COMP%]{min-width:64px}.OnboardingOverlay[_ngcontent-%COMP%]   .Footer[_ngcontent-%COMP%]   .RightButton[_ngcontent-%COMP%]{min-width:64px;padding-left:4px}.OnboardingOverlay[_ngcontent-%COMP%]   .Footer[_ngcontent-%COMP%]   .Progress[_ngcontent-%COMP%]{margin-left:auto;margin-right:auto;width:72px}.OnboardingOverlay[_ngcontent-%COMP%]   .Footer--nonFullFlow[_ngcontent-%COMP%]{justify-content:center}.OnboardingOverlayTitle[_ngcontent-%COMP%]{padding-top:12px;text-align:center}.OnboardingOverlayBody[_ngcontent-%COMP%]{padding-top:24px;text-align:center}"],changeDetection:0}),e})();var Sa=i("L1P6"),xa=i("J301");function ya(e,t){if(1&e&&p.Tb(0,"app-overlay-template-intro",11),2&e){const e=p.rc(3);p.zc("otherUser",e.otherMembers[0])("project",e.project)("thread",e.thread)}}function Ta(e,t){1&e&&p.Tb(0,"app-overlay-template-offsite")}function Ia(e,t){if(1&e&&p.Tb(0,"app-overlay-template-discuss",12),2&e){const e=p.rc(3);p.zc("otherUser",e.otherMembers[0])}}function Oa(e,t){if(1&e&&p.Tb(0,"app-overlay-template-milestone",13),2&e){const e=p.rc(3);p.zc("hourlyContracts",e.hourlyContracts)("project",e.project)("otherUser",e.otherMembers[0])}}function va(e,t){if(1&e&&(p.Wb(0),p.Yb(1,"fl-bit",6),p.ad(2,ya,1,3,"app-overlay-template-intro",7),p.ad(3,Ta,1,0,"app-overlay-template-offsite",8),p.ad(4,Ia,1,1,"app-overlay-template-discuss",9),p.ad(5,Oa,1,3,"app-overlay-template-milestone",10),p.Xb(),p.Vb()),2&e){const e=p.rc(2);p.Gb(1),p.zc("ngSwitch",e.currentStep),p.Gb(1),p.zc("ngSwitchCase",0),p.Gb(1),p.zc("ngSwitchCase",1),p.Gb(1),p.zc("ngSwitchCase",2),p.Gb(1),p.zc("ngSwitchCase",3)}}function Aa(e,t){1&e&&p.Tb(0,"fl-spinner",14)}function wa(e,t){if(1&e){const e=p.Zb();p.Yb(0,"fl-button",22),p.nc("click",function(){return p.Qc(e),p.rc(3).handleBackClicked()}),p.Tb(1,"fl-icon",23),p.Yb(2,"fl-text",24),p.cc(3,25),p.Xb(),p.Xb()}if(2&e){const e=p.rc(3);p.zc("size",e.ButtonSize.SMALL),p.Gb(1),p.zc("name","ui-chevron-left")("size",e.IconSize.XSMALL),p.Gb(1),p.zc("fontType",e.FontType.SPAN)}}function ka(e,t){if(1&e&&p.Tb(0,"fl-progress-bar",26),2&e){const e=p.rc(3);p.zc("progressPercentage",100*e.currentStep/(e.steps.length-1))}}function za(e,t){if(1&e){const e=p.Zb();p.Yb(0,"fl-button",27),p.nc("click",function(){return p.Qc(e),p.rc(3).handleNextClicked()}),p.Yb(1,"fl-text",24),p.cc(2,28),p.Xb(),p.Tb(3,"fl-icon",23),p.Xb()}if(2&e){const e=p.rc(3);p.zc("size",e.ButtonSize.MINI),p.Gb(1),p.zc("fontType",e.FontType.SPAN),p.Gb(2),p.zc("name","ui-chevron-right")("size",e.IconSize.XSMALL)}}function Ea(e,t){if(1&e){const e=p.Zb();p.Yb(0,"fl-button",29),p.nc("click",function(){return p.Qc(e),p.rc(3).handleEndClicked()}),p.cc(1,30),p.Xb()}if(2&e){const e=p.rc(3);p.zc("color",e.ButtonColor.DEFAULT)("size",e.ButtonSize.MINI)}}function La(e,t){if(1&e&&(p.Yb(0,"fl-bit",15),p.Yb(1,"fl-bit",16),p.ad(2,wa,4,4,"fl-button",17),p.Xb(),p.ad(3,ka,1,1,"fl-progress-bar",18),p.Yb(4,"fl-bit",19),p.ad(5,za,4,4,"fl-button",20),p.ad(6,Ea,2,2,"fl-button",21),p.Xb(),p.Xb()),2&e){const e=p.rc(2);p.zc("flMarginBottom",e.Margin.LARGE),p.Gb(2),p.zc("ngIf",!e.isAtStart()),p.Gb(1),p.zc("ngIf",void 0!==e.currentStep),p.Gb(2),p.zc("ngIf",!e.isAtEnd()),p.Gb(1),p.zc("ngIf",e.isAtEnd())}}function _a(e,t){if(1&e){const e=p.Zb();p.Yb(0,"fl-bit",31),p.Yb(1,"fl-button",32),p.nc("click",function(){return p.Qc(e),p.rc(2).handleEndClicked()}),p.cc(2,33),p.Xb(),p.Xb()}if(2&e){const e=p.rc(2);p.zc("flMarginBottom",e.Margin.LARGE),p.Gb(1),p.zc("color",e.ButtonColor.SECONDARY)("size",e.ButtonSize.SMALL)}}function ja(e,t){if(1&e&&(p.Yb(0,"fl-bit",1),p.ad(1,va,6,5,"ng-container",2),p.ad(2,Aa,1,0,"ng-template",null,3,p.bd),p.ad(4,La,7,5,"fl-bit",4),p.sc(5,"flAsync"),p.ad(6,_a,3,3,"fl-bit",5),p.sc(7,"flAsync"),p.Xb()),2&e){const e=p.Nc(3),t=p.rc();p.Gb(1),p.zc("ngIf",(null==t.otherMembers?null:t.otherMembers.length)>0)("ngIfElse",e),p.Gb(3),p.zc("ngIf",p.tc(5,4,t.showFullFlow$)),p.Gb(2),p.zc("ngIf",!1===p.tc(7,6,t.showFullFlow$))}}let Pa=(()=>{class e{constructor(e,t){this.localStorage=e,this.changeDetectorRef=t,this.Margin=me.a,this.ButtonColor=fe.a,this.ButtonSize=be.a,this.IconSize=le.e,this.FontType=de.b,this.closeOverlay=new p.n,this.steps=[ha,Ma,ra,ma]}ngOnInit(){this.showFullFlow$=this.localStorage.get("projectOverlayFullFlowComplete").pipe(Object(I.a)(e=>!0!==e)),this.showFullFlow$.pipe(Object(oa.a)(1)).toPromise().then(e=>{this.currentStep=e?0:Math.floor(Math.random()*(this.steps.length-1)+1),this.changeDetectorRef.markForCheck()})}handleBackClicked(){void 0===this.currentStep||this.isAtStart()||(this.currentStep--,this.changeDetectorRef.markForCheck())}handleNextClicked(){void 0===this.currentStep||this.isAtEnd()||(this.currentStep++,this.changeDetectorRef.markForCheck())}handleEndClicked(){return Object(x.a)(this,void 0,void 0,function*(){const e=yield this.localStorage.get("projectOverlayThreadComplete").pipe(Object(oa.a)(1)).toPromise(),t=Object.assign(Object.assign({},e),{[this.thread.id]:!0});yield this.localStorage.set("projectOverlayThreadComplete",t),yield this.localStorage.set("projectOverlayFullFlowComplete",!0),this.closeOverlay.emit()})}isAtStart(){return void 0!==this.currentStep&&0===this.currentStep}isAtEnd(){return void 0!==this.currentStep&&this.currentStep>=this.steps.length-1}}return e.\u0275fac=function(t){return new(t||e)(p.Sb(Sa.a),p.Sb(p.h))},e.\u0275cmp=p.Mb({type:e,selectors:[["app-onboarding-overlay"]],inputs:{otherMembers:"otherMembers",project:"project",thread:"thread",hourlyContracts:"hourlyContracts"},outputs:{closeOverlay:"closeOverlay"},decls:1,vars:1,consts:function(){let e,t,i,n,a;return e="Onboarding progress",t=" Back ",i=" Next ",n=" Chat ",a=" Start Chatting ",[["class","OnboardingOverlay",4,"ngIf"],[1,"OnboardingOverlay"],[4,"ngIf","ngIfElse"],["spinner",""],["class","Footer","flTrackingSection","FullFlow",3,"flMarginBottom",4,"ngIf"],["class","Footer Footer--nonFullFlow","flTrackingSection","OneStepOnly",3,"flMarginBottom",4,"ngIf"],[3,"ngSwitch"],[3,"otherUser","project","thread",4,"ngSwitchCase"],[4,"ngSwitchCase"],[3,"otherUser",4,"ngSwitchCase"],[3,"hourlyContracts","project","otherUser",4,"ngSwitchCase"],[3,"otherUser","project","thread"],[3,"otherUser"],[3,"hourlyContracts","project","otherUser"],["flTrackingLabel","ChatboxUserLoadingSpinner"],["flTrackingSection","FullFlow",1,"Footer",3,"flMarginBottom"],[1,"LeftButton"],["flTrackingLabel","previousStep",3,"size","click",4,"ngIf"],["class","Progress","label",e,3,"progressPercentage",4,"ngIf"],[1,"RightButton"],["flTrackingLabel","nextStep",3,"size","click",4,"ngIf"],["flTrackingLabel","nextStep",3,"color","size","click",4,"ngIf"],["flTrackingLabel","previousStep",3,"size","click"],[3,"name","size"],[3,"fontType"],t,["label",e,1,"Progress",3,"progressPercentage"],["flTrackingLabel","nextStep",3,"size","click"],i,["flTrackingLabel","nextStep",3,"color","size","click"],n,["flTrackingSection","OneStepOnly",1,"Footer","Footer--nonFullFlow",3,"flMarginBottom"],["flTrackingLabel","dismissOneStep",3,"color","size","click"],a]},template:function(e,t){1&e&&p.ad(0,ja,8,8,"fl-bit",0),2&e&&p.zc("ngIf",t.steps&&void 0!==t.currentStep&&t.currentStep<t.steps.length)},directives:[n.q,ke.a,n.s,n.t,ha,Ma,ra,ma,Mi.c,_e.a,Ae.a,hi.a,me.b,fe.b,le.d,de.e,xa.a],pipes:[je.a],styles:[".OnboardingOverlay[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;padding:16px;position:absolute;width:100%;word-wrap:break-word}.OnboardingOverlay[_ngcontent-%COMP%]   .Footer[_ngcontent-%COMP%]{align-items:center;display:flex;margin-top:auto}.OnboardingOverlay[_ngcontent-%COMP%]   .Footer[_ngcontent-%COMP%]   .LeftButton[_ngcontent-%COMP%]{min-width:64px}.OnboardingOverlay[_ngcontent-%COMP%]   .Footer[_ngcontent-%COMP%]   .RightButton[_ngcontent-%COMP%]{min-width:64px;padding-left:4px}.OnboardingOverlay[_ngcontent-%COMP%]   .Footer[_ngcontent-%COMP%]   .Progress[_ngcontent-%COMP%]{margin-left:auto;margin-right:auto;width:72px}.OnboardingOverlay[_ngcontent-%COMP%]   .Footer--nonFullFlow[_ngcontent-%COMP%]{justify-content:center}.OnboardingOverlayTitle[_ngcontent-%COMP%]{padding-top:12px;text-align:center}.OnboardingOverlayBody[_ngcontent-%COMP%]{padding-top:24px;text-align:center}"],changeDetection:0}),e})();var Ra=i("LU0i"),Ba=i("h5VB"),$a=i("+qCR"),Ua=i("vwlU");function Ga(e,t){if(1&e){const e=p.Zb();p.Yb(0,"app-overlay-controls-item"),p.Yb(1,"fl-button",5),p.nc("click",function(){return p.Qc(e),p.rc().handleShowManagementView()}),p.cc(2,6),p.Xb(),p.Xb()}if(2&e){const e=p.rc();p.Gb(1),p.zc("color",e.ButtonColor.SECONDARY)}}let Na=(()=>{class e{constructor(){this.ButtonColor=fe.a,this.IconColor=le.c,this.IconSize=le.e,this.HoverColor=le.a,this.showManagementView=new p.n,this.closeView=new p.n,this.userRemoval=new p.n}handleCloseView(){this.closeView.emit()}handleShowManagementView(){this.showManagementView.emit()}handleRemove(e){this.userRemoval.emit(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=p.Mb({type:e,selectors:[["app-participants-view"]],inputs:{participants:"participants",onlineOfflineStatuses$:"onlineOfflineStatuses$",isThreadOwner:"isThreadOwner",candidatesExist:"candidatesExist",isRecruiter:"isRecruiter",currentUser:"currentUser",thread:"thread",team:"team",showAddPeopleOption:"showAddPeopleOption"},outputs:{showManagementView:"showManagementView",closeView:"closeView",userRemoval:"userRemoval"},decls:9,vars:10,consts:function(){let e,t,i;return e=" People in Chat ",t=" Back ",i=" Add People ",[e,[3,"participants","onlineOfflineStatuses$","currentUser","isRecruiter","isThreadOwner","candidatesExist","thread","team","userRemoval"],["display","block","flTrackingLabel","CloseParticipantsView",3,"color","click"],t,[4,"ngIf"],["display","block","flTrackingLabel","AddPeopleToGroupChat",3,"color","click"],i]},template:function(e,t){1&e&&(p.Yb(0,"app-overlay-header"),p.cc(1,0),p.Xb(),p.Yb(2,"app-overlay-content"),p.Yb(3,"app-participants-view-content",1),p.nc("userRemoval",function(e){return t.handleRemove(e)}),p.Xb(),p.Xb(),p.Yb(4,"app-overlay-controls"),p.Yb(5,"app-overlay-controls-item"),p.Yb(6,"fl-button",2),p.nc("click",function(){return t.handleCloseView()}),p.cc(7,3),p.Xb(),p.Xb(),p.ad(8,Ga,3,1,"app-overlay-controls-item",4),p.Xb()),2&e&&(p.Gb(3),p.zc("participants",t.participants)("onlineOfflineStatuses$",t.onlineOfflineStatuses$)("currentUser",t.currentUser)("isRecruiter",t.isRecruiter)("isThreadOwner",t.isThreadOwner)("candidatesExist",t.candidatesExist)("thread",t.thread)("team",t.team),p.Gb(3),p.zc("color",t.ButtonColor.DEFAULT),p.Gb(2),p.zc("ngIf",t.showAddPeopleOption))},directives:[Ra.a,Ba.a,_n,$a.a,Ua.a,fe.b,Ae.a,n.q],styles:["[_nghost-%COMP%]{display:flex;flex:1 1 100%;flex-direction:column}"],changeDetection:0}),e})(),Fa=(()=>{class e{constructor(){this.ButtonColor=fe.a,this.confirm=new p.n,this.cancel=new p.n}handleBackButton(){this.cancel.emit()}handleConfirmButton(){this.confirm.emit()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=p.Mb({type:e,selectors:[["app-confirm-user-removal-view"]],inputs:{user:"user"},outputs:{confirm:"confirm",cancel:"cancel"},decls:9,vars:3,consts:function(){let e,t,i;return e=" Are you sure you want to remove " + "\ufffd0\ufffd" + " from this chat? ",t=" Back ",i=" Remove ",[e,["display","block","flTrackingLabel","UserRemovalBackButton",3,"color","click"],t,["display","block","flTrackingLabel","UserRemovalConfirmButton",3,"color","click"],i]},template:function(e,t){1&e&&(p.Yb(0,"app-overlay-content"),p.cc(1,0),p.Xb(),p.Yb(2,"app-overlay-controls"),p.Yb(3,"app-overlay-controls-item"),p.Yb(4,"fl-button",1),p.nc("click",function(){return t.handleBackButton()}),p.cc(5,2),p.Xb(),p.Xb(),p.Yb(6,"app-overlay-controls-item"),p.Yb(7,"fl-button",3),p.nc("click",function(){return t.handleConfirmButton()}),p.cc(8,4),p.Xb(),p.Xb(),p.Xb()),2&e&&(p.Gb(1),p.gc(t.user.displayName),p.dc(1),p.Gb(3),p.zc("color",t.ButtonColor.DEFAULT),p.Gb(3),p.zc("color",t.ButtonColor.DANGER))},directives:[Ba.a,$a.a,Ua.a,fe.b,Ae.a],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%}"],changeDetection:0}),e})(),Da=(()=>{class e{constructor(){this.ButtonColor=fe.a,this.confirm=new p.n,this.cancel=new p.n}handleBackButton(){this.cancel.emit()}handleConfirmButton(){this.confirm.emit()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=p.Mb({type:e,selectors:[["app-confirm-user-leave-view"]],outputs:{confirm:"confirm",cancel:"cancel"},decls:9,vars:2,consts:function(){let e,t,i;return e=" Are you sure you want to leave this chat? ",t=" Back ",i=" Leave ",[e,["display","block","flTrackingLabel","UserLeaveBackButton",3,"color","click"],t,["display","block","flTrackingLabel","UserLeaveConfirmButton",3,"color","click"],i]},template:function(e,t){1&e&&(p.Yb(0,"app-overlay-content"),p.cc(1,0),p.Xb(),p.Yb(2,"app-overlay-controls"),p.Yb(3,"app-overlay-controls-item"),p.Yb(4,"fl-button",1),p.nc("click",function(){return t.handleBackButton()}),p.cc(5,2),p.Xb(),p.Xb(),p.Yb(6,"app-overlay-controls-item"),p.Yb(7,"fl-button",3),p.nc("click",function(){return t.handleConfirmButton()}),p.cc(8,4),p.Xb(),p.Xb(),p.Xb()),2&e&&(p.Gb(4),p.zc("color",t.ButtonColor.DEFAULT),p.Gb(3),p.zc("color",t.ButtonColor.DANGER))},directives:[Ba.a,$a.a,Ua.a,fe.b,Ae.a],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%}"],changeDetection:0}),e})();var Xa=i("Eg4/");function Ya(e,t){if(1&e){const e=p.Zb();p.Yb(0,"app-participants-view",5),p.nc("showManagementView",function(){return p.Qc(e),p.rc().setViewState("management")})("closeView",function(){return p.Qc(e),p.rc().handleCloseGroupchatOverlay()})("userRemoval",function(t){return p.Qc(e),p.rc().handleUserRemovalTrigger(t)}),p.Xb()}if(2&e){const e=p.rc();p.zc("participants",e.participants)("onlineOfflineStatuses$",e.onlineOfflineStatuses$)("currentUser",e.currentUser)("isThreadOwner",e.isThreadOwner)("isRecruiter",e.isRecruiter)("candidatesExist",e.candidatesExist)("thread",e.thread)("team",e.team)("showAddPeopleOption",e.showAddPeopleOption)}}function Ha(e,t){if(1&e){const e=p.Zb();p.Yb(0,"app-confirm-user-removal-view",6),p.nc("confirm",function(){return p.Qc(e),p.rc().handleUserRemovalConfirm()})("cancel",function(){return p.Qc(e),p.rc().handleUserRemovalCancel()}),p.Xb()}if(2&e){const e=p.rc();p.zc("user",e.userToRemove)}}function Va(e,t){if(1&e){const e=p.Zb();p.Yb(0,"app-confirm-user-leave-view",7),p.nc("confirm",function(){return p.Qc(e),p.rc().handleUserRemovalConfirm()})("cancel",function(){return p.Qc(e),p.rc().handleUserRemovalCancel()}),p.Xb()}}function Qa(e,t){if(1&e){const e=p.Zb();p.Yb(0,"app-management-view",8),p.nc("addUsers",function(t){return p.Qc(e),p.rc().handleManagementAddUsers(t)})("closeView",function(){return p.Qc(e),p.rc().setViewState("participant")}),p.Xb()}if(2&e){const e=p.rc();p.zc("candidateBidders",e.candidateBidders)("candidateContacts",e.candidateContacts)("candidateCollaborators",e.candidateCollaborators)("isRecruiter",e.isRecruiter)("thread",e.thread)("team",e.team)}}let Wa=(()=>{class e{constructor(){this.hideGroupchatOverlay=new p.n,this.modifyMembers=new p.n,this.currentViewState="participant"}setViewState(e){this.currentViewState=e}handleCloseGroupchatOverlay(){this.hideGroupchatOverlay.emit()}handleManagementAddUsers(e){this.modifyMembers.emit({action:"add",userIds:e}),this.hideGroupchatOverlay.emit()}handleUserRemovalTrigger(e){this.userToRemove=e,this.currentViewState=e.id===this.currentUser.id?"userLeave":"userRemoval"}handleUserRemovalConfirm(){this.userToRemove&&this.modifyMembers.emit({action:"remove",userIds:[this.userToRemove.id]}),this.userToRemove=void 0,this.currentViewState="participant"}handleUserRemovalCancel(){this.userToRemove=void 0,this.currentViewState="participant"}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=p.Mb({type:e,selectors:[["app-groupchat-overlay"]],inputs:{participants:"participants",currentUser:"currentUser",isThreadOwner:"isThreadOwner",isRecruiter:"isRecruiter",candidatesExist:"candidatesExist",candidateBidders:"candidateBidders",candidateContacts:"candidateContacts",candidateCollaborators:"candidateCollaborators",onlineOfflineStatuses$:"onlineOfflineStatuses$",thread:"thread",team:"team",showAddPeopleOption:"showAddPeopleOption"},outputs:{hideGroupchatOverlay:"hideGroupchatOverlay",modifyMembers:"modifyMembers"},decls:5,vars:5,consts:[[3,"ngSwitch"],[3,"participants","onlineOfflineStatuses$","currentUser","isThreadOwner","isRecruiter","candidatesExist","thread","team","showAddPeopleOption","showManagementView","closeView","userRemoval",4,"ngSwitchCase"],[3,"user","confirm","cancel",4,"ngSwitchCase"],[3,"confirm","cancel",4,"ngSwitchCase"],[3,"candidateBidders","candidateContacts","candidateCollaborators","isRecruiter","thread","team","addUsers","closeView",4,"ngSwitchCase"],[3,"participants","onlineOfflineStatuses$","currentUser","isThreadOwner","isRecruiter","candidatesExist","thread","team","showAddPeopleOption","showManagementView","closeView","userRemoval"],[3,"user","confirm","cancel"],[3,"confirm","cancel"],[3,"candidateBidders","candidateContacts","candidateCollaborators","isRecruiter","thread","team","addUsers","closeView"]],template:function(e,t){1&e&&(p.Wb(0,0),p.ad(1,Ya,1,9,"app-participants-view",1),p.ad(2,Ha,1,1,"app-confirm-user-removal-view",2),p.ad(3,Va,1,0,"app-confirm-user-leave-view",3),p.ad(4,Qa,1,6,"app-management-view",4),p.Vb()),2&e&&(p.zc("ngSwitch",t.currentViewState),p.Gb(1),p.zc("ngSwitchCase","participant"),p.Gb(1),p.zc("ngSwitchCase","userRemoval"),p.Gb(1),p.zc("ngSwitchCase","userLeave"),p.Gb(1),p.zc("ngSwitchCase","management"))},directives:[n.s,n.t,Na,Fa,Da,Xa.a],styles:["[_nghost-%COMP%]{background-color:#fff;display:flex;flex:1 1 100%;flex-direction:column;height:100%;padding:8px;width:100%}"],changeDetection:0}),e})();function qa(e,t){if(1&e){const e=p.Zb();p.Wb(0),p.Yb(1,"app-overlay-controls"),p.Yb(2,"app-overlay-controls-item"),p.Yb(3,"fl-button",3),p.nc("click",function(){return p.Qc(e),p.rc().handleCloseView()}),p.cc(4,4),p.Xb(),p.Xb(),p.Xb(),p.Vb()}if(2&e){const e=p.rc();p.Gb(3),p.zc("color",e.ButtonColor.DEFAULT)}}i("LaQp"),i("7Qkd"),i("DIEf");let Ka=(()=>{class e{constructor(){this.ButtonColor=fe.a,this.ButtonSize=be.a,this.showReportCta=!1,this.showControls=!0,this.hideSettingsOverlay=new p.n,this.archiveChatToggle=new p.n,this.muteChatToggle=new p.n,this.blockChatToggle=new p.n}handleCloseView(){this.hideSettingsOverlay.emit()}handleArchiveToggle(){this.archiveChatToggle.emit(!0)}handleMuteToggle(){this.muteChatToggle.emit(!0)}handleBlockToggle(){this.blockChatToggle.emit(!0)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=p.Mb({type:e,selectors:[["app-settings-overlay"]],inputs:{showReportCta:"showReportCta",thread:"thread",showControls:"showControls"},outputs:{hideSettingsOverlay:"hideSettingsOverlay",archiveChatToggle:"archiveChatToggle",muteChatToggle:"muteChatToggle",blockChatToggle:"blockChatToggle"},decls:5,vars:3,consts:function(){let e,t;return e=" Settings ",t=" Back ",[e,[3,"showReportCta","thread","archiveChatToggle","muteChatToggle","blockChatToggle"],[4,"ngIf"],["display","block","flTrackingLabel","CloseSettings",3,"color","click"],t]},template:function(e,t){1&e&&(p.Yb(0,"app-overlay-header"),p.cc(1,0),p.Xb(),p.Yb(2,"app-overlay-content"),p.Yb(3,"app-settings-overlay-content",1),p.nc("archiveChatToggle",function(){return t.handleArchiveToggle()})("muteChatToggle",function(){return t.handleMuteToggle()})("blockChatToggle",function(){return t.handleBlockToggle()}),p.Xb(),p.Xb(),p.ad(4,qa,5,1,"ng-container",2)),2&e&&(p.Gb(3),p.zc("showReportCta",t.showReportCta)("thread",t.thread),p.Gb(1),p.zc("ngIf",t.showControls))},directives:[Ra.a,Ba.a,Xn,n.q,$a.a,Ua.a,fe.b,Ae.a],styles:["[_nghost-%COMP%]{background-color:#fff;display:flex;flex:1 1 100%;flex-direction:column;height:100%;padding:8px;width:100%}.SettingButtons[_ngcontent-%COMP%], .SettingTitle[_ngcontent-%COMP%]{display:flex;flex-direction:column}.SettingTitle[_ngcontent-%COMP%]{justify-content:space-between}"],changeDetection:0}),e})();var Za=i("Uw4d"),Ja=i("cWjy");let es=(()=>{class e{constructor(e,t){this.element=e,this.focusService=t,this.MAX_HEIGHT=72,this.MIN_HEIGHT=32}onInput(e){this.adjust()}adjust(){const{nativeElement:e}=this.element;e.style.overflow="hidden",e.style.height="auto",e.style.overflowY="auto",e.style.height=`${Math.max(this.MIN_HEIGHT,Math.min(e.scrollHeight,this.MAX_HEIGHT))}px`,e.scrollHeight<this.MAX_HEIGHT&&(e.style.overflow="hidden")}focus(){this.focusService.focusElement(this.element)}}return e.\u0275fac=function(t){return new(t||e)(p.Sb(p.l),p.Sb(Ja.a))},e.\u0275dir=p.Nb({type:e,selectors:[["","appAutoGrow",""]],hostBindings:function(e,t){1&e&&p.nc("input",function(e){return t.onInput(e.target)})},exportAs:["autogrow"]}),e})();var ts=i("BFOf"),is=i("YFxV"),ns=i("nSbf"),as=i("tbJ/");const ss=["textarea"];function os(e,t){if(1&e){const e=p.Zb();p.Yb(0,"fl-file-select",6),p.nc("onFileDropped",function(t){return p.Qc(e),p.rc().onFileSelected(t)}),p.Xb()}if(2&e){const e=p.rc();p.zc("flMarginRight",e.isChatBoxMode?e.Margin.NONE:e.Margin.XXSMALL)("multiple",!0)("fileSelectMode",e.FileSelectMode.ICON)("active",!e.thread.isBlocked)}}function rs(e,t){if(1&e){const e=p.Zb();p.Yb(0,"fl-button",7),p.nc("mousedown",function(t){return p.Qc(e),p.rc().keepTextareaFocused(t)})("click",function(){return p.Qc(e),p.rc().handleSendMessage()}),p.cc(1,8),p.Xb()}if(2&e){const e=p.rc();p.zc("size",e.ButtonSize.SMALL)("color",e.ButtonColor.SECONDARY)("disabled",!e.textValue&&!e.hasAttachments)}}const cs=function(e){return{"TypingBox-inboxChatContainer":e}};let ls=(()=>{class e{constructor(e,t,i){this.changeDetectorRef=e,this.localStorage=t,this.timeUtils=i,this.ButtonColor=fe.a,this.ButtonSize=be.a,this.FileSelectMode=ts.b,this.Feature=ue.b,this.Margin=me.a,this.isChatBoxMode=!1,this.sendMessage=new p.n,this.typingEvent=new p.n,this.focusTypingBox=new p.n,this.addAttachment=new p.n,this.textValue=""}ngOnInit(){this.loadDraftMessage(this.threadIdentifierKey),this.timeUtils.setTimeout(()=>this.element.adjust(),0)}ngOnChanges(e){e.threadIdentifierKey&&this.loadDraftMessage(this.threadIdentifierKey)}keepTextareaFocused(e){e.preventDefault()}handleSendMessage(){this.sendMessage.emit(this.textValue),this.textValue="",this.typingEvent.emit(this.textValue),this.timeUtils.setTimeout(()=>this.element.adjust(),0)}handleKeyDownEvent(e){if((e.key&&"enter"===e.key.toLowerCase()||13===(e.which||e.keyCode||e.charCode))&&!e.shiftKey)return this.handleSendMessage(),!1}handleKeyUpEvent(e){this.typingEvent.emit(this.textValue)}focus(){this.element.focus()}handlePasteEvent(e){if(this.thread.isFake||!e.clipboardData)return;const{clipboardData:{items:t=[]}}=e;Array.from(t).some(e=>{if("file"===e.kind){const t=e.getAsFile();if(t){const i=e.type.split("/")[1],n=new File([t],`image.${i}`);this.addAttachment.emit(n)}return!0}return!1})}handleEmojiPicked(e){const t=this.element.element.nativeElement;if(this.textValue){if(t instanceof HTMLTextAreaElement){const i=t.selectionStart,n=t.selectionEnd,a=`${0===i||/\s/.test(this.textValue[i-1])?"":" "}${e}${n===this.textValue.length||/\s/.test(this.textValue[n])?"":" "}`;this.textValue=`${this.textValue.substring(0,i)}${a}${this.textValue.substring(n)}`,this.timeUtils.setTimeout(()=>{const e=i+a.length;t.setSelectionRange(e,e),this.element.adjust()})}}else this.textValue=e;this.typingEvent.emit(this.textValue)}onFileSelected(e){this.addAttachment.emit(e),this.focusTypingBox.emit(this.thread.id)}loadDraftMessage(e){this.localStorage.get("webappChatDraftMessages").pipe(Object(oa.a)(1)).toPromise().then((t={})=>{if(e){const i=t[e];this.textValue=i?i.text:""}this.changeDetectorRef.markForCheck()})}}return e.\u0275fac=function(t){return new(t||e)(p.Sb(p.h),p.Sb(Sa.a),p.Sb(is.a))},e.\u0275cmp=p.Mb({type:e,selectors:[["app-typing-box"]],viewQuery:function(e,t){if(1&e&&p.jd(ss,1),2&e){let e;p.Mc(e=p.oc())&&(t.element=e.first)}},inputs:{isChatBoxMode:"isChatBoxMode",hasAttachments:"hasAttachments",thread:"thread",threadIdentifierKey:"threadIdentifierKey"},outputs:{sendMessage:"sendMessage",typingEvent:"typingEvent",focusTypingBox:"focusTypingBox",addAttachment:"addAttachment"},features:[p.Eb],decls:6,vars:8,consts:function(){let e,t;return e="Enter your message...",t=" Send ",[[1,"TypingBox",3,"ngClass"],["appAutoGrow","","flTrackingLabel","TypingBox","placeholder",e,"rows","1","data-uitest-target","chatbox-input-field","maxlength","15000",1,"TextArea",3,"ngModel","ngModelChange","keydown","keyup","paste"],["textarea","autogrow"],[1,"TrayItem",3,"disabled","flMarginRight","mousedown","emojiPicked"],["class","TrayItem","flTrackingLabel","fileAttachment",3,"flMarginRight","multiple","fileSelectMode","active","onFileDropped",4,"flFeature"],["flTrackingLabel","SendMessageLink",3,"size","color","disabled","mousedown","click",4,"ngIf"],["flTrackingLabel","fileAttachment",1,"TrayItem",3,"flMarginRight","multiple","fileSelectMode","active","onFileDropped"],["flTrackingLabel","SendMessageLink",3,"size","color","disabled","mousedown","click"],t]},template:function(e,t){1&e&&(p.Yb(0,"fl-bit",0),p.Yb(1,"textarea",1,2),p.nc("ngModelChange",function(e){return t.textValue=e})("keydown",function(e){return t.handleKeyDownEvent(e)})("keyup",function(e){return t.handleKeyUpEvent(e)})("paste",function(e){return t.handlePasteEvent(e)}),p.Xb(),p.Yb(3,"fl-emoji-picker",3),p.nc("mousedown",function(e){return t.keepTextareaFocused(e)})("emojiPicked",function(e){return t.handleEmojiPicked(e)}),p.Xb(),p.ad(4,os,1,4,"fl-file-select",4),p.ad(5,rs,2,3,"fl-button",5),p.Xb()),2&e&&(p.zc("ngClass",p.Ec(6,cs,!t.isChatBoxMode)),p.Gb(1),p.zc("ngModel",t.textValue),p.Gb(2),p.zc("disabled",t.thread&&!t.thread.isFake&&"none"===t.thread.writePrivacy)("flMarginRight",t.isChatBoxMode?t.Margin.NONE:t.Margin.XXSMALL),p.Gb(1),p.zc("flFeature",t.Feature.FILEUPLOAD),p.Gb(1),p.zc("ngIf",!t.isChatBoxMode))},directives:[ke.a,n.o,a.c,es,Ae.a,a.k,a.o,a.r,ns.a,me.b,as.a,n.q,ts.a,fe.b],styles:[".TypingBox[_ngcontent-%COMP%]{padding-bottom:env(safe-area-inset-bottom);align-items:center;border-top:1px solid #dedede;display:flex;justify-content:space-between;width:100%}.TypingBox-inboxChatContainer[_ngcontent-%COMP%]{padding:8px}@supports (padding:max(0px)){.TypingBox-inboxChatContainer[_ngcontent-%COMP%]{padding-bottom:max(8px,env(safe-area-inset-bottom))}}.TextArea[_ngcontent-%COMP%]{font-size:14px;line-height:1.43;background-color:transparent;border:0;border-radius:0;display:block;height:36px;margin:0;overflow-y:auto;padding:8px;resize:none;width:100%}.TextArea[_ngcontent-%COMP%]:-ms-input-placeholder{color:#4d525b;font-weight:400}.TextArea[_ngcontent-%COMP%]::placeholder{color:#4d525b;font-weight:400}.TextArea[_ngcontent-%COMP%]:focus, .TextArea[_ngcontent-%COMP%]:hover{box-shadow:none;outline:none}.TrayItem[_ngcontent-%COMP%]{padding-right:4px}"],changeDetection:0}),e})();var ds=i("2zwU"),hs=i("7v0r"),gs=i("3bYl");let us=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=p.Qb({type:e}),e.\u0275inj=p.Pb({imports:[[a.j,n.c,ie.a,Za.a,te.a,ie.a,ae.b,s.a,ee.a,o.a,m,C.a,_,j.a,P.a,R.a,B.a,$.a,U.a,G.a,N.a,F.a,H,V.a,Q.a,W.a,q.a,K.a,Z.a,J.a,ne.a,oe.a,se.a]]}),e})();p.Uc(_t.a,[ke.a,hi.a,n.q,ei,yt,ze.a,ts.a,Ct,Mn,n.o,Lt,n.s,n.t,Pt,n.u,pe.b,Ae.a,ls,me.b,ds.b,hs.a,Pa,Wa,Ka,sa,gs.a],[je.a])},Z13H:function(e,t,i){"use strict";i.d(t,"a",function(){return g});var n=i("SVse"),a=i("oA5+"),s=i("iuNj"),o=i("cNBb"),r=i("EXHp"),c=i("18b0"),l=i("cokP"),d=i("ltMK"),h=i("8Y7J");let g=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=h.Qb({type:e}),e.\u0275inj=h.Pb({imports:[[n.c,a.a,s.a,o.a,r.a,c.a,l.a,d.MessagingAddPeopleModalModule]]}),e})()},ZotQ:function(e,t,i){"use strict";i.d(t,"a",function(){return n});var n=function(e){return e.ASSIGN="assign",e.REASSIGN="reassign",e.RESOLVE="resolve",e.AVAILABILITY="availability",e.ENQUEUE="enqueue",e.NO_AGENTS_AVAILABLE="no_agents_available",e}({})},a293:function(e,t,i){"use strict";i.d(t,"a",function(){return C}),i.d(t,"b",function(){return M});var n=i("8Y7J"),a=i("9Aot"),s=i("Rnop"),o=i("o9eT"),r=i("w13q"),c=i("SVse"),l=i("lDT0");function d(e,t){if(1&e){const e=n.Zb();n.ic(0,3,1),n.Yb(1,"fl-link",10),n.nc("click",function(t){return n.Qc(e),n.rc().handleRetry(t)}),n.Xb(),n.fc()}}function h(e,t){1&e&&n.cc(0,3,2)}function g(e,t){if(1&e&&(n.Yb(0,"fl-text",11),n.ic(1,12),n.Tb(2,"fl-link",13),n.fc(),n.Xb()),2&e){const e=n.rc();n.zc("color",e.FontColor.INHERIT),n.Gb(2),n.zc("link","/support")}}function u(e,t){if(1&e&&(n.Yb(0,"fl-text",11),n.ic(1,14),n.Tb(2,"fl-link",13),n.fc(),n.Xb()),2&e){const e=n.rc();n.zc("color",e.FontColor.INHERIT),n.Gb(2),n.zc("link","/support")}}function b(e,t){if(1&e&&(n.Yb(0,"fl-text",1),n.cc(1,15),n.Xb()),2&e){const e=n.rc();n.zc("color",e.FontColor.INHERIT)("flMarginRight",e.Margin.XXSMALL),n.Gb(1),n.gc(e.error.errorCode),n.dc(1)}}function f(e,t){if(1&e&&(n.Yb(0,"fl-text",11),n.cc(1,16),n.Xb()),2&e){const e=n.rc();n.zc("color",e.FontColor.INHERIT),n.Gb(1),n.gc(e.error.requestId),n.dc(1)}}const p=["*"],m=["UNKNOWN","UNKNOWN_ERROR"];var C=function(e){return e.LEFT="left",e.CENTER="center",e}({});let M=(()=>{class e{constructor(){this.FontColor=s.a,this.FontWeight=o.c,this.GenericErrorAlign=C,this.Margin=a.a,this.canRetry=!1,this.hasSetRetry=!1,this.hasGenericErrorCode=!1,this.align=C.LEFT,this.retry=new n.n}ngOnChanges(){this.canRetry="retry"in this.error,this.hasSetRetry=this.retry.observers.length>0,this.hasGenericErrorCode=m.includes(this.error.errorCode)}handleRetry(e){this.hasSetRetry?this.retry.emit(e):this.canRetry&&this.error.retry()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=n.Mb({type:e,selectors:[["fl-generic-error"]],inputs:{align:"align",error:"error"},outputs:{retry:"retry"},features:[n.Eb],ngContentSelectors:p,decls:15,vars:12,consts:function(){let e,t,i,n,a,s;return e=" Oops, something went wrong. " + "\ufffd#3\ufffd" + "" + "\ufffd/#3\ufffd" + "",t=" Please " + "\ufffd*6:1\ufffd\ufffd#1:1\ufffd" + " try again. " + "\ufffd/#1:1\ufffd\ufffd/*6:1\ufffd" + "" + "\ufffd*7:2\ufffd" + " try again. " + "\ufffd/*7:2\ufffd" + "",i=" If the problem persists, please contact " + "\ufffd#2\ufffd" + " support " + "\ufffd/#2\ufffd" + " with the following error information: ",n=" If the problem persists, please contact " + "\ufffd#2\ufffd" + " support. " + "\ufffd/#2\ufffd" + "",a=" Error Code: " + "\ufffd0\ufffd" + " ",s=" Request ID: " + "\ufffd0\ufffd" + " ",[[1,"SameLineContainer"],[3,"color","flMarginRight"],e,t,["flTrackingLabel","LinkToRetryGenericError",3,"click",4,"ngIf","ngIfElse"],["noRetry",""],[3,"color",4,"ngIf","ngIfElse"],["noErrorInfo",""],[3,"color","flMarginRight",4,"ngIf"],[3,"color",4,"ngIf"],["flTrackingLabel","LinkToRetryGenericError",3,"click"],[3,"color"],i,["flTrackingLabel","LinkToSupportGenericError",3,"link"],n,a,s]},template:function(e,t){if(1&e&&(n.yc(),n.Yb(0,"fl-bit",0),n.Yb(1,"fl-text",1),n.ic(2,2),n.xc(3),n.fc(),n.Xb(),n.Yb(4,"fl-text",1),n.ic(5,3),n.ad(6,d,2,0,"fl-link",4),n.ad(7,h,1,0,"ng-template",null,5,n.bd),n.fc(),n.Xb(),n.ad(9,g,3,2,"fl-text",6),n.ad(10,u,3,2,"ng-template",null,7,n.bd),n.Xb(),n.Yb(12,"fl-bit",0),n.ad(13,b,2,3,"fl-text",8),n.ad(14,f,2,2,"fl-text",9),n.Xb()),2&e){const e=n.Nc(8),i=n.Nc(11);n.Hb("data-align",t.align),n.Gb(1),n.zc("color",t.FontColor.INHERIT)("flMarginRight",t.Margin.XXXSMALL),n.Gb(3),n.zc("color",t.FontColor.INHERIT)("flMarginRight",t.Margin.XXXSMALL),n.Gb(2),n.zc("ngIf",t.canRetry||t.hasSetRetry)("ngIfElse",e),n.Gb(3),n.zc("ngIf",!t.hasGenericErrorCode||t.error.requestId)("ngIfElse",i),n.Gb(3),n.Hb("data-align",t.align),n.Gb(1),n.zc("ngIf",!t.hasGenericErrorCode),n.Gb(1),n.zc("ngIf",t.error.requestId)}},directives:[r.a,o.e,a.b,c.q,l.b],styles:[".SameLineContainer[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.SameLineContainer[data-align=center][_ngcontent-%COMP%]{justify-content:center;text-align:center}.SameLineContainer[data-align=left][_ngcontent-%COMP%]{justify-content:flex-start;text-align:left}"],changeDetection:0}),e})()},b6KT:function(e,t,i){"use strict";i.d(t,"h",function(){return d}),i.d(t,"e",function(){return h}),i.d(t,"b",function(){return g}),i.d(t,"f",function(){return u}),i.d(t,"g",function(){return b}),i.d(t,"a",function(){return f}),i.d(t,"d",function(){return p}),i.d(t,"c",function(){return m});var n=i("OpNG"),a=i("etQe"),s=i("fYbj"),o=i("f6cb"),r=i("tsv4"),c=i("lJxs"),l=i("pLZG");const d=(e,t)=>{if(void 0===e||void 0===t)return!1;if(e.id===t.id)return!0;const i=e.context.type!==r.ContextTypeApi.NONE&&t.context.type!==r.ContextTypeApi.NONE&&e.context.type===t.context.type&&e.context.id===t.context.id||e.context.type===r.ContextTypeApi.NONE&&t.context.type===r.ContextTypeApi.NONE,n=e.threadType===t.threadType,a=new Set(t.members),s=e.members.every(e=>a.has(e))&&e.members.length===t.members.length;return i&&n&&s};function h(e,t){return void 0!==e&&void 0!==t&&e.message===t.message&&e.messageId===t.messageId&&e.threadId===t.threadId&&e.timeCreated===t.timeCreated&&Object(s.h)(e.attachments,t.attachments)}function g(e,t="",i){const n=Date.now(),s={attachments:[],clientMessageId:n,fromUser:i,id:n,message:t,messageSource:r.SourceTypeApi.CHAT_BOX,threadId:e.id,timeCreated:Date.now(),sendStatus:a.a.SENDING};return Object.assign(Object.assign({},e),{message:s,isFake:!1})}function u(e){return!!(e&&e.supportStatus&&e.supportStatus.type)}function b(e,t){const i=e.reduce((e,i)=>i.context.type===t&&i.context.id?[...e,i.context.id.toString()]:e,[]);return Array.from(new Set(i))}function f(e){return{id:e.id,threadType:e.threadType,context:e.context,members:e.members,isFake:e.isFake}}function p(e){return Object(o.n)(e)||""}function m(e,t){return e.pipe(Object(c.a)(e=>{const{context:i,threadType:a}=t.threadIdentifier;if(i.type===r.ContextTypeApi.TEAM&&i.id&&e[i.id])return e[i.id];if(i.type===r.ContextTypeApi.PROJECT&&a===r.ThreadTypeApi.TEAM){const i=Object(n.i)(Object.values(e),e=>e.ownerUserId),a=Object.keys(i).find(e=>t.threadIdentifier.members.includes(Object(o.r)(e)));if(a)return i[Object(o.r)(a)]}}),Object(l.a)(o.g))}},cFvg:function(e,t,i){"use strict";function n(e,t){const i=t[e.session_id];if(void 0===i)throw new Error("Agent sessions should always have an associated session.");return Object.assign(Object.assign({},s(e)),function(e){return{sessionId:e.id,sessionType:e.support_type,sessionOwnerId:e.user_id,sessionCreateTime:1e3*e.create_time,sessionSourceType:e.source.type,sessionSourceId:e.source.id}}(i))}function a(e,t){return Object.assign(Object.assign({},t),s(e))}function s(e){return{id:e.id,type:e.support_type,state:e.state,latest:e.is_latest,createTime:1e3*e.create_time,resolvedTime:e.resolved_time?1e3*e.resolved_time:void 0,resolvedReason:e.resolved_reason||void 0,agentId:e.agent_id||void 0,starred:e.is_starred?e.is_starred:void 0}}i.d(t,"b",function(){return n}),i.d(t,"a",function(){return a})},g6qU:function(e,t,i){"use strict";i.d(t,"a",function(){return I});var n=i("B23V"),a=i("dO68"),s=i("4ykm"),o=i("cs8y"),r=i("ueDg"),c=i("MmDv"),l=i("8Y7J"),d=i("eCtd"),h=i("3A0Z"),g=i("iInd"),u=i("565b"),b=i("DSso"),f=i("SVse");function p(e,t){1&e&&(l.Wb(0),l.cc(1,2),l.Vb())}function m(e,t){1&e&&(l.Wb(0),l.cc(1,3),l.Vb())}function C(e,t){1&e&&(l.Wb(0),l.cc(1,4),l.Vb())}function M(e,t){1&e&&(l.Wb(0),l.cc(1,5),l.Vb())}function S(e,t){1&e&&(l.Wb(0),l.cc(1,6),l.Vb())}function x(e,t){1&e&&(l.Wb(0),l.cc(1,7),l.Vb())}function y(e,t){1&e&&(l.Wb(0),l.cc(1,8),l.Vb())}function T(e,t){1&e&&(l.Wb(0),l.cc(1,9),l.Vb())}let I=(()=>{class e{constructor(e,t,i,s){this.changeDetectorRef=e,this.datastore=t,this.modalService=i,this.router=s,this.ButtonColor=n.a,this.ButtonSize=a.a,this.NON_CTA_CONTEXT_BOX_STATE_NAME=c.a,this.buttonBusy=!1,this.buttonColor=n.a.SECONDARY,this.greenButtonStates=["projectAcceptHourly","projectAcceptFixed","projectAcceptRedirect","projectAwardHourly","projectAwardFixed"]}ngOnChanges(e){var t,i,a;if(e.contextBoxState&&this.contextBoxState)if(this.buttonColor=this.greenButtonStates.includes(this.contextBoxState.name)?n.a.SUCCESS:n.a.SECONDARY,null===(t=this.contextBoxState)||void 0===t?void 0:t.button)switch(this.contextBoxState.button.data.type){case"LINK":this.contextButtonUrl=this.contextBoxState.button.data.buttonUrl,this.contextButtonUrlQueryParams=null===(i=this.contextBoxState.button.data.buttonExtras)||void 0===i?void 0:i.queryParams,this.contextButtonUrlFragment=null===(a=this.contextBoxState.button.data.buttonExtras)||void 0===a?void 0:a.fragment;break;case"REQUEST_MILESTONE":this.contextButtonUrl=`/projects/${this.contextBoxState.button.data.projectId}/payments`,this.contextButtonUrlQueryParams={request_milestone:1},this.contextButtonUrlFragment=void 0;break;default:this.contextButtonUrl=void 0,this.contextButtonUrlQueryParams=void 0,this.contextButtonUrlFragment=void 0}else this.contextButtonUrl=void 0,this.contextButtonUrlQueryParams=void 0,this.contextButtonUrlFragment=void 0}handleButtonClick(){var e,t;if(this.contextBoxState&&this.contextBoxState.name&&"LINK"!==(null===(e=this.contextBoxState.button)||void 0===e?void 0:e.data.type)&&"REQUEST_MILESTONE"!==(null===(t=this.contextBoxState.button)||void 0===t?void 0:t.data.type))switch(this.contextBoxState.name){case"projectAcceptHourly":case"projectAcceptFixed":this.accept();break;case"projectAwardFixed":this.awardFixed();break;case"milestoneCreate":case"milestoneCreateInitial":case"milestoneCreateFromRequest":this.createMilestone();break;default:console.warn("Unknown context box state button clicked")}}goToUrl(e,t){t?this.router.navigate([e],t):this.router.navigate([e])}awardFixed(){if(this.contextBoxState&&this.contextBoxState.button&&"AWARD_FIXED"===this.contextBoxState.button.data.type){const{bidId:e,projectId:t}=this.contextBoxState.button.data;this.buttonBusy=!0;const i=this.modalService.open("AwardModal",{inputs:{bidId:e,projectId:t},size:s.a.LARGE,edgeToEdge:!0,mobileFullscreen:!0});i.afterOpen().toPromise().then(e=>{this.buttonBusy=!1,this.changeDetectorRef.markForCheck()}),i.afterClosed().toPromise().then(e=>{e&&this.goToUrl(`/projects/${t}.html`,{fragment:"/management"})})}}createMilestone(){if(this.contextBoxState&&this.contextBoxState.button&&"CREATE_MILESTONE"===this.contextBoxState.button.data.type&&"hireme"!==this.contextBoxState.name){this.buttonBusy=!0;const{bidderId:e,bidId:t,projectId:i,currencyDetails:n}=this.contextBoxState.button.data;this.modalService.open("MilestoneCreateModal",{inputs:{bidId:t,projectId:i,currencyDetails:n,username:this.contextBoxState.otherUserName,bidderId:e},size:s.a.SMALL}).afterOpen().toPromise().then(()=>{this.changeDetectorRef.markForCheck(),this.buttonBusy=!1})}}accept(){if(this.contextBoxState&&this.contextBoxState.button&&"ACCEPT"===this.contextBoxState.button.data.type){this.buttonBusy=!0;const{projectId:e}=this.contextBoxState.button.data;this.datastore.collection("bids",t=>t.where("projectId","==",e)).update(this.contextBoxState.button.data.bidId,{awardStatus:r.BidAwardStatusApi.AWARDED}).then(t=>{this.buttonBusy=!1,this.changeDetectorRef.markForCheck(),"error"!==t.status||t.errorCode!==o.ErrorCodeApi.ESCROWCOM_ACCOUNT_UNLINKED&&t.errorCode!==o.ErrorCodeApi.PROFILE_INCOMPLETE&&t.errorCode!==o.ErrorCodeApi.NDA_NOT_SIGNED||this.goToUrl(`/projects/${e}`)})}}}return e.\u0275fac=function(t){return new(t||e)(l.Sb(l.h),l.Sb(d.a),l.Sb(h.b),l.Sb(g.e))},e.\u0275cmp=l.Mb({type:e,selectors:[["app-messaging-context-button"]],inputs:{contextBoxState:"contextBoxState"},features:[l.Eb],decls:9,vars:15,consts:function(){let e,t,i,n,a,s,o,r;return e=" Award ",t=" Setup Billing ",i=" Create Milestone ",n=" Pay Now ",a=" Hire Me ",s=" Accept ",o=" Track Time ",r=" Request Milestone ",[[3,"flTrackingLabel","busy","color","fragment","link","queryParams","size","click"],[4,"ngIf"],e,t,i,n,a,s,o,r]},template:function(e,t){1&e&&(l.Yb(0,"fl-button",0),l.nc("click",function(){return t.handleButtonClick()}),l.ad(1,p,2,0,"ng-container",1),l.ad(2,m,2,0,"ng-container",1),l.ad(3,C,2,0,"ng-container",1),l.ad(4,M,2,0,"ng-container",1),l.ad(5,S,2,0,"ng-container",1),l.ad(6,x,2,0,"ng-container",1),l.ad(7,y,2,0,"ng-container",1),l.ad(8,T,2,0,"ng-container",1),l.Xb()),2&e&&(l.Bc("flTrackingLabel","ChatboxContextButton-",null==t.contextBoxState?null:t.contextBoxState.name,""),l.zc("busy",t.buttonBusy)("color",t.buttonColor)("fragment",t.contextButtonUrlFragment)("link",t.contextButtonUrl)("queryParams",t.contextButtonUrlQueryParams)("size",t.ButtonSize.SMALL),l.Gb(1),l.zc("ngIf","projectAwardHourly"===(null==t.contextBoxState?null:t.contextBoxState.name)||"projectAwardFixed"===(null==t.contextBoxState?null:t.contextBoxState.name)),l.Gb(1),l.zc("ngIf","setupBilling"===(null==t.contextBoxState?null:t.contextBoxState.name)),l.Gb(1),l.zc("ngIf","milestoneCreate"===(null==t.contextBoxState?null:t.contextBoxState.name)||"milestoneCreateFromRequest"===(null==t.contextBoxState?null:t.contextBoxState.name)||"milestoneCreateInitial"===(null==t.contextBoxState?null:t.contextBoxState.name)||"milestoneCreateRedirect"===(null==t.contextBoxState?null:t.contextBoxState.name)),l.Gb(1),l.zc("ngIf","payFailedInvoices"===(null==t.contextBoxState?null:t.contextBoxState.name)),l.Gb(1),l.zc("ngIf","hireme"===(null==t.contextBoxState?null:t.contextBoxState.name)),l.Gb(1),l.zc("ngIf","projectAcceptHourly"===(null==t.contextBoxState?null:t.contextBoxState.name)||"projectAcceptFixed"===(null==t.contextBoxState?null:t.contextBoxState.name)||"projectAcceptRedirect"===(null==t.contextBoxState?null:t.contextBoxState.name)),l.Gb(1),l.zc("ngIf","trackTime"===(null==t.contextBoxState?null:t.contextBoxState.name)),l.Gb(1),l.zc("ngIf","requestMilestone"===(null==t.contextBoxState?null:t.contextBoxState.name)||"requestMilestoneRedirect"===(null==t.contextBoxState?null:t.contextBoxState.name)))},directives:[n.b,u.a,b.a,f.q],encapsulation:2,changeDetection:0}),e})()},gJiX:function(e,t,i){"use strict";i.d(t,"a",function(){return u});var n=i("SVse"),a=i("s7LF"),s=i("oA5+"),o=i("EXHp"),r=i("18b0"),c=i("cokP"),l=i("iAS6"),d=i("Z13H"),h=i("8Y7J");let g=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=h.Qb({type:e}),e.\u0275inj=h.Pb({imports:[[n.c,a.j,o.a,r.a,c.a,d.a,l.a]]}),e})(),u=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=h.Qb({type:e}),e.\u0275inj=h.Pb({imports:[[n.c,s.a,a.j,o.a,r.a,c.a,l.a,g]]}),e})()},gKBM:function(e,t,i){"use strict";i.d(t,"a",function(){return h});var n=i("9u4R"),a=i("tqRt"),s=i("sGoS"),o=i("cUs2"),r=i("ZotQ"),c=i("cFvg");function l(e={},t){switch(t.type){case"API_FETCH_SUCCESS":if("agentSessions"===t.payload.type){const{result:i,ref:n,order:a}=t.payload;return i.agent_sessions&&i.sessions?Object(o.o)(e,Object(o.z)(i.agent_sessions,c.b,i.sessions),a,n):e}return e;case"API_UPDATE_SUCCESS":if("agentSessions"===t.payload.type){const{originalDocument:i,result:n,ref:a}=t.payload;return Object(o.q)(e,Object(o.z)([n.agent_session],c.a,i),a)}return e;case"WS_MESSAGE":{const{payload:i}=t;if("supportQueueEvent"===i.type)switch(i.data.queueEventType){case r.a.ENQUEUE:case r.a.REASSIGN:return Object(o.b)(e,i.data.agent_sessions,c.b,{path:{collection:"agentSessions",authUid:i.toUserId}},i.data.sessions);default:return e}if("supportAgentSession"===i.type)switch(i.data.type){case"created":case"assigned":case"resolved":case"starred":return Object(o.b)(e,[i.data.agentSession],c.b,{path:{collection:"agentSessions",authUid:i.toUserId}},{[i.data.session.id]:i.data.session});default:return e}return e}default:return e}}var d=i("8Y7J");let h=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=d.Qb({type:e}),e.\u0275inj=d.Pb({imports:[[a.j.forFeature("agentSessions",l),n.d.forFeature("agentSessions",s.a)]]}),e})()},iAS6:function(e,t,i){"use strict";i.d(t,"a",function(){return lt});var n=i("SVse"),a=i("s7LF"),s=i("oA5+"),o=i("EXHp"),r=i("18b0"),c=i("cokP"),l=i("yotz"),d=i("ltMK"),h=i("8Y7J"),g=i("KtYJ"),u=i("HLWz"),b=i("/zj7"),f=i("KUXl"),p=i("HsDr"),m=i("9Aot"),C=i("Rnop"),M=i("o9eT"),S=i("2Gc0"),x=i("DSso"),y=i("w13q"),T=i("J301");function I(e,t){if(1&e&&(h.Yb(0,"fl-bit"),h.Yb(1,"fl-text",7),h.cc(2,8),h.Xb(),h.Yb(3,"fl-progress-bar",9),h.ec(4,10),h.Xb(),h.Xb()),2&e){const e=h.rc();h.Gb(1),h.zc("size",e.TextSize.XXXSMALL)("color",e.FontColor.INHERIT),h.Gb(2),h.gc(e.attachment.name),h.dc(4),h.zc("progressPercentage",e.uploadPercentage)}}function O(e,t){if(1&e&&(h.Yb(0,"fl-text",11),h.cc(1,12),h.Xb()),2&e){const e=h.rc();h.zc("size",e.TextSize.XXXSMALL)("color",e.FontColor.ERROR)}}function v(e,t){if(1&e&&h.Tb(0,"fl-icon",13),2&e){const e=h.rc();h.zc("color",e.IconColor.MID)("name","ui-tick")("size",e.IconSize.SMALL)}}function A(e,t){if(1&e&&(h.Yb(0,"fl-text",11),h.cc(1,14),h.Xb()),2&e){const e=h.rc();h.zc("size",e.TextSize.XXXSMALL)("color",e.FontColor.MID)}}function w(e,t){if(1&e){const e=h.Zb();h.Yb(0,"fl-icon",15),h.nc("click",function(){return h.Qc(e),h.rc().retryUpload.emit()}),h.Xb()}if(2&e){const e=h.rc();h.zc("clickable",!0)("name","ui-refresh")("size",e.IconSize.SMALL)}}let k=(()=>{class e{constructor(){this.FontColor=C.a,this.IconColor=p.c,this.IconSize=p.e,this.Margin=m.a,this.TextSize=M.f,this.retryUpload=new h.n,this.successfulUpload=new h.n}ngOnChanges(e){var t,i;"success"===(null===(i=null===(t=e.uploadTaskEvent)||void 0===t?void 0:t.currentValue)||void 0===i?void 0:i.state)&&this.successfulUpload.emit()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=h.Mb({type:e,selectors:[["app-messaging-attachment-list-item"]],inputs:{attachment:"attachment",uploadPercentage:"uploadPercentage",uploadTaskEvent:"uploadTaskEvent",previewUrl:"previewUrl"},outputs:{retryUpload:"retryUpload",successfulUpload:"successfulUpload"},features:[h.Eb],decls:9,vars:9,consts:function(){let e,t,i,n,a,s,o;return e="Attachment preview",t="File uploaded",i="Retry",n=" Uploading... ",a="" + "\ufffd0\ufffd" + " upload",s=" The upload failed. Please try again. ",o=" Attached ",[["flTrackingLabel","ChangeAttachmentDetails","alt",e,3,"flMarginRight","src"],[1,"Details",3,"flMarginRight"],[1,"Title"],[4,"ngIf"],[3,"size","color",4,"ngIf"],["label",t,3,"color","name","size",4,"ngIf"],["label",i,"flTrackingLabel","RetryIcon",3,"clickable","name","size","click",4,"ngIf"],[1,"UploadingState",3,"size","color"],n,[3,"progressPercentage",6,"label"],["label",a],[3,"size","color"],s,["label",t,3,"color","name","size"],o,["label",i,"flTrackingLabel","RetryIcon",3,"clickable","name","size","click"]]},template:function(e,t){1&e&&(h.Tb(0,"fl-file-display",0),h.Yb(1,"fl-bit",1),h.Yb(2,"fl-text",2),h.cd(3),h.Xb(),h.ad(4,I,5,4,"fl-bit",3),h.ad(5,O,2,2,"fl-text",4),h.ad(6,v,1,3,"fl-icon",5),h.ad(7,A,2,2,"fl-text",4),h.Xb(),h.ad(8,w,1,3,"fl-icon",6)),2&e&&(h.zc("flMarginRight",t.Margin.XXSMALL)("src",t.previewUrl),h.Gb(1),h.zc("flMarginRight",t.Margin.XXSMALL),h.Gb(2),h.ed(" ",t.attachment.name," "),h.Gb(1),h.zc("ngIf","running"===(null==t.uploadTaskEvent?null:t.uploadTaskEvent.state)),h.Gb(1),h.zc("ngIf","error"===(null==t.uploadTaskEvent?null:t.uploadTaskEvent.state)),h.Gb(1),h.zc("ngIf","success"===(null==t.uploadTaskEvent?null:t.uploadTaskEvent.state)),h.Gb(1),h.zc("ngIf",!t.uploadTaskEvent),h.Gb(1),h.zc("ngIf","error"===(null==t.uploadTaskEvent?null:t.uploadTaskEvent.state)))},directives:[S.a,x.a,m.b,y.a,M.e,n.q,T.a,p.d],styles:["[_nghost-%COMP%]{align-items:center;display:flex}.Details[_ngcontent-%COMP%]{flex:1}.Title[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width:239px}.UploadingState[_ngcontent-%COMP%]{color:#139ff0}"],changeDetection:0}),e})();var z=i("al+g");function E(e,t){if(1&e){const e=h.Zb();h.Yb(0,"fl-list-item",2),h.nc("dismiss",function(){h.Qc(e);const i=t.$implicit;return h.rc().removeAttachment.emit(i.key)}),h.Yb(1,"app-messaging-attachment-list-item",3),h.nc("retryUpload",function(){h.Qc(e);const i=t.$implicit;return h.rc().retryUpload.emit(i.key)})("successfulUpload",function(){h.Qc(e);const i=t.$implicit;return h.rc().successfulUpload.emit(i.key)}),h.sc(2,"flAsync"),h.sc(3,"flAsync"),h.sc(4,"flAsync"),h.Xb(),h.Xb()}if(2&e){const e=t.$implicit;h.Gb(1),h.zc("attachment",e.value.file)("uploadPercentage",h.tc(2,4,e.value.uploadPercentage$))("uploadTaskEvent",h.tc(3,6,e.value.uploadTaskEvent$))("previewUrl",h.tc(4,8,e.value.previewUrl$))}}let L=(()=>{class e{constructor(){this.ListItemPadding=g.e,this.ListItemType=g.f,this.removeAttachment=new h.n,this.successfulUpload=new h.n,this.retryUpload=new h.n}identifyUpload(e,t){return t.key}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=h.Mb({type:e,selectors:[["app-messaging-attachment-list"]],inputs:{fileAttachmentMap:"fileAttachmentMap"},outputs:{removeAttachment:"removeAttachment",successfulUpload:"successfulUpload",retryUpload:"retryUpload"},decls:4,vars:7,consts:[["flTrackingSection","MessagingAttachmentList",3,"padding","bodyEdgeToEdge","type"],[3,"dismiss",4,"ngFor","ngForOf","ngForTrackBy"],[3,"dismiss"],[3,"attachment","uploadPercentage","uploadTaskEvent","previewUrl","retryUpload","successfulUpload"]],template:function(e,t){1&e&&(h.Yb(0,"fl-scrollable-content"),h.Yb(1,"fl-list",0),h.ad(2,E,5,10,"fl-list-item",1),h.sc(3,"keyvalue"),h.Xb(),h.Xb()),2&e&&(h.Gb(1),h.zc("padding",t.ListItemPadding.XXSMALL)("bodyEdgeToEdge",!0)("type",t.ListItemType.DISMISS),h.Gb(1),h.zc("ngForOf",h.tc(3,5,t.fileAttachmentMap))("ngForTrackBy",t.identifyUpload))},directives:[u.a,b.a,f.a,n.p,g.b,k],pipes:[n.j,z.a],styles:["[_nghost-%COMP%]{display:block;max-height:128px;overflow-x:hidden;overflow-y:auto}"],changeDetection:0}),e})();var _=i("mrSG"),j=i("B23V"),P=i("dO68"),R=i("IzEk"),B=i("L1P6"),$=i("Krui");function U(e,t){if(1&e&&(h.Yb(0,"fl-text",5),h.cc(1,6),h.Xb()),2&e){const e=h.rc();h.zc("flMarginBottom",e.Margin.XSMALL)("maxLines",3)("maxHeight",e.TextSize.INHERIT)("size",e.TextSize.MID)("textAlign",e.TextAlign.CENTER),h.Gb(1),h.gc(e.otherUser.displayName)(e.project.title),h.dc(1)}}function G(e,t){if(1&e&&(h.Yb(0,"fl-text",5),h.cc(1,7),h.Xb()),2&e){const e=h.rc();h.zc("flMarginBottom",e.Margin.XSMALL)("maxLines",3)("maxHeight",e.TextSize.INHERIT)("size",e.TextSize.MID)("textAlign",e.TextAlign.CENTER),h.Gb(1),h.gc(e.otherUser.displayName)(e.project.title),h.dc(1)}}let N=(()=>{class e{constructor(){this.Margin=m.a,this.TextAlign=M.d,this.TextSize=M.f}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=h.Mb({type:e,selectors:[["app-messaging-chat-onboarding-intro"]],inputs:{thread:"thread",otherUser:"otherUser",project:"project"},decls:6,vars:7,consts:function(){let e,t,i,n;return e="Messaging onboarding introduction image",t=" Click 'Next' to see a few tips on how to make sure you and " + "\ufffd0\ufffd" + " have a great experience working together. ",i=" " + "\ufffd0\ufffd" + " would like to chat to you about " + "\ufffd1\ufffd" + " ",n=" You are about to start chatting to " + "\ufffd0\ufffd" + " about " + "\ufffd1\ufffd" + " ",[["alt",e,1,"MessagingOnboarding-image",3,"flMarginBottom","src","boundedWidth"],[3,"flMarginBottom","maxLines","maxHeight","size","textAlign",4,"ngIf","ngIfElse"],["noThread",""],[3,"textAlign"],t,[3,"flMarginBottom","maxLines","maxHeight","size","textAlign"],i,n]},template:function(e,t){if(1&e&&(h.Tb(0,"fl-picture",0),h.ad(1,U,2,7,"fl-text",1),h.ad(2,G,2,7,"ng-template",null,2,h.bd),h.Yb(4,"fl-text",3),h.cc(5,4),h.Xb()),2&e){const e=h.Nc(3);h.zc("flMarginBottom",t.Margin.MID)("src","messaging/ui-live-chat-v2.svg")("boundedWidth",!0),h.Gb(1),h.zc("ngIf",t.thread)("ngIfElse",e),h.Gb(3),h.zc("textAlign",t.TextAlign.CENTER),h.Gb(1),h.gc(t.otherUser.displayName),h.dc(5)}},directives:[$.a,m.b,n.q,M.e],styles:["[_nghost-%COMP%]{display:flex;flex:1 0;flex-direction:column;height:calc(100% - 56px)}.MessagingOnboarding-image[_ngcontent-%COMP%]{max-width:75px}.MessagingOnboarding-body[_ngcontent-%COMP%]{align-items:center;display:flex;flex-direction:column;height:100%;justify-content:center;overflow:auto;padding:24px 12px 0}.MessagingOnboarding-footer[_ngcontent-%COMP%]{flex:0 0 auto}.MessagingOnboarding-footer-content[_ngcontent-%COMP%]{align-items:center;display:flex;padding:24px}.IsHidden[_ngcontent-%COMP%]{visibility:hidden}"],changeDetection:0}),e})();var F=i("4BSF");let D=(()=>{class e{constructor(e){this.siteName=e,this.Margin=m.a,this.TextAlign=M.d,this.TextSize=M.f}}return e.\u0275fac=function(t){return new(t||e)(h.Sb(F.e))},e.\u0275cmp=h.Mb({type:e,selectors:[["app-messaging-chat-onboarding-offsite"]],decls:5,vars:10,consts:function(){let e,t,i;return e="Messaging onboarding offsite screen image",t=" Always communicate and make payments through " + "\ufffd0\ufffd" + " ",i=" Stay protected from scams and ensure you get paid by only communicating using the " + "[\ufffd0\ufffd|\ufffd1\ufffd]" + " chat system. Never make payments outside " + "[\ufffd0\ufffd|\ufffd1\ufffd]" + ". ",i=h.hc(i),[["alt",e,1,"MessagingOnboarding-image",3,"flMarginBottom","src","boundedWidth"],[3,"size","flMarginBottom","textAlign"],t,[3,"textAlign"],i]},template:function(e,t){1&e&&(h.Tb(0,"fl-picture",0),h.Yb(1,"fl-text",1),h.cc(2,2),h.Xb(),h.Yb(3,"fl-text",3),h.cc(4,4),h.Xb()),2&e&&(h.zc("flMarginBottom",t.Margin.MID)("src","messaging/ui-payment-chat.svg")("boundedWidth",!0),h.Gb(1),h.zc("size",t.TextSize.MID)("flMarginBottom",t.Margin.XSMALL)("textAlign",t.TextAlign.CENTER),h.Gb(1),h.gc(t.siteName),h.dc(2),h.Gb(1),h.zc("textAlign",t.TextAlign.CENTER),h.Gb(1),h.gc(t.siteName)(t.siteName),h.dc(4))},directives:[$.a,m.b,M.e],styles:["[_nghost-%COMP%]{display:flex;flex:1 0;flex-direction:column;height:calc(100% - 56px)}.MessagingOnboarding-image[_ngcontent-%COMP%]{max-width:75px}.MessagingOnboarding-body[_ngcontent-%COMP%]{align-items:center;display:flex;flex-direction:column;height:100%;justify-content:center;overflow:auto;padding:24px 12px 0}.MessagingOnboarding-footer[_ngcontent-%COMP%]{flex:0 0 auto}.MessagingOnboarding-footer-content[_ngcontent-%COMP%]{align-items:center;display:flex;padding:24px}.IsHidden[_ngcontent-%COMP%]{visibility:hidden}"],changeDetection:0}),e})(),X=(()=>{class e{constructor(){this.Margin=m.a,this.TextAlign=M.d,this.TextSize=M.f}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=h.Mb({type:e,selectors:[["app-messaging-chat-onboarding-discuss"]],inputs:{otherUser:"otherUser"},decls:5,vars:8,consts:function(){let e,t,i;return e="Messaging onboarding discuss screen image",t=" Don't forget to discuss goals and deadlines ",i=" Make sure you and " + "\ufffd0\ufffd" + " agree on exactly what the tasks to be completed are, and when each of them is due. ",[["alt",e,1,"MessagingOnboarding-image",3,"flMarginBottom","src","boundedWidth"],[3,"flMarginBottom","size","textAlign"],t,[3,"textAlign"],i]},template:function(e,t){1&e&&(h.Tb(0,"fl-picture",0),h.Yb(1,"fl-text",1),h.cc(2,2),h.Xb(),h.Yb(3,"fl-text",3),h.cc(4,4),h.Xb()),2&e&&(h.zc("flMarginBottom",t.Margin.MID)("src","messaging/ui-goals-and-deadlines.svg")("boundedWidth",!0),h.Gb(1),h.zc("flMarginBottom",t.Margin.XSMALL)("size",t.TextSize.MID)("textAlign",t.TextAlign.CENTER),h.Gb(2),h.zc("textAlign",t.TextAlign.CENTER),h.Gb(1),h.gc(t.otherUser.displayName),h.dc(4))},directives:[$.a,m.b,M.e],styles:["[_nghost-%COMP%]{display:flex;flex:1 0;flex-direction:column;height:calc(100% - 56px)}.MessagingOnboarding-image[_ngcontent-%COMP%]{max-width:75px}.MessagingOnboarding-body[_ngcontent-%COMP%]{align-items:center;display:flex;flex-direction:column;height:100%;justify-content:center;overflow:auto;padding:24px 12px 0}.MessagingOnboarding-footer[_ngcontent-%COMP%]{flex:0 0 auto}.MessagingOnboarding-footer-content[_ngcontent-%COMP%]{align-items:center;display:flex;padding:24px}.IsHidden[_ngcontent-%COMP%]{visibility:hidden}"],changeDetection:0}),e})();var Y=i("lDT0");function H(e,t){if(1&e&&(h.Wb(0),h.Yb(1,"fl-text",4),h.cc(2,5),h.Xb(),h.Yb(3,"fl-text",6),h.cc(4,7),h.Xb(),h.Vb()),2&e){const e=h.rc(2);h.Gb(1),h.zc("flMarginBottom",e.Margin.XSMALL)("size",e.TextSize.MID)("textAlign",e.TextAlign.CENTER),h.Gb(2),h.zc("textAlign",e.TextAlign.CENTER),h.Gb(1),h.gc(e.otherUser.displayName),h.dc(4)}}function V(e,t){if(1&e&&(h.Yb(0,"fl-text",4),h.cc(1,8),h.Xb(),h.Yb(2,"fl-text",6),h.ic(3,9),h.Tb(4,"fl-link",10),h.fc(),h.Xb()),2&e){const e=h.rc(2);h.zc("flMarginBottom",e.Margin.XSMALL)("size",e.TextSize.MID)("textAlign",e.TextAlign.CENTER),h.Gb(2),h.zc("textAlign",e.TextAlign.CENTER),h.Gb(2),h.zc("link",e.MOBILE_APP_DOWNLOAD_LINK),h.gc(e.otherUser.displayName),h.dc(3)}}function Q(e,t){if(1&e&&(h.Wb(0),h.ad(1,H,5,5,"ng-container",1),h.ad(2,V,5,6,"ng-template",null,3,h.bd),h.Vb()),2&e){const e=h.Nc(3),t=h.rc();h.Gb(1),h.zc("ngIf",!t.project.local)("ngIfElse",e)}}function W(e,t){if(1&e&&(h.Yb(0,"fl-text",4),h.cc(1,11),h.Xb(),h.Yb(2,"fl-text",6),h.cc(3,12),h.Xb()),2&e){const e=h.rc();h.zc("flMarginBottom",e.Margin.XSMALL)("size",e.TextSize.MID)("textAlign",e.TextAlign.CENTER),h.Gb(2),h.zc("textAlign",e.TextAlign.CENTER),h.Gb(1),h.gc(e.otherUser.displayName),h.dc(3)}}let q=(()=>{class e{constructor(){this.Margin=m.a,this.TextAlign=M.d,this.TextSize=M.f,this.MOBILE_APP_DOWNLOAD_LINK="https://bnc.lt/Ed5l/VcovUszaWr"}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=h.Mb({type:e,selectors:[["app-messaging-chat-onboarding-milestone"]],inputs:{isHourlyProject:"isHourlyProject",otherUser:"otherUser",project:"project"},decls:4,vars:5,consts:function(){let e,t,i,n,a,s,o;return e="Messaging onboarding introduction image",t=" Track time to get paid ",i=" If " + "\ufffd0\ufffd" + " has enabled time tracking, simply track time with the Desktop App or from the Time Tracking tab to get paid. ",n=" Track location to get paid ",a=" For " + "\ufffd0\ufffd" + " to see your location, you need to use our " + "\ufffd#4\ufffd" + "mobile app" + "\ufffd/#4\ufffd" + " while on the job. ",s=" Only ask for payment to be released after you have completed work ",o=" Ask " + "\ufffd0\ufffd" + " to create milestone payments for work you agree to complete, and only ask for it to be released once you complete the task. ",[["alt",e,1,"MessagingOnboarding-image",3,"flMarginBottom","src","boundedWidth"],[4,"ngIf","ngIfElse"],["default",""],["localProject",""],[3,"flMarginBottom","size","textAlign"],t,[3,"textAlign"],i,n,a,["flTrackingLabel","DownloadMobileAppLink",3,"link"],s,o]},template:function(e,t){if(1&e&&(h.Tb(0,"fl-picture",0),h.ad(1,Q,4,2,"ng-container",1),h.ad(2,W,4,5,"ng-template",null,2,h.bd)),2&e){const e=h.Nc(3);h.zc("flMarginBottom",t.Margin.MID)("src","messaging/ui-transaction.svg")("boundedWidth",!0),h.Gb(1),h.zc("ngIf",t.isHourlyProject)("ngIfElse",e)}},directives:[$.a,m.b,n.q,M.e,Y.b,x.a],styles:["[_nghost-%COMP%]{display:flex;flex:1 0;flex-direction:column;height:calc(100% - 56px)}.MessagingOnboarding-image[_ngcontent-%COMP%]{max-width:75px}.MessagingOnboarding-body[_ngcontent-%COMP%]{align-items:center;display:flex;flex-direction:column;height:100%;justify-content:center;overflow:auto;padding:24px 12px 0}.MessagingOnboarding-footer[_ngcontent-%COMP%]{flex:0 0 auto}.MessagingOnboarding-footer-content[_ngcontent-%COMP%]{align-items:center;display:flex;padding:24px}.IsHidden[_ngcontent-%COMP%]{visibility:hidden}"],changeDetection:0}),e})();function K(e,t){if(1&e&&h.Tb(0,"app-messaging-chat-onboarding-intro",13),2&e){const e=h.rc();h.zc("otherUser",e.otherMember)("project",e.project)("thread",e.thread)}}function Z(e,t){1&e&&h.Tb(0,"app-messaging-chat-onboarding-offsite",14)}function J(e,t){if(1&e&&h.Tb(0,"app-messaging-chat-onboarding-discuss",15),2&e){const e=h.rc();h.zc("otherUser",e.otherMember)}}function ee(e,t){if(1&e&&h.Tb(0,"app-messaging-chat-onboarding-milestone",16),2&e){const e=h.rc();h.zc("project",e.project)("otherUser",e.otherMember)("isHourlyProject",e.isHourlyProject)}}function te(e,t){if(1&e){const e=h.Zb();h.Yb(0,"fl-button",17),h.nc("click",function(){return h.Qc(e),h.rc().nextClicked()}),h.cc(1,18),h.Xb()}if(2&e){const e=h.rc();h.zc("color",e.ButtonColor.SECONDARY)("size",e.ButtonSize.SMALL)}}function ie(e,t){if(1&e){const e=h.Zb();h.Yb(0,"fl-button",19),h.nc("click",function(){h.Qc(e);const t=h.rc();return t.endClicked(t.thread)}),h.cc(1,20),h.Xb()}if(2&e){const e=h.rc();h.zc("color",e.ButtonColor.SECONDARY)("size",e.ButtonSize.SMALL)}}const ne=function(e){return{IsHidden:e}};var ae=function(e){return e[e.INTRO=0]="INTRO",e[e.OFFSITE=1]="OFFSITE",e[e.DISCUSS=2]="DISCUSS",e[e.MILESTONE=3]="MILESTONE",e}({});let se=(()=>{class e{constructor(e){this.localStorage=e,this.ButtonColor=j.a,this.ButtonSize=P.a,this.Margin=m.a,this.OnboardingStep=ae,this.closeOnboarding=new h.n,this.currentStep=ae.INTRO,this.NUM_STEPS=Object.keys(ae).length/2,this.FIRST_STEP=0,this.LAST_STEP=this.NUM_STEPS-1}backClicked(){this.currentStep!==this.FIRST_STEP&&this.currentStep--}nextClicked(){this.currentStep!==this.LAST_STEP&&this.currentStep++}endClicked(e){return Object(_.a)(this,void 0,void 0,function*(){const t=yield this.localStorage.get("projectOverlayThreadComplete").pipe(Object(R.a)(1)).toPromise(),i=Object.assign(Object.assign({},t),{[e.id]:!0});yield this.localStorage.set("projectOverlayThreadComplete",i),yield this.localStorage.set("projectOverlayFullFlowComplete",!0),this.closeOnboarding.emit()})}}return e.\u0275fac=function(t){return new(t||e)(h.Sb(B.a))},e.\u0275cmp=h.Mb({type:e,selectors:[["app-messaging-chat-onboarding"]],inputs:{otherMember:"otherMember",project:"project",thread:"thread",isHourlyProject:"isHourlyProject"},outputs:{closeOnboarding:"closeOnboarding"},decls:14,vars:15,consts:function(){let e,t,i,n;return e=" Back ",t="Messaging Onboarding progress",i=" Next ",n=" Chat ",[["flTrackingSection","MessagingOnboarding"],[3,"ngSwitch"],["class","MessagingOnboarding-body",3,"otherUser","project","thread",4,"ngSwitchCase"],["class","MessagingOnboarding-body",4,"ngSwitchCase"],["class","MessagingOnboarding-body",3,"otherUser",4,"ngSwitchCase"],["class","MessagingOnboarding-body",3,"project","otherUser","isHourlyProject",4,"ngSwitchCase"],[1,"MessagingOnboarding-footer"],[1,"MessagingOnboarding-footer-content"],["flTrackingLabel","MessagingOnboardingBackButton",3,"ngClass","color","flMarginRight","size","click"],e,["label",t,3,"flMarginRight","progressPercentage"],["flTrackingLabel","MessagingOnboardingNextButton",3,"color","size","click",4,"ngIf","ngIfElse"],["chatCta",""],[1,"MessagingOnboarding-body",3,"otherUser","project","thread"],[1,"MessagingOnboarding-body"],[1,"MessagingOnboarding-body",3,"otherUser"],[1,"MessagingOnboarding-body",3,"project","otherUser","isHourlyProject"],["flTrackingLabel","MessagingOnboardingNextButton",3,"color","size","click"],i,["flTrackingLabel","MessagingOnboardingChatButton",3,"color","size","click"],n]},template:function(e,t){if(1&e&&(h.Wb(0,0),h.Yb(1,"fl-scrollable-content",1),h.ad(2,K,1,3,"app-messaging-chat-onboarding-intro",2),h.ad(3,Z,1,0,"app-messaging-chat-onboarding-offsite",3),h.ad(4,J,1,1,"app-messaging-chat-onboarding-discuss",4),h.ad(5,ee,1,3,"app-messaging-chat-onboarding-milestone",5),h.Xb(),h.Yb(6,"fl-bit",6),h.Yb(7,"fl-bit",7),h.Yb(8,"fl-button",8),h.nc("click",function(){return t.backClicked()}),h.cc(9,9),h.Xb(),h.Tb(10,"fl-progress-bar",10),h.ad(11,te,2,2,"fl-button",11),h.ad(12,ie,2,2,"ng-template",null,12,h.bd),h.Xb(),h.Xb(),h.Vb()),2&e){const e=h.Nc(13);h.Gb(1),h.zc("ngSwitch",t.currentStep),h.Gb(1),h.zc("ngSwitchCase",t.OnboardingStep.INTRO),h.Gb(1),h.zc("ngSwitchCase",t.OnboardingStep.OFFSITE),h.Gb(1),h.zc("ngSwitchCase",t.OnboardingStep.DISCUSS),h.Gb(1),h.zc("ngSwitchCase",t.OnboardingStep.MILESTONE),h.Gb(3),h.zc("ngClass",h.Ec(13,ne,t.currentStep===t.OnboardingStep.INTRO))("color",t.ButtonColor.TRANSPARENT_DARK)("flMarginRight",t.Margin.LARGE)("size",t.ButtonSize.SMALL),h.Gb(2),h.zc("flMarginRight",t.Margin.LARGE)("progressPercentage",100*(t.currentStep+1)/t.NUM_STEPS),h.Gb(1),h.zc("ngIf",t.currentStep!==t.OnboardingStep.MILESTONE)("ngIfElse",e)}},directives:[f.a,u.a,n.s,n.t,y.a,j.b,x.a,n.o,m.b,T.a,n.q,N,D,X,q],styles:["[_nghost-%COMP%]{display:flex;flex:1 0;flex-direction:column;height:calc(100% - 56px)}.MessagingOnboarding-image[_ngcontent-%COMP%]{max-width:75px}.MessagingOnboarding-body[_ngcontent-%COMP%]{align-items:center;display:flex;flex-direction:column;height:100%;justify-content:center;overflow:auto;padding:24px 12px 0}.MessagingOnboarding-footer[_ngcontent-%COMP%]{flex:0 0 auto}.MessagingOnboarding-footer-content[_ngcontent-%COMP%]{align-items:center;display:flex;padding:24px}.IsHidden[_ngcontent-%COMP%]{visibility:hidden}"],changeDetection:0}),e})();var oe=i("23iI"),re=i("UztC"),ce=i("1YM7");let le=(()=>{class e{constructor(){this.Margin=m.a,this.TextAlign=M.d,this.TextSize=M.f}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=h.Mb({type:e,selectors:[["app-messaging-message-list-empty"]],decls:4,vars:4,consts:function(){let e,t;return e="Messaging chat image",t=" There's nothing here yet. Start the conversation! ",[["alt",e,3,"flMarginBottom","src"],[1,"EmptyStateMessageContainer"],[3,"size","textAlign"],t]},template:function(e,t){1&e&&(h.Tb(0,"fl-picture",0),h.Yb(1,"fl-bit",1),h.Yb(2,"fl-text",2),h.cc(3,3),h.Xb(),h.Xb()),2&e&&(h.zc("flMarginBottom",t.Margin.XSMALL)("src","messaging/live-chat.svg"),h.Gb(2),h.zc("size",t.TextSize.MID)("textAlign",t.TextAlign.CENTER))},directives:[$.a,m.b,y.a,M.e],styles:["[_nghost-%COMP%]{align-items:center;display:flex;flex-direction:column;height:100%;justify-content:center;overflow:hidden;padding:12px}.EmptyStateMessageContainer[_ngcontent-%COMP%]{width:269px}"]}),e})();var de=i("jASZ"),he=i("b6KT"),ge=i("565b"),ue=i("etQe"),be=i("YKAE"),fe=i("71eJ"),pe=i("f6cb"),me=i("wZbG"),Ce=i("AJ15"),Me=i("4kPF"),Se=i("os2j"),xe=i("fYbj"),ye=i("KrVf");function Te(e,t){if(1&e){const e=h.Zb();h.Yb(0,"fl-button",4),h.nc("click",function(){return h.Qc(e),h.rc().handleViewAttachment()}),h.Tb(1,"fl-picture",5),h.sc(2,"flAsync"),h.Xb()}if(2&e){const e=h.rc();h.zc("display","block")("flMarginBottom",e.Margin.XXXSMALL),h.Gb(1),h.zc("src",h.tc(2,7,e.pathPromise))("alt",e.attachment)("externalSrc",!0)("boundedWidth",!0)("objectFit",e.PictureObjectFit.COVER)}}function Ie(e,t){if(1&e){const e=h.Zb();h.Yb(0,"fl-file-display",6),h.nc("click",function(){return h.Qc(e),h.rc().handleViewAttachment()}),h.Xb()}if(2&e){const e=h.rc();h.zc("alt",e.attachment)("flMarginRight",e.Margin.XXSMALL)("src",e.attachment)}}let Oe=(()=>{class e{constructor(e){this.fileStorage=e,this.HighlightColor=C.b,this.LinkWeight=Y.f,this.Margin=m.a,this.PictureObjectFit=$.c,this.FileType=xe.b,this.viewAttachment=new h.n}ngOnChanges(e){"attachment"in e&&(this.fileType=Object(xe.f)(this.attachment)),this.pathPromise=this.fileStorage.getDownloadURL(Se.a.MESSAGING_ATTACHMENTS,this.attachment,{messageId:this.messageId.toString()}).then(e=>"success"===e.status?e.downloadURL:void 0)}handleViewAttachment(){this.viewAttachment.emit({name:this.attachment,messageId:this.messageId,type:this.fileType})}}return e.\u0275fac=function(t){return new(t||e)(h.Sb(ye.a))},e.\u0275cmp=h.Mb({type:e,selectors:[["app-messaging-message-attachment"]],inputs:{attachment:"attachment",messageId:"messageId"},outputs:{viewAttachment:"viewAttachment"},features:[h.Eb],decls:6,vars:6,consts:[[3,"ngClass"],["flTrackingLabel","ViewThumbnail",3,"display","flMarginBottom","click",4,"ngIf","ngIfElse"],["nonImageAttachment",""],["flTrackingLabel","OpenFileAttachment-link",3,"highlightColor","weight","click"],["flTrackingLabel","ViewThumbnail",3,"display","flMarginBottom","click"],[1,"AttachmentImage-image",3,"src","alt","externalSrc","boundedWidth","objectFit"],["flTrackingLabel","ViewThumbnail",1,"AttachmentNonImage-icon",3,"alt","flMarginRight","src","click"]],template:function(e,t){if(1&e&&(h.Yb(0,"fl-bit",0),h.ad(1,Te,3,9,"fl-button",1),h.ad(2,Ie,1,3,"ng-template",null,2,h.bd),h.Yb(4,"fl-link",3),h.nc("click",function(){return t.handleViewAttachment()}),h.cd(5),h.Xb(),h.Xb()),2&e){const e=h.Nc(3);h.zc("ngClass",t.fileType===t.FileType.IMAGE?"AttachmentImage":"AttachmentNonImage"),h.Gb(1),h.zc("ngIf",t.fileType===t.FileType.IMAGE)("ngIfElse",e),h.Gb(3),h.zc("highlightColor",t.HighlightColor.BLUE)("weight",t.LinkWeight.BOLD),h.Gb(1),h.ed(" ",t.attachment," ")}},directives:[y.a,n.o,n.q,Y.b,x.a,j.b,m.b,$.a,S.a],pipes:[z.a],styles:[".AttachmentNonImage[_ngcontent-%COMP%]{align-items:center;display:flex;flex-direction:row;width:100%}.AttachmentNonImage-icon[_ngcontent-%COMP%]{flex-shrink:0}.AttachmentImage[_ngcontent-%COMP%]{display:block}.AttachmentImage-image[_ngcontent-%COMP%]{height:220px}"],changeDetection:0}),e})();function ve(e,t){if(1&e&&(h.Yb(0,"fl-text",12),h.cc(1,13),h.Xb()),2&e){const e=h.rc();h.zc("flMarginBottom",e.Margin.XSMALL)("color",e.FontColor.INHERIT)("size",e.TextSize.XXXSMALL)("textTransform",e.TextTransform.UPPERCASE)}}function Ae(e,t){if(1&e&&(h.Yb(0,"fl-bit",14),h.Yb(1,"fl-text",15),h.cd(2),h.sc(3,"date"),h.Xb(),h.Tb(4,"fl-hr"),h.Xb()),2&e){const e=h.rc();h.zc("flMarginBottom",e.Margin.XSMALL),h.Gb(1),h.zc("flMarginBottom",e.Margin.XXXSMALL)("color",e.FontColor.MID)("highlightColor",e.HighlightColor.BLUE)("size",e.TextSize.XXSMALL)("textTransform",e.TextTransform.UPPERCASE),h.Gb(1),h.ed(" ",h.uc(3,7,e.message.timeCreated,"MMM dd, yyyy")," ")}}function we(e,t){if(1&e&&(h.Yb(0,"fl-text",16),h.cd(1),h.Xb()),2&e){const e=h.rc();h.zc("color",e.isSending?e.FontColor.LIGHT:e.FontColor.INHERIT)("flMarginRight",e.Margin.XXXSMALL)("highlightColor",e.HighlightColor.BLUE)("weight",e.FontWeight.MEDIUM),h.Gb(1),h.ed(" ",null==e.user?null:e.user.displayName," ")}}function ke(e,t){if(1&e&&h.Tb(0,"app-rich-message",17),2&e){const e=h.rc();h.zc("isOldChatbox",!1)("currentUserId",e.loggedInUserId)("messageId",e.message.id)("richMessage",e.message.richMessage)}}function ze(e,t){if(1&e){const e=h.Zb();h.Yb(0,"app-messaging-message-attachment",21),h.nc("viewAttachment",function(t){return h.Qc(e),h.rc(2).viewAttachment.emit(t)}),h.Xb()}if(2&e){const e=t.$implicit,i=h.rc(2);h.zc("attachment",e)("messageId",i.message.id)}}function Ee(e,t){if(1&e&&h.Tb(0,"fl-icon",25),2&e){const e=h.rc(3);h.zc("color",e.IconColor.MID)("name","ui-tick")("size",e.IconSize.XSMALL)}}function Le(e,t){if(1&e&&h.Tb(0,"fl-icon",25),2&e){const e=h.rc(4);h.zc("color",e.IconColor.PRIMARY)("name","ui-done-all")("size",e.IconSize.XSMALL)}}function _e(e,t){if(1&e&&(h.Yb(0,"fl-tooltip",27),h.sc(1,"date"),h.ec(2,28),h.Tb(3,"fl-icon",25),h.Xb()),2&e){const e=h.rc(4);h.gc(h.uc(1,5,e.lastReadTime,"MMM dd, yyyy \u2022 h:mm a")),h.dc(2),h.zc("position",e.TooltipPosition.BOTTOM_CENTER),h.Gb(3),h.zc("color",e.IconColor.PRIMARY)("name","ui-done-all")("size",e.IconSize.XSMALL)}}function je(e,t){if(1&e&&(h.ad(0,Le,1,3,"fl-icon",23),h.ad(1,_e,4,8,"ng-template",null,26,h.bd)),2&e){const e=h.Nc(2),t=h.rc(3);h.zc("ngIf",t.isGroupChat)("ngIfElse",e)}}function Pe(e,t){if(1&e&&(h.Yb(0,"fl-bit",22),h.ad(1,Ee,1,3,"fl-icon",23),h.ad(2,je,3,2,"ng-template",null,24,h.bd),h.Xb()),2&e){const e=h.Nc(3),t=h.rc(2);h.zc("flMarginRight",t.Margin.XSMALL)("flMarginBottom",t.Margin.XXSMALL),h.Gb(1),h.zc("ngIf",!t.lastReadTime)("ngIfElse",e)}}function Re(e,t){if(1&e&&(h.Tb(0,"fl-interactive-text",18),h.ad(1,ze,1,2,"app-messaging-message-attachment",19),h.ad(2,Pe,4,4,"fl-bit",20)),2&e){const e=h.rc();h.zc("content",e.message.message)("emoji",!0)("flMarginRight",e.Margin.XSMALL)("link",!0)("fontColor",e.isSending?e.FontColor.LIGHT:e.FontColor.INHERIT)("fontSize",e.TextSize.XSMALL)("highlightColor",e.HighlightColor.BLUE),h.Gb(1),h.zc("ngForOf",e.message.attachments)("ngForTrackBy",e.identifyAttachment),h.Gb(1),h.zc("ngIf",e.isSent&&e.fromLoggedInUser)}}const Be=function(e){return{"Message-item--fromLoggedInUser":e}},$e=function(e){return{IsHidden:e}},Ue=function(e){return[e]},Ge=function(e,t,i,n,a,s){return{"Message-bubble--loggedInArrowRecruiter":e,"Message-bubble--pointer":t,"Message-bubble--pointer--dark":i,"Message-bubble--pointer--loggedInArrowRecruiter":n,"Message-bubble--flatBottomCorner":a,"Message-bubble--sending":s}};let Ne=(()=>{class e{constructor(){this.AvatarSize=fe.a,this.FontColor=C.a,this.FontWeight=M.c,this.HighlightColor=C.b,this.IconColor=p.c,this.IconSize=p.e,this.Margin=m.a,this.TextSize=M.f,this.TextTransform=M.g,this.TooltipPosition=be.b,this.MessageSendStatus=ue.a,this.avatarSize=fe.a.SMALL,this.isGroupChat=!1,this.viewAttachment=new h.n,this.fromLoggedInUser=!1,this.showDateDivider=!1,this.showUserHeader=!0,this.showHeaderInNextMessage=!1,this.showUnreadMessagesDivider=!1,this.isRecruiter=!1,this.isSending=!1,this.isSent=!0,this.TIME_GAP_TO_SHOW_HEADER=144e5}checkIfSameDate(e,t){const i=new Date(e),n=new Date(t);return i.getFullYear()===n.getFullYear()&&i.getMonth()===n.getMonth()&&i.getDate()===n.getDate()}ngOnChanges(e){var t;"message"in e&&(this.isSending=this.message.sendStatus===ue.a.SENDING,this.isSent=this.message.sendStatus===ue.a.SENT),("message"in e||"previousMessage"in e)&&(this.showDateDivider=!this.previousMessage||!this.checkIfSameDate(this.message.timeCreated,this.previousMessage.timeCreated),this.showUserHeader=this.shouldDisplayHeader(this.previousMessage)),("message"in e||"nextMessage"in e)&&(this.showHeaderInNextMessage=this.shouldDisplayHeader(this.nextMessage)),"loggedInUser"in e&&this.loggedInUser&&(this.loggedInUserId=e.loggedInUser.currentValue.id.toString()),this.loggedInUser&&this.user&&("message"in e||"user"in e||"loggedInUser"in e)&&(this.fromLoggedInUser=this.user.id===this.loggedInUser.id,this.isRecruiter=!!(null===(t=this.loggedInUser.supportStatus)||void 0===t?void 0:t.type)),this.loggedInUser&&("message"in e||"userReadTimes"in e||"loggedInUser"in e)&&(this.lastReadTime=Object.entries(this.userReadTimes).filter(([e,t])=>Object(pe.r)(e)!==this.loggedInUser.id&&t>=this.message.timeCreated).map(([e,t])=>t).reduce((e,t)=>e>t?e:t,0)),("firstUnreadMessage"in e||"message"in e)&&(this.showUnreadMessagesDivider=Object(he.e)(this.message,this.firstUnreadMessage))}identifyAttachment(e,t){return t}shouldDisplayHeader(e){return!e||e.fromUser!==this.message.fromUser||Math.abs(e.timeCreated-this.message.timeCreated)>this.TIME_GAP_TO_SHOW_HEADER}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=h.Mb({type:e,selectors:[["app-messaging-message-item"]],inputs:{avatarSize:"avatarSize",isGroupChat:"isGroupChat",loggedInUser:"loggedInUser",message:"message",previousMessage:"previousMessage",nextMessage:"nextMessage",firstUnreadMessage:"firstUnreadMessage",user:"user",userIsOnline:"userIsOnline",userReadTimes:"userReadTimes"},outputs:{viewAttachment:"viewAttachment"},features:[h.Eb],decls:16,vars:39,consts:function(){let e,t;return e=" New Messages ",t="Read on " + "\ufffd0\ufffd" + "",[["class","Message-newMessages-text",3,"flMarginBottom","color","size","textTransform",4,"ngIf"],[3,"flMarginBottom",4,"ngIf"],[1,"Message-item",3,"ngClass"],[3,"ngClass","flMarginRight","size","users","isOnline"],[1,"Message-bubble",3,"ngClass"],[1,"Message-bubble-contents",3,"flMarginRight"],[1,"Message-bubble-timestamp"],[3,"message","position"],[3,"color","highlightColor","size"],["class","Message-item-header",3,"color","flMarginRight","highlightColor","weight",4,"ngIf"],[3,"isOldChatbox","currentUserId","messageId","richMessage",4,"ngIf","ngIfElse"],["userMessage",""],[1,"Message-newMessages-text",3,"flMarginBottom","color","size","textTransform"],e,[3,"flMarginBottom"],[3,"flMarginBottom","color","highlightColor","size","textTransform"],[1,"Message-item-header",3,"color","flMarginRight","highlightColor","weight"],[3,"isOldChatbox","currentUserId","messageId","richMessage"],[3,"content","emoji","flMarginRight","link","fontColor","fontSize","highlightColor"],[3,"attachment","messageId","viewAttachment",4,"ngFor","ngForOf","ngForTrackBy"],["class","Message-bubble-readMarker",3,"flMarginRight","flMarginBottom",4,"ngIf"],[3,"attachment","messageId","viewAttachment"],[1,"Message-bubble-readMarker",3,"flMarginRight","flMarginBottom"],[3,"color","name","size",4,"ngIf","ngIfElse"],["readMarker",""],[3,"color","name","size"],["privateChatReadMarker",""],[3,"position",6,"message"],["message",t]]},template:function(e,t){if(1&e&&(h.ad(0,ve,2,4,"fl-text",0),h.ad(1,Ae,5,10,"fl-bit",1),h.Yb(2,"fl-bit",2),h.Tb(3,"fl-user-avatar",3),h.Yb(4,"fl-bit",4),h.Yb(5,"fl-bit",5),h.Yb(6,"fl-bit",6),h.Yb(7,"fl-tooltip",7),h.sc(8,"date"),h.Yb(9,"fl-text",8),h.cd(10),h.sc(11,"date"),h.Xb(),h.Xb(),h.Xb(),h.ad(12,we,2,5,"fl-text",9),h.ad(13,ke,1,4,"app-rich-message",10),h.ad(14,Re,3,10,"ng-template",null,11,h.bd),h.Xb(),h.Xb(),h.Xb()),2&e){const e=h.Nc(15);h.zc("ngIf",t.showUnreadMessagesDivider&&!t.showDateDivider),h.Gb(1),h.zc("ngIf",t.showDateDivider&&!t.showUnreadMessagesDivider),h.Gb(1),h.zc("ngClass",h.Ec(26,Be,t.fromLoggedInUser)),h.Gb(1),h.zc("ngClass",h.Ec(28,$e,!t.showUserHeader&&!t.showUnreadMessagesDivider))("flMarginRight",t.Margin.XSMALL)("size",t.avatarSize)("users",h.Ec(30,Ue,t.user))("isOnline",t.userIsOnline),h.Gb(1),h.zc("ngClass",h.Jc(32,Ge,t.fromLoggedInUser&&t.isRecruiter,t.showUserHeader||t.showUnreadMessagesDivider,(t.showUserHeader||t.showUnreadMessagesDivider)&&t.isSending,(t.showUserHeader||t.showUnreadMessagesDivider)&&t.fromLoggedInUser&&t.isRecruiter,!t.showHeaderInNextMessage,t.isSending)),h.Gb(1),h.zc("flMarginRight",t.Margin.XXXSMALL),h.Gb(2),h.Ac("message",h.uc(8,20,t.message.timeCreated,"MMM dd, yyyy \u2022 h:mm a")),h.zc("position",t.TooltipPosition.BOTTOM_CENTER),h.Gb(2),h.zc("color",t.FontColor.MID)("highlightColor",t.HighlightColor.BLUE)("size",t.TextSize.XXSMALL)("color",t.isSending?t.FontColor.LIGHT:t.FontColor.INHERIT),h.Gb(1),h.ed(" ",h.uc(11,23,t.message.timeCreated,"h:mm a")," "),h.Gb(2),h.zc("ngIf",t.showUserHeader||t.showUnreadMessagesDivider),h.Gb(1),h.zc("ngIf",!!t.message.richMessage)("ngIfElse",e)}},directives:[n.q,y.a,n.o,fe.b,m.b,be.a,M.e,me.a,Ce.a,Me.a,n.p,Oe,p.d],pipes:[n.f],styles:['[_nghost-%COMP%]{display:block}.Message-item[_ngcontent-%COMP%]{word-break:break-word;word-wrap:break-word;display:flex;max-width:100%}.Message-item-header[_ngcontent-%COMP%]{display:flex}.Message-item--fromLoggedInUser[_ngcontent-%COMP%]{min-height:58px}.Message-item[_ngcontent-%COMP%]   .IsHidden[_ngcontent-%COMP%]{height:0;visibility:hidden}.Message-bubble[_ngcontent-%COMP%]{align-items:flex-start;border:1px solid #f0f0f0;border-radius:12px;border-top-left-radius:0;display:flex;padding:8px;position:relative;width:100%}.Message-bubble-contents[_ngcontent-%COMP%]{flex:1}.Message-bubble-timestamp[_ngcontent-%COMP%]{float:right;margin-bottom:1px;margin-left:12px}.Message-bubble-readMarker[_ngcontent-%COMP%]{bottom:0;position:absolute;right:0}.Message-bubble--pointer[_ngcontent-%COMP%]:after, .Message-bubble--pointer[_ngcontent-%COMP%]:before{content:"";height:0;position:absolute;width:0}.Message-bubble--pointer[_ngcontent-%COMP%]:before{border-color:#f0f0f0 #f0f0f0 transparent transparent;border-style:solid;border-width:2px 10px 10px 2px;left:-12px;top:-1px}.Message-bubble--pointer[_ngcontent-%COMP%]:after{border-color:#fff #fff transparent transparent;border-style:solid;border-width:2px 9px 9px 2px;left:-10px;top:0}.Message-bubble--pointer--dark[_ngcontent-%COMP%]:after{border-right-color:#dedede;border-top-color:#dedede}.Message-bubble--pointer--loggedInArrowRecruiter[_ngcontent-%COMP%]:after{border-right-color:#fff;border-top-color:#fff}.Message-bubble--flatBottomCorner[_ngcontent-%COMP%]{border-bottom-left-radius:0}.Message-bubble--sending[_ngcontent-%COMP%]{background-color:#dedede;color:#fff}.Message-bubble--loggedInArrowRecruiter[_ngcontent-%COMP%]{background-color:#fff;color:#0e1724}.Message-newMessages-text[_ngcontent-%COMP%]{border-bottom:1px solid #007fed;color:#007fed;padding-bottom:12px;padding-top:16px;width:100%}'],changeDetection:0}),e})();var Fe=i("v01h");const De=["scrollableContent"];function Xe(e,t){if(1&e){const e=h.Zb();h.Yb(0,"fl-link",9),h.nc("click",function(){return h.Qc(e),h.rc(2).loadMoreMessage.emit()}),h.cc(1,10),h.Xb()}}function Ye(e,t){if(1&e&&h.Tb(0,"fl-spinner",11),2&e){const e=h.rc(2);h.zc("size",e.SpinnerSize.SMALL)}}function He(e,t){if(1&e&&(h.Yb(0,"fl-bit",6),h.ad(1,Xe,2,0,"fl-link",7),h.ad(2,Ye,1,1,"ng-template",null,8,h.bd),h.Xb()),2&e){const e=h.Nc(3),t=h.rc();h.zc("flMarginBottom",t.Margin.XXSMALL),h.Gb(1),h.zc("ngIf",!t.loading)("ngIfElse",e)}}function Ve(e,t){if(1&e){const e=h.Zb();h.Yb(0,"app-messaging-message-item",12),h.nc("viewAttachment",function(t){return h.Qc(e),h.rc().viewAttachment.emit(t)}),h.Xb()}if(2&e){const e=t.$implicit,i=t.index,n=t.last,a=h.rc();h.zc("flMarginBottom",n?a.Margin.NONE:a.Margin.XXXSMALL)("loggedInUser",a.loggedInUser)("message",e)("previousMessage",0!==i?a.messages[i-1]:void 0)("nextMessage",n?void 0:a.messages[i+1])("user",a.usersMap[e.fromUser])("userReadTimes",a.userReadTimes)("userIsOnline",a.usersIsOnlineMap[e.fromUser])("isGroupChat",a.isGroupChat)("firstUnreadMessage",a.firstUnreadMessage)}}function Qe(e,t){if(1&e){const e=h.Zb();h.Yb(0,"fl-floating-action",13),h.nc("click",function(){return h.Qc(e),h.rc().scrollToBottom()}),h.Xb()}2&e&&h.zc("icon","ui-arrow-down")}let We=(()=>{class e{constructor(){this.Margin=m.a,this.SpinnerSize=de.d,this.isGroupChat=!1,this.loading=!1,this.showLoadMore=!1,this.loadMoreMessage=new h.n,this.viewAttachment=new h.n,this.showNewMessagesFloatingAction=!1}ngAfterViewInit(){this.scrollToBottom()}ngOnChanges(e){var t,i;this.loggedInUser&&e.messages&&(!e.messages.previousValue||(null===(t=this.scrollableContent)||void 0===t?void 0:t.isAtBottom())||this.isMessageSent(e.messages.currentValue,e.messages.previousValue))&&this.scrollToBottom(),this.loggedInUser&&e.messages&&this.isMessageSent(e.messages.currentValue,e.messages.previousValue)&&(this.firstUnreadMessage=void 0),e.messages&&e.thread&&this.thread&&!(null===(i=this.scrollableContent)||void 0===i?void 0:i.isAtBottom())&&!this.thread.isRead&&!this.showNewMessagesFloatingAction&&(this.firstUnreadMessage=this.messages[this.messages.length-1],this.showNewMessagesFloatingAction=!0)}scrollToBottom(){this.scrollableContent&&(this.scrollableContent.scrollToBottom(),this.showNewMessagesFloatingAction=!1)}isMessageSent(e,t){const i=e[e.length-1],n=t?t[t.length-1]:void 0;return i&&i.fromUser?!Object(he.e)(i,n)&&i.fromUser===this.loggedInUser.id:!Object(he.e)(i,n)}identifyMessage(e,t){return t.id}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=h.Mb({type:e,selectors:[["app-messaging-message-list"]],viewQuery:function(e,t){if(1&e&&h.jd(De,1),2&e){let e;h.Mc(e=h.oc())&&(t.scrollableContent=e.first)}},inputs:{isGroupChat:"isGroupChat",loading:"loading",loggedInUser:"loggedInUser",showLoadMore:"showLoadMore",messages:"messages",thread:"thread",userReadTimes:"userReadTimes",usersIsOnlineMap:"usersIsOnlineMap",usersMap:"usersMap"},outputs:{loadMoreMessage:"loadMoreMessage",viewAttachment:"viewAttachment"},features:[h.Eb],decls:6,vars:4,consts:function(){let e,t;return e="Show new messages",t=" Load More... ",[[1,"MessageList-scrollableContent"],["scrollableContent",""],[1,"MessageList"],["class","MessageList-loadMore",3,"flMarginBottom",4,"ngIf"],["class","MessageList-item",3,"flMarginBottom","loggedInUser","message","previousMessage","nextMessage","user","userReadTimes","userIsOnline","isGroupChat","firstUnreadMessage","viewAttachment",4,"ngFor","ngForOf","ngForTrackBy"],["flTrackingLabel","showNewMessagesFloatingAction","text",e,3,"icon","click",4,"ngIf"],[1,"MessageList-loadMore",3,"flMarginBottom"],["flTrackingLabel","LoadMoreMessages",3,"click",4,"ngIf","ngIfElse"],["loadingMessages",""],["flTrackingLabel","LoadMoreMessages",3,"click"],t,["flTrackingLabel","MoreMessagesLoading",3,"size"],[1,"MessageList-item",3,"flMarginBottom","loggedInUser","message","previousMessage","nextMessage","user","userReadTimes","userIsOnline","isGroupChat","firstUnreadMessage","viewAttachment"],["flTrackingLabel","showNewMessagesFloatingAction","text",e,3,"icon","click"]]},template:function(e,t){1&e&&(h.Yb(0,"fl-scrollable-content",0,1),h.Yb(2,"fl-bit",2),h.ad(3,He,4,3,"fl-bit",3),h.ad(4,Ve,1,10,"app-messaging-message-item",4),h.Xb(),h.Xb(),h.ad(5,Qe,1,1,"fl-floating-action",5)),2&e&&(h.Gb(3),h.zc("ngIf",t.showLoadMore||t.loading),h.Gb(1),h.zc("ngForOf",t.messages)("ngForTrackBy",t.identifyMessage),h.Gb(1),h.zc("ngIf",t.showNewMessagesFloatingAction))},directives:[u.a,y.a,n.q,n.p,m.b,Y.b,x.a,ge.a,de.c,Ne,Fe.a],styles:["[_nghost-%COMP%]{display:flex;flex:1;flex-direction:column;overflow:auto;position:relative}.MessageList[_ngcontent-%COMP%]{padding:16px}.MessageList-scrollableContent[_ngcontent-%COMP%]{bottom:0;flex:1 0 100%;left:0;overflow-y:auto;position:absolute;right:0;top:0}.MessageList-loadMore[_ngcontent-%COMP%]{text-align:center}.MessageList-item[_ngcontent-%COMP%]{display:flex;flex-direction:column}"],changeDetection:0}),e})();var qe=i("Np1b"),Ke=i("5f+h");function Ze(e,t){if(1&e&&(h.Wb(0),h.cc(1,3),h.Vb()),2&e){const e=h.rc(2);h.Gb(1),h.gc(e.usersTyping[0].displayName),h.dc(1)}}function Je(e,t){if(1&e&&(h.Wb(0),h.cc(1,4),h.Vb()),2&e){const e=h.rc(2);h.Gb(1),h.gc(e.usersTyping[0].displayName),h.dc(1)}}function et(e,t){if(1&e&&(h.Wb(0),h.cc(1,5),h.Vb()),2&e){const e=h.rc(2);h.Gb(1),h.gc(e.usersTyping[0].displayName)(e.usersTyping.length-1),h.dc(1)}}function tt(e,t){if(1&e&&(h.Yb(0,"fl-text",1),h.ad(1,Ze,2,1,"ng-container",2),h.ad(2,Je,2,1,"ng-container",2),h.ad(3,et,2,2,"ng-container",2),h.Xb()),2&e){const e=h.rc();h.zc("color",e.FontColor.MID)("highlightColor",e.HighlightColor.BLUE)("size",e.TextSize.XSMALL),h.Gb(1),h.zc("ngIf",1===e.usersTyping.length),h.Gb(1),h.zc("ngIf",2===e.usersTyping.length),h.Gb(1),h.zc("ngIf",e.usersTyping.length>2)}}let it=(()=>{class e{constructor(){this.FontColor=C.a,this.HighlightColor=C.b,this.TextSize=M.f}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=h.Mb({type:e,selectors:[["app-messaging-typing-indicator"]],inputs:{usersTyping:"usersTyping"},decls:1,vars:1,consts:function(){let e,t,i;return e=" " + "\ufffd0\ufffd" + " is typing... ",t=" " + "\ufffd0\ufffd" + " and 1 other are typing... ",i=" " + "\ufffd0\ufffd" + " and " + "\ufffd1\ufffd" + " others are typing... ",[["class","TypingIndicator",3,"color","highlightColor","size",4,"ngIf"],[1,"TypingIndicator",3,"color","highlightColor","size"],[4,"ngIf"],e,t,i]},template:function(e,t){1&e&&h.ad(0,tt,4,6,"fl-text",0),2&e&&h.zc("ngIf",null==t.usersTyping?null:t.usersTyping.length)},directives:[n.q,M.e],styles:["[_nghost-%COMP%]{display:block}.TypingIndicator[_ngcontent-%COMP%]{padding:12px 16px}"],changeDetection:0}),e})();var nt=i("Uw4d"),at=i("Z13H"),st=i("puO/"),ot=i("SMHo"),rt=i("v5ZQ"),ct=i("BFOf");let lt=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=h.Qb({type:e}),e.\u0275inj=h.Pb({imports:[[n.c,s.a,a.j,o.a,l.b,nt.a,r.a,c.a,at.a,d.MessagingAddPeopleModalModule]]}),e})();h.Uc(st.b,[n.q,y.a,f.a,n.o,ce.a,re.a,ot.a,qe.a,oe.a,rt.a,se],[]),h.Uc(qe.a,[ct.a,x.a,n.q,y.a,ge.a,de.c,le,We,me.a,it,L,Ke.a],[z.a])},ltMK:function(e,t,i){"use strict";i.r(t),i.d(t,"MessagingAddPeopleModalModule",function(){return r});var n=i("SVse"),a=i("oA5+"),s=i("cokP"),o=i("8Y7J");let r=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=o.Qb({type:e}),e.\u0275inj=o.Pb({imports:[[a.a,n.c,s.a]]}),e})()},n0rP:function(e,t,i){"use strict";var n,a,s,o,r,c;Object.defineProperty(t,"__esModule",{value:!0}),(c=t.SupportTypeApi||(t.SupportTypeApi={})).TECHNICAL="technical",c.RECRUITER="recruiter",c.GENERAL="general",c.LOCAL="local",c.DEPOSIT_FAILURE="deposit_failure",c.EQA="eqa",c.OFFSITE_MESSAGING="offsite_messaging",c.BRIEF_IMPROVEMENT="brief_improvement",c.META_MODERATE="meta_moderate",c.PFP_APPLICATIONS="pfp_applications",c.SALES="sales",c.PAYMENT_SATISFACTION="payment_satisfaction",c.PFP_TICKETS="pfp_tickets",c.PROJECT_QUALITY_AUDIT="project_quality_audit",c.MEMBERSHIP_CURATION="membership_curation",c.PROJECT_MANAGEMENT="project_management",c.EXPERT_FREELANCER_SCREENING="expert_freelancer_screening",c.ACCOUNT_CLOSURE="account_closure",c.SUCCESS_MANAGER="success_manager",c.PROFILE_PICTURE_CURATION="profile_picture_curation",c.DISCOVER="discover",c.PJP_ASSISTANT="pjp_assistant",c.ARROW_CONCIERGE="arrow_concierge",c.AWAITING_VERIFICATION="awaiting_verification",c.FREELANCER_VERIFIED="freelancer_verified",t.SupportExceptionCodesApi||(t.SupportExceptionCodesApi={}),(r=t.AgentStateApi||(t.AgentStateApi={})).DISABLED="disabled",r.AVAILABLE="available",r.UNAVAILABLE="unavailable",r.AWAY="away",(o=t.AgentOwnerTypeApi||(t.AgentOwnerTypeApi={})).FREELANCER_ADMIN="freelancer_admin",o.ARROW_SUPER_USER="arrow_super_user",(s=t.SourceTypeApi||(t.SourceTypeApi={})).USER="user",s.PROJECT="project",s.INVOICE="invoice",s.OFFSITE="offsite",s.TRANSACTION="transaction",s.TICKET="ticket",(a=t.AgentSessionStateApi||(t.AgentSessionStateApi={})).UNASSIGNED="unassigned",a.ASSIGNED="assigned",a.RESOLVED="resolved",(n=t.AgentSessionOrderByApi||(t.AgentSessionOrderByApi={})).SESSION_CREATE_TIME_ASC="session_create_time_asc",n.SESSION_CREATE_TIME_DSC="session_create_time_dsc",n.AGENT_SESSION_CREATE_TIME_ASC="agent_session_create_time_asc",n.AGENT_SESSION_CREATE_TIME_DSC="agent_session_create_time_dsc",n.AGENT_SESSION_RESOLVED_TIME_ASC="agent_session_resolved_time_asc",n.AGENT_SESSION_RESOLVED_TIME_DSC="agent_session_resolved_time_dsc"},nSbf:function(e,t,i){"use strict";i.d(t,"a",function(){return u});var n=i("8Y7J"),a=i("fYbj"),s=i("NdQK"),o=i("7Siu"),r=i("HsDr"),c=i("B23V"),l=i("SVse"),d=i("w13q");function h(e,t){if(1&e){const e=n.Zb();n.Yb(0,"fl-emoji",5),n.nc("click",function(){n.Qc(e);const i=t.$implicit;return n.rc(2).handleEmojiPick(i)}),n.Xb()}if(2&e){const e=t.$implicit,i=n.rc(2);n.zc("emoji",e)("size",i.EmojiSize.SMALL)}}function g(e,t){if(1&e&&(n.Yb(0,"fl-bit",3),n.ad(1,h,1,2,"fl-emoji",4),n.Xb()),2&e){const e=n.rc();n.Gb(1),n.zc("ngForOf",e.emojiLongnameList)("ngForTrackBy",e.trackByValue)}}let u=(()=>{class e{constructor(e){this.elementRef=e,this.EmojiSize=s.b,this.IconColor=r.c,this.IconSize=r.e,this.HoverColor=r.a,this.trackByValue=a.n,this.disabled=!1,this.pickerSize=r.e.SMALL,this.emojiPicked=new n.n,this.emojiLongnameList=o.c,this.emojiPickerIsOpen=!1}handleClickOutsideEmojiPicker(e){this.emojiPickerIsOpen&&!this.elementRef.nativeElement.contains(e.target)&&(this.emojiPickerIsOpen=!1)}handleEmojiPick(e){this.emojiPickerIsOpen=!1,this.emojiPicked.emit(e)}handleEmojiButtonClick(){this.emojiPickerIsOpen=!this.emojiPickerIsOpen}}return e.\u0275fac=function(t){return new(t||e)(n.Sb(n.l))},e.\u0275cmp=n.Mb({type:e,selectors:[["fl-emoji-picker"]],hostBindings:function(e,t){1&e&&n.nc("click",function(e){return t.handleClickOutsideEmojiPicker(e)},!1,n.Oc)},inputs:{disabled:"disabled",pickerSize:"pickerSize"},outputs:{emojiPicked:"emojiPicked"},decls:3,vars:6,consts:function(){let e;return e="Pick an emoji",[["flTrackingLabel","emojiPicker","data-uitest-target","emojipicker-button",3,"disabled","click"],["label",e,3,"color","size","hoverColor","name"],["class","EmojiPicker-card","data-uitest-target","emojipicker",4,"ngIf"],["data-uitest-target","emojipicker",1,"EmojiPicker-card"],["class","EmojiPicker-item",3,"emoji","size","click",4,"ngFor","ngForOf","ngForTrackBy"],[1,"EmojiPicker-item",3,"emoji","size","click"]]},template:function(e,t){1&e&&(n.Yb(0,"fl-button",0),n.nc("click",function(){return t.handleEmojiButtonClick()}),n.Tb(1,"fl-icon",1),n.Xb(),n.ad(2,g,2,2,"fl-bit",2)),2&e&&(n.zc("disabled",t.disabled),n.Gb(1),n.zc("color",t.disabled?t.IconColor.MID:t.IconColor.DARK)("size",t.pickerSize)("hoverColor",t.HoverColor.PRIMARY)("name","ui-smile-outline"),n.Gb(1),n.zc("ngIf",t.emojiPickerIsOpen))},directives:[c.b,r.d,l.q,d.a,l.p,s.a],styles:["[_nghost-%COMP%]{position:relative}.EmojiPicker-card[_ngcontent-%COMP%]{align-items:center;background:#fff;border-radius:0;bottom:24px;box-shadow:0 0 4px 0 rgba(0,0,0,.08),0 2px 4px 0 rgba(0,0,0,.12);display:flex;flex-wrap:wrap;height:140px;overflow-y:hidden;padding:8px;position:absolute;right:0;width:130px;z-index:1030}.EmojiPicker-item[_ngcontent-%COMP%]{cursor:pointer;padding:4px}.EmojiPicker-item[_ngcontent-%COMP%]:hover{background-color:#56c7ff;border-radius:0}.EmojiPicker-container[_ngcontent-%COMP%]{height:24px;position:relative;width:24px}"],changeDetection:0}),e})()},"puO/":function(e,t,i){"use strict";i.d(t,"a",function(){return g}),i.d(t,"b",function(){return u});var n=i("8Y7J"),a=i("v5ZQ");function s(e,t){if(1&e&&n.Tb(0,"app-messaging-context-box",9),2&e){const e=n.rc(2);n.zc("flHide",e.currentScreen!==e.CurrentScreen.THREAD_VIEW)("contextBoxState",e.contextBoxState)}}function o(e,t){if(1&e){const e=n.Zb();n.Yb(0,"app-messaging-thread-view",10),n.nc("click",function(){n.Qc(e);const t=n.rc(2);return t.focusChat.emit(t.threadIdentifier)})("previewModalOpen",function(){return n.Qc(e),n.rc(2).unfocusChat.emit()})("previewModalClose",function(){n.Qc(e);const t=n.rc(2);return t.focusChat.emit(t.threadIdentifier)})("usersTyping",function(){return n.Qc(e),n.rc(2).markAsRead.emit()}),n.Xb()}if(2&e){const e=n.rc(2);n.zc("flHide",e.currentScreen!==e.CurrentScreen.THREAD_VIEW)("allChatMembers",e.allChatMembers)("loggedInUser",e.loggedInUser)("isLoggedInUserSupportAgent",e.isLoggedInUserSupportAgent)("membersActivityStatus",e.membersActivityStatus)("thread",e.thread)("threadIdentifier",e.threadIdentifier)}}function r(e,t){if(1&e){const e=n.Zb();n.Yb(0,"app-messaging-chat-details",11),n.nc("makingCall",function(t){return n.Qc(e),n.rc(2).makingCall.emit(t)})("showAddPeopleScreen",function(){return n.Qc(e),n.rc(2).showAddPeopleScreen()}),n.Xb()}if(2&e){const e=n.rc(2);n.zc("callsEnabled",e.callsEnabled)("contextBoxState",e.contextBoxState)("isLoggedInUserSupportAgent",e.isLoggedInUserSupportAgent)("isLoggedInUserThreadOwner",e.isLoggedInUserThreadOwner)("loggedInUser",e.loggedInUser)("otherMembers",e.activeOtherMembers)("supportAgent",e.supportAgent)("team",e.team)("thread",e.thread)("threadBidders",e.threadBidders)("threadCollaborators",e.threadCollaborators)("threadContacts",e.threadContacts)}}function c(e,t){if(1&e){const e=n.Zb();n.Yb(0,"app-messaging-add-people",12),n.nc("hideAddPeopleScreen",function(){return n.Qc(e),n.rc(2).showChatDetails()})("addChatMembers",function(t){return n.Qc(e),n.rc(2).addChatMembers.emit(t)}),n.Xb()}if(2&e){const e=n.rc(2);n.zc("chatboxMode",!0)("isLoggedInUserSupportAgent",e.isLoggedInUserSupportAgent)("threadBidders",e.threadBidders)("threadCollaborators",e.threadCollaborators)("threadContacts",e.threadContacts)}}function l(e,t){if(1&e){const e=n.Zb();n.Yb(0,"app-messaging-chat-onboarding",13),n.nc("closeOnboarding",function(){return n.Qc(e),n.rc(2).closeOnboarding.emit()}),n.Xb()}if(2&e){const e=n.rc(2);n.zc("otherMember",e.privateChatOtherUser)("project",e.project)("thread",e.thread)("isHourlyProject",e.isHourlyProject)}}const d=function(e,t){return{"HeaderBorder-light":e,"HeaderBorder-dark":t}};function h(e,t){if(1&e){const e=n.Zb();n.Yb(0,"fl-bit",1),n.Yb(1,"fl-bit",2),n.Yb(2,"app-messaging-header",3),n.nc("click",function(){n.Qc(e);const t=n.rc();return t.minimiseChat.emit(t.threadIdentifier)})("closeChat",function(){n.Qc(e);const t=n.rc();return t.closeChat.emit(t.threadIdentifier)})("hideChatDetails",function(){return n.Qc(e),n.rc().showThreadView()})("hideAddPeopleScreen",function(){return n.Qc(e),n.rc().hideAddPeopleScreen()})("showChatDetails",function(){return n.Qc(e),n.rc().showChatDetails()})("toggleSize",function(){n.Qc(e);const t=n.rc();return t.toggleSize.emit(t.threadIdentifier)}),n.Xb(),n.Xb(),n.ad(3,s,1,2,"app-messaging-context-box",4),n.ad(4,o,1,7,"app-messaging-thread-view",5),n.ad(5,r,1,12,"app-messaging-chat-details",6),n.ad(6,c,1,5,"app-messaging-add-people",7),n.ad(7,l,1,4,"app-messaging-chat-onboarding",8),n.Xb()}if(2&e){const e=n.rc();n.Gb(1),n.zc("ngClass",n.Fc(16,d,!e.isFocused,e.isFocused)),n.Gb(1),n.zc("contextBoxState",e.contextBoxState)("currentScreen",e.currentScreen)("isFocused",e.isFocused)("isMinimised",e.isMinimised)("isOnboarding",e.showOnboarding)("loggedInUser",e.loggedInUser)("membersActivityStatus",e.membersActivityStatus)("otherMembers",e.activeOtherMembers)("supportAgent",e.supportAgent)("thread",e.thread),n.Gb(1),n.zc("ngIf",!e.showOnboarding),n.Gb(1),n.zc("ngIf",!e.showOnboarding),n.Gb(1),n.zc("ngIf",e.currentScreen===e.CurrentScreen.CHAT_DETAILS&&!e.isMinimised),n.Gb(1),n.zc("ngIf",e.currentScreen===e.CurrentScreen.ADD_PEOPLE&&!e.isMinimised),n.Gb(1),n.zc("ngIf",e.showOnboarding&&e.privateChatOtherUser)}}var g=function(e){return e[e.THREAD_VIEW=0]="THREAD_VIEW",e[e.CHAT_DETAILS=1]="CHAT_DETAILS",e[e.ADD_PEOPLE=2]="ADD_PEOPLE",e}({});let u=(()=>{class e{constructor(){this.CurrentScreen=g,this.addChatMembers=new n.n,this.closeChat=new n.n,this.closeOnboarding=new n.n,this.focusChat=new n.n,this.unfocusChat=new n.n,this.minimiseChat=new n.n,this.toggleSize=new n.n,this.markAsRead=new n.n,this.makingCall=new n.n,this.currentScreen=g.THREAD_VIEW}showThreadView(){this.currentScreen=g.THREAD_VIEW}showChatDetails(){this.currentScreen=g.CHAT_DETAILS}showAddPeopleScreen(){this.currentScreen=g.ADD_PEOPLE}hideAddPeopleScreen(){this.messagingAddPeopleComponent.clearSelectedUsers(),this.showChatDetails()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=n.Mb({type:e,selectors:[["app-messaging-chat-box"]],viewQuery:function(e,t){if(1&e&&n.jd(a.a,1),2&e){let e;n.Mc(e=n.oc())&&(t.messagingAddPeopleComponent=e.first)}},inputs:{activeOtherMembers:"activeOtherMembers",allChatMembers:"allChatMembers",contextBoxState:"contextBoxState",callsEnabled:"callsEnabled",isFocused:"isFocused",isHourlyProject:"isHourlyProject",isLoggedInUserSupportAgent:"isLoggedInUserSupportAgent",isLoggedInUserThreadOwner:"isLoggedInUserThreadOwner",isMinimised:"isMinimised",loggedInUser:"loggedInUser",membersActivityStatus:"membersActivityStatus",privateChatOtherUser:"privateChatOtherUser",project:"project",supportAgent:"supportAgent",showOnboarding:"showOnboarding",team:"team",thread:"thread",threadBidders:"threadBidders",threadCollaborators:"threadCollaborators",threadContacts:"threadContacts",threadIdentifier:"threadIdentifier"},outputs:{addChatMembers:"addChatMembers",closeChat:"closeChat",closeOnboarding:"closeOnboarding",focusChat:"focusChat",unfocusChat:"unfocusChat",minimiseChat:"minimiseChat",toggleSize:"toggleSize",markAsRead:"markAsRead",makingCall:"makingCall"},decls:1,vars:1,consts:[["class","ChatBox","flTrackingSection","Chatbox",4,"ngIf"],["flTrackingSection","Chatbox",1,"ChatBox"],[1,"HeaderBorder",3,"ngClass"],[3,"contextBoxState","currentScreen","isFocused","isMinimised","isOnboarding","loggedInUser","membersActivityStatus","otherMembers","supportAgent","thread","click","closeChat","hideChatDetails","hideAddPeopleScreen","showChatDetails","toggleSize"],[3,"flHide","contextBoxState",4,"ngIf"],["class","ChatBox-threadView",3,"flHide","allChatMembers","loggedInUser","isLoggedInUserSupportAgent","membersActivityStatus","thread","threadIdentifier","click","previewModalOpen","previewModalClose","usersTyping",4,"ngIf"],["class","ChatDetails-content",3,"callsEnabled","contextBoxState","isLoggedInUserSupportAgent","isLoggedInUserThreadOwner","loggedInUser","otherMembers","supportAgent","team","thread","threadBidders","threadCollaborators","threadContacts","makingCall","showAddPeopleScreen",4,"ngIf"],[3,"chatboxMode","isLoggedInUserSupportAgent","threadBidders","threadCollaborators","threadContacts","hideAddPeopleScreen","addChatMembers",4,"ngIf"],[3,"otherMember","project","thread","isHourlyProject","closeOnboarding",4,"ngIf"],[3,"flHide","contextBoxState"],[1,"ChatBox-threadView",3,"flHide","allChatMembers","loggedInUser","isLoggedInUserSupportAgent","membersActivityStatus","thread","threadIdentifier","click","previewModalOpen","previewModalClose","usersTyping"],[1,"ChatDetails-content",3,"callsEnabled","contextBoxState","isLoggedInUserSupportAgent","isLoggedInUserThreadOwner","loggedInUser","otherMembers","supportAgent","team","thread","threadBidders","threadCollaborators","threadContacts","makingCall","showAddPeopleScreen"],[3,"chatboxMode","isLoggedInUserSupportAgent","threadBidders","threadCollaborators","threadContacts","hideAddPeopleScreen","addChatMembers"],[3,"otherMember","project","thread","isHourlyProject","closeOnboarding"]],template:function(e,t){1&e&&n.ad(0,h,8,19,"fl-bit",0),2&e&&n.zc("ngIf",t.threadIdentifier)},styles:[".ChatBox[_ngcontent-%COMP%]{background:#fff;display:flex;flex-flow:column;height:100%;padding-bottom:env(safe-area-inset-bottom);width:100%}.ChatBox-threadView[_ngcontent-%COMP%]{height:calc(100% - 56px - 48px)}.HeaderBorder[_ngcontent-%COMP%]{transition:border-color .3s linear}.HeaderBorder-dark[_ngcontent-%COMP%]{border-left:2px solid #0e1724;border-top:2px solid #0e1724}.HeaderBorder-light[_ngcontent-%COMP%]{border-left:2px solid #4d525b;border-top:2px solid #4d525b}"],changeDetection:0}),e})()},rurT:function(e,t,i){"use strict";i.d(t,"a",function(){return ke});var n=i("mrSG"),a=i("8Y7J"),s=i("4BSF"),o=i("97vJ"),r=i("fVXH"),c=i("3f1L"),l=i("riYv"),d=i("etQe"),h=i("UlxN"),g=i("tlTr"),u=i("7v0r"),b=i("9Aot"),f=i("4ykm"),p=i("2zwU"),m=i("Rnop"),C=i("o9eT"),M=i("f6cb"),S=i("tsv4"),x=i("DXEH"),y=i("ueDg"),T=i("n0rP"),I=i("b6KT"),O=i("XNiG"),v=i("2Vo4"),A=i("itXk"),w=i("VRyK"),k=i("LRne"),z=i("05l1"),E=i("x+ZX"),L=i("lJxs"),_=i("/uUt"),j=i("pLZG"),P=i("vkgz"),R=i("zp1y"),B=i("CqXF"),$=i("JX91"),U=i("IzEk"),G=i("5+tZ"),N=i("MmDv"),F=i("eCtd"),D=i("w792"),X=i("/wLE"),Y=i("C825"),H=i("WEYi"),V=i("DsW6"),Q=i("3A0Z"),W=i("YFxV"),q=i("LE8X"),K=i("HEOu"),Z=i("L1P6");const J=["typingBox"],ee=["onboardingOverlay"],te=["chatOptionsDrawer"];function ie(e,t){if(1&e){const e=a.Zb();a.Yb(0,"app-header",11),a.nc("click",function(){return a.Qc(e),a.rc().toggleMinimised()})("closeChat",function(){return a.Qc(e),a.rc().close()})("handleSettingsHeaderClick",function(){a.Qc(e);const t=a.rc();return t.toggleOverlay(t.Overlay.SETTINGS)})("handleGroupchatHeaderClick",function(){a.Qc(e);const t=a.rc();return t.toggleOverlay(t.Overlay.GROUP)})("makingCall",function(t){return a.Qc(e),a.rc().passMakingCallState(t)}),a.sc(1,"flAsync"),a.sc(2,"flAsync"),a.sc(3,"flAsync"),a.sc(4,"flAsync"),a.sc(5,"flAsync"),a.sc(6,"flAsync"),a.sc(7,"flAsync"),a.sc(8,"flAsync"),a.sc(9,"flAsync"),a.sc(10,"flAsync"),a.sc(11,"flAsync"),a.sc(12,"flAsync"),a.sc(13,"flAsync"),a.Xb()}if(2&e){const e=a.rc();a.zc("callsEnabled",a.tc(1,16,e.callsEnabled$))("isMinimised",e.isMinimised)("thread",a.tc(2,18,e.attributes.thread$))("project",a.tc(3,20,e.projectDoc.valueChanges()))("contest",a.tc(4,22,e.contestDoc.valueChanges()))("agentSession",a.tc(5,24,e.agentSession$))("currentUserId",a.tc(6,26,e.currentUserId$))("currentUser",a.tc(7,28,e.currentUser$))("otherMembers",a.tc(8,30,e.otherMembers$))("onlineOfflineStatuses$",e.onlineOfflineStatuses$)("focusState",e.attributes.focus)("isThreadOwner",a.tc(9,32,e.isThreadOwner$))("candidatesExist",a.tc(10,34,e.candidatesExist$))("team",a.tc(11,36,e.team$))("isUserSupportAgent",a.tc(12,38,e.isUserSupportAgent$))("supportAgentMembers",a.tc(13,40,e.supportAgentMembers$))}}function ne(e,t){if(1&e){const e=a.Zb();a.Yb(0,"app-messaging-inbox-header",12),a.nc("chatOptionsDrawerToggle",function(t){return a.Qc(e),a.rc().handleChatOptionsDrawerToggle(t)}),a.sc(1,"flAsync"),a.sc(2,"flAsync"),a.sc(3,"flAsync"),a.sc(4,"flAsync"),a.Xb()}if(2&e){const e=a.rc();a.zc("emptyState",!1)("isOnline",a.tc(1,6,e.onlineOffline$))("contextBoxState",a.tc(2,8,e.contextBoxState$))("isGroupChatThread",a.tc(3,10,e.isGroupChatThread$))("otherMembers",a.tc(4,12,e.otherMembers$))("flHideDesktop",!0)}}function ae(e,t){if(1&e&&(a.Yb(0,"fl-bit"),a.Tb(1,"app-context-box",20),a.Xb()),2&e){const e=t.$implicit,i=a.rc(3);a.Gb(1),a.zc("chatBoxMode",i.chatBoxMode)("state",e)}}function se(e,t){if(1&e&&(a.Wb(0),a.ad(1,ae,2,2,"fl-bit",6),a.sc(2,"flAsync"),a.Vb()),2&e){const e=a.rc(2);a.Gb(1),a.zc("ngIf",a.tc(2,1,e.contextBoxState$))}}function oe(e,t){1&e&&(a.ic(0,25,1),a.Ub(1),a.fc())}function re(e,t){1&e&&(a.ic(0,25,2),a.Ub(1),a.fc())}function ce(e,t){1&e&&(a.ic(0,25,3),a.Wb(1),a.Tb(2,"fl-link",28),a.Vb(),a.fc()),2&e&&(a.Gb(2),a.zc("link","/support/"))}function le(e,t){if(1&e){const e=a.Zb();a.Yb(0,"app-error-alert",24),a.nc("close",function(){return a.Qc(e),a.rc(3).clearThreadError()}),a.ic(1,25),a.Wb(2,21),a.ad(3,oe,2,0,"ng-container",26),a.ad(4,re,2,0,"ng-container",26),a.ad(5,ce,3,1,"ng-container",27),a.Vb(),a.fc(),a.Xb()}if(2&e){const e=a.rc(3);a.Gb(2),a.zc("ngSwitch",e.error.code),a.Gb(1),a.zc("ngSwitchCase",e.ChatOperationError.FORBIDDEN),a.Gb(1),a.zc("ngSwitchCase",e.ChatOperationError.MESSAGE_REQUIRED)}}function de(e,t){1&e&&(a.ic(0,29,1),a.Ub(1),a.fc())}function he(e,t){1&e&&(a.ic(0,29,2),a.Wb(1),a.Tb(2,"fl-link",28),a.Vb(),a.fc()),2&e&&(a.Gb(2),a.zc("link","/support/"))}function ge(e,t){if(1&e){const e=a.Zb();a.Yb(0,"app-error-alert",24),a.nc("close",function(){return a.Qc(e),a.rc(3).clearThreadError()}),a.ic(1,29),a.Wb(2,21),a.ad(3,de,2,0,"ng-container",26),a.ad(4,he,3,1,"ng-container",27),a.Vb(),a.fc(),a.Xb()}if(2&e){const e=a.rc(3);a.Gb(2),a.zc("ngSwitch",e.error.code),a.Gb(1),a.zc("ngSwitchCase",e.ChatOperationError.FORBIDDEN)}}function ue(e,t){if(1&e&&(a.Yb(0,"fl-bit",21),a.ad(1,le,6,3,"app-error-alert",22),a.ad(2,ge,5,2,"app-error-alert",23),a.Xb()),2&e){const e=a.rc(2);a.zc("ngSwitch",null==e.error?null:e.error.operation),a.Gb(1),a.zc("ngSwitchCase",e.ChatOperation.SEND_MESSAGE)}}const be=function(e){return{"Inbox-typingBox":e}};function fe(e,t){if(1&e){const e=a.Zb();a.Yb(0,"app-typing-box",30,31),a.nc("sendMessage",function(t){return a.Qc(e),a.rc(2).enqueueMessage(t)})("typingEvent",function(t){return a.Qc(e),a.rc(2).handleTypingEvent(t)})("focusTypingBox",function(){return a.Qc(e),a.rc(2).focusTypingBox()})("addAttachment",function(t){return a.Qc(e),a.rc(2).handleAddAttachment(t)}),a.sc(2,"flAsync"),a.Xb()}if(2&e){const e=a.rc(2);a.zc("ngClass",a.Ec(11,be,!e.chatBoxMode))("isChatBoxMode",e.chatBoxMode)("hasAttachments",e.messageAttachments.length>0)("thread",a.tc(2,9,e.attributes.thread$))("threadIdentifierKey",e.threadIdentifierKey)("flMarginBottom",e.Margin.NONE)("flSticky",!e.chatBoxMode)("flStickyBehaviour",e.StickyBehaviour.ALWAYS)("flStickyPosition",e.StickyPosition.BOTTOM)}}function pe(e,t){if(1&e&&(a.Yb(0,"fl-banner-alert",32),a.cc(1,33),a.Xb()),2&e){const e=a.rc(2);a.zc("type",e.BannerAlertType.WARNING)("closeable",!1)("flMarginBottom",e.Margin.XXSMALL)}}const me=function(e){return{"Inbox-wrapper":e}};function Ce(e,t){if(1&e){const e=a.Zb();a.Yb(0,"fl-file-select",13),a.nc("onFileDropped",function(t){return a.Qc(e),a.rc().handleAddAttachment(t)}),a.sc(1,"flAsync"),a.ad(2,se,3,3,"ng-container",6),a.Yb(3,"app-message-list",14),a.nc("previewModalClose",function(){a.Qc(e);const t=a.rc();return t.focusClick.emit(t.attributes.threadIdentifier)})("previewModalOpen",function(){return a.Qc(e),a.rc().blurClick.emit()})("resendMessage",function(t){return a.Qc(e),a.rc().handleMessageResend(t)})("loadMoreMessages",function(){return a.Qc(e),a.rc().handleLoadMessages()}),a.sc(4,"flAsync"),a.sc(5,"flAsync"),a.sc(6,"flAsync"),a.sc(7,"flAsync"),a.sc(8,"flAsync"),a.sc(9,"flAsync"),a.sc(10,"flAsync"),a.sc(11,"flAsync"),a.Xb(),a.Yb(12,"fl-bit",15),a.Yb(13,"app-attachment-list",16),a.nc("removeAttachment",function(t){return a.Qc(e),a.rc().handleRemoveAttachment(t)})("removeUpload",function(t){return a.Qc(e),a.rc().handleRemoveUpload(t)}),a.sc(14,"flAsync"),a.sc(15,"flAsync"),a.Xb(),a.ad(16,ue,3,2,"fl-bit",17),a.ad(17,fe,3,13,"app-typing-box",18),a.sc(18,"flAsync"),a.sc(19,"flAsync"),a.ad(20,pe,2,3,"fl-banner-alert",19),a.sc(21,"flAsync"),a.sc(22,"flAsync"),a.Xb(),a.Xb()}if(2&e){const e=a.rc();let t=null,i=null;a.zc("multiple",!0)("active",!e.attributes.threadIdentifier.isFake&&a.tc(1,20,e.fileUploadEnabled$)),a.Gb(2),a.zc("ngIf",e.chatBoxMode),a.Gb(1),a.zc("currentUserId",a.tc(4,22,e.currentUserId$))("usersTyping",e.usersTyping)("members",a.tc(5,24,e.allChatMembers$))("messages",a.tc(6,26,e.sortedMessages$))("otherMembers",a.tc(7,28,e.otherMembers$))("thread",a.tc(8,30,e.attributes.thread$))("chatBoxMode",e.chatBoxMode)("canLoadMore",a.tc(9,32,e.canLoadMore$))("showLoadingMoreSpinner",a.tc(10,34,e.messagesLoadingMore$))("useThumbnailService",a.tc(11,36,e.useThumbnailService$)),a.Gb(9),a.zc("ngClass",a.Ec(50,me,!e.chatBoxMode)),a.Gb(1),a.zc("thread",a.tc(14,38,e.attributes.thread$))("attachments",e.messageAttachments)("uploads",a.tc(15,40,e.uploads$)),a.Gb(3),a.zc("ngIf",e.error),a.Gb(1),a.zc("ngIf",a.tc(18,42,e.isUserSupportAgent$)||"none"!==(null==(t=a.tc(19,44,e.attributes.thread$))?null:t.writePrivacy)),a.Gb(3),a.zc("ngIf",!a.tc(21,46,e.isUserSupportAgent$)&&"none"===(null==(i=a.tc(22,48,e.attributes.thread$))?null:i.writePrivacy))}}function Me(e,t){if(1&e){const e=a.Zb();a.Yb(0,"app-onboarding-overlay",37,38),a.nc("closeOverlay",function(){return a.Qc(e),a.rc(2).closeOnboardingOverlay()}),a.sc(2,"flAsync"),a.sc(3,"flAsync"),a.sc(4,"flAsync"),a.sc(5,"flAsync"),a.Xb()}if(2&e){const e=a.rc(2);a.zc("hourlyContracts",a.tc(2,4,e.hourlyContracts$))("thread",a.tc(3,6,e.attributes.thread$))("otherMembers",a.tc(4,8,e.otherMembers$))("project",a.tc(5,10,e.projectDoc.valueChanges()))}}function Se(e,t){if(1&e){const e=a.Zb();a.Yb(0,"app-groupchat-overlay",39),a.nc("hideGroupchatOverlay",function(){a.Qc(e);const t=a.rc(2);return t.toggleOverlay(t.Overlay.GROUP)})("modifyMembers",function(t){return a.Qc(e),a.rc(2).modifyMembers(t)}),a.sc(1,"flAsync"),a.sc(2,"flAsync"),a.sc(3,"flAsync"),a.sc(4,"flAsync"),a.sc(5,"flAsync"),a.sc(6,"flAsync"),a.sc(7,"flAsync"),a.sc(8,"flAsync"),a.sc(9,"flAsync"),a.sc(10,"flAsync"),a.sc(11,"flAsync"),a.Xb()}if(2&e){const e=a.rc(2);a.zc("participants",a.tc(1,12,e.members$))("isThreadOwner",a.tc(2,14,e.isThreadOwner$))("isRecruiter",a.tc(3,16,e.isUserSupportAgent$))("candidatesExist",a.tc(4,18,e.candidatesExist$))("currentUser",a.tc(5,20,e.currentUser$))("candidateBidders",a.tc(6,22,e.bidders$))("candidateContacts",a.tc(7,24,e.contacts$))("candidateCollaborators",a.tc(8,26,e.collaborators$))("onlineOfflineStatuses$",e.onlineOfflineStatuses$)("thread",a.tc(9,28,e.attributes.thread$))("team",a.tc(10,30,e.team$))("showAddPeopleOption",a.tc(11,32,e.showAddPeopleOption$))}}function xe(e,t){if(1&e){const e=a.Zb();a.Yb(0,"app-settings-overlay",40),a.nc("archiveChatToggle",function(){return a.Qc(e),a.rc(2).archiveChatToggle()})("blockChatToggle",function(){return a.Qc(e),a.rc(2).blockChatToggle()})("muteChatToggle",function(){return a.Qc(e),a.rc(2).muteChatToggle()})("hideSettingsOverlay",function(){a.Qc(e);const t=a.rc(2);return t.toggleOverlay(t.Overlay.SETTINGS)}),a.sc(1,"flAsync"),a.sc(2,"flAsync"),a.Xb()}if(2&e){const e=a.rc(2);a.zc("showReportCta",a.tc(1,2,e.showReportCta$))("thread",a.tc(2,4,e.attributes.thread$))}}function ye(e,t){if(1&e&&(a.Wb(0),a.ad(1,Me,6,12,"app-onboarding-overlay",34),a.sc(2,"flAsync"),a.ad(3,Se,12,34,"app-groupchat-overlay",35),a.sc(4,"flAsync"),a.ad(5,xe,3,6,"app-settings-overlay",36),a.sc(6,"flAsync"),a.Vb()),2&e){const e=a.rc();a.Gb(1),a.zc("ngIf",a.tc(2,3,e.showOnboardingOverlay$)),a.Gb(2),a.zc("ngIf","group"===e.activeOverlay&&!a.tc(4,5,e.showOnboardingOverlay$)),a.Gb(2),a.zc("ngIf","settings"===e.activeOverlay&&!a.tc(6,7,e.showOnboardingOverlay$))}}function Te(e,t){if(1&e){const e=a.Zb();a.Yb(0,"app-messaging-sidebar",41),a.nc("archiveChatToggle",function(){return a.Qc(e),a.rc().archiveChatToggle()})("blockChatToggle",function(){return a.Qc(e),a.rc().blockChatToggle()})("muteChatToggle",function(){return a.Qc(e),a.rc().muteChatToggle()})("userAdd",function(){return a.Qc(e),a.rc().popManagementModal()})("userRemove",function(t){return a.Qc(e),a.rc().handleUserRemoved(t)}),a.sc(1,"flAsync"),a.sc(2,"flAsync"),a.sc(3,"flAsync"),a.sc(4,"flAsync"),a.sc(5,"flAsync"),a.sc(6,"flAsync"),a.sc(7,"flAsync"),a.sc(8,"flAsync"),a.sc(9,"flAsync"),a.sc(10,"flAsync"),a.Xb()}if(2&e){const e=a.rc();a.zc("candidatesExist",a.tc(1,14,e.candidatesExist$))("contextBoxState",a.tc(2,16,e.contextBoxState$))("currentUser",a.tc(3,18,e.currentUser$))("isRecruiter",a.tc(4,20,e.isUserSupportAgent$))("isThreadOwner",a.tc(5,22,e.isThreadOwner$))("onlineOfflineStatuses$",e.onlineOfflineStatuses$)("showReportCta",a.tc(6,24,e.showReportCta$))("thread",a.tc(7,26,e.attributes.thread$))("threadId$",e.threadId$)("members",a.tc(8,28,e.members$))("team",a.tc(9,30,e.team$))("showAddPeopleOption",a.tc(10,32,e.showAddPeopleOption$))("flHideTablet",!0)("flHideMobile",!0)}}function Ie(e,t){if(1&e){const e=a.Zb();a.Yb(0,"app-messaging-sidebar",43),a.nc("archiveChatToggle",function(){return a.Qc(e),a.rc(2).archiveChatToggle()})("blockChatToggle",function(){return a.Qc(e),a.rc(2).blockChatToggle()})("muteChatToggle",function(){return a.Qc(e),a.rc(2).muteChatToggle()})("userAdd",function(){return a.Qc(e),a.rc(2).popManagementModal()})("userRemove",function(t){return a.Qc(e),a.rc(2).handleUserRemoved(t)}),a.sc(1,"flAsync"),a.sc(2,"flAsync"),a.sc(3,"flAsync"),a.sc(4,"flAsync"),a.sc(5,"flAsync"),a.sc(6,"flAsync"),a.sc(7,"flAsync"),a.sc(8,"flAsync"),a.sc(9,"flAsync"),a.sc(10,"flAsync"),a.Xb()}if(2&e){const e=a.rc(2);a.zc("candidatesExist",a.tc(1,12,e.candidatesExist$))("contextBoxState",a.tc(2,14,e.contextBoxState$))("currentUser",a.tc(3,16,e.currentUser$))("isRecruiter",a.tc(4,18,e.isUserSupportAgent$))("isThreadOwner",a.tc(5,20,e.isThreadOwner$))("onlineOfflineStatuses$",e.onlineOfflineStatuses$)("showReportCta",a.tc(6,22,e.showReportCta$))("thread",a.tc(7,24,e.attributes.thread$))("threadId$",e.threadId$)("members",a.tc(8,26,e.members$))("team",a.tc(9,28,e.team$))("showAddPeopleOption",a.tc(10,30,e.showAddPeopleOption$))}}function Oe(e,t){if(1&e&&a.ad(0,Ie,11,32,"app-messaging-sidebar",42),2&e){const e=a.rc();a.zc("ngIf",!e.chatBoxMode)}}var ve=function(e){return e.ARCHIVE_CHAT="archive-chat",e.BLOCK_CHAT="block-chat",e.MUTE_CHAT="mute-chat",e.SEND_MESSAGE="send-message",e}({}),Ae=function(e){return e.FORBIDDEN="FORBIDDEN",e.UNKNOWN="UNKNOWN_ERROR",e.MESSAGE_REQUIRED="MESSAGE_REQUIRED",e}({}),we=function(e){return e.GROUP="group",e.SETTINGS="settings",e}({});let ke=(()=>{class e{constructor(e,t,i,n,s,o,r,c,l,d,g,f){this.environment=e,this.datastore=t,this.auth=i,this.abtestService=n,this.fileUpload=s,this.webSocketService=o,this.tracking=r,this.modalService=c,this.timeUtils=l,this.userAgent=d,this.featureFlagService=g,this.localStorage=f,this.Margin=b.a,this.FontColor=m.a,this.FontWeight=C.c,this.TextSize=C.f,this.Overlay=we,this.TextAlign=C.d,this.BannerAlertType=u.c,this.ChatOperation=ve,this.ChatOperationError=Ae,this.Feature=h.b,this.StickyBehaviour=p.a,this.StickyPosition=p.c,this.closeChat=new a.n,this.minimiseChat=new a.n,this.makingCall=new a.n,this.emojiPickedSubject$=new O.a,this.blurClick=new a.n,this.focusClick=new a.n,this.chatBoxMode=!0,this.isMinimised=!1,this.usersTyping={},this.lastSentTyping=0,this.projectOverlayClosedSubject$=new v.a(!1),this.messageSendQueue=[],this.messageSendQueueSubject$=new v.a([]),this.messageSend$=this.messageSendQueueSubject$.asObservable().pipe(Object(z.a)(1),Object(E.a)()),this.messageErrorQueue=[],this.messageErrorQueueSubject$=new v.a([]),this.messageError$=this.messageErrorQueueSubject$.asObservable().pipe(Object(z.a)(1),Object(E.a)()),this.defaultLimit=50,this.limitIncreaseStep=50,this.maxLimit=5e3,this.currentLimit=this.defaultLimit,this.messagesLimitSubject$=new v.a(this.defaultLimit),this._showReportCta$=new v.a(!1),this.showReportCta$=this._showReportCta$.asObservable(),this.XXX_SKILL_ID=88,this.PROD_RECRUITER_USER_IDS_WHITELIST=[35863928,29840291,25020397,24369472],this.DEV_RECRUITER_USER_IDS_WHITELIST=[30760668,31624149]}ngOnInit(){this.fileUploadEnabled$=this.featureFlagService.getFlag(h.b.FILEUPLOAD),this.preAwardAudioCallFeatureEnabled$=this.featureFlagService.getFlag(h.b.PRE_AWARD_AUDIO_CALL),this.threadIdentifierKey=Object(I.d)(this.attributes.threadIdentifier),this.currentUserId$=this.auth.getUserId(),this.threadId$=this.attributes.thread$.pipe(Object(L.a)(e=>e.id),Object(_.a)()),this.isGroupChatThread$=this.attributes.thread$.pipe(Object(L.a)(e=>e.threadType===S.ThreadTypeApi.GROUP||e.threadType===S.ThreadTypeApi.TEAM)),this.useThumbnailService$=this.currentUserId$.pipe(Object(L.a)(e=>this.abtestService.isWhitelistUser()||this.abtestService.shouldEnrol("T90189-image-thumbnail-service",e,.01))),this.threadCloseSubscription=A.a([this.attributes.threadCollection.valueChanges(),this.attributes.thread$]).subscribe(([e,t])=>{0!==e.length||t.isFake||this.close()}),this.fileUploadSession=this.fileUpload.createSession(),this.files$=this.fileUploadSession.files$,this.uploads$=this.fileUploadSession.uploads$,this.messageAttachmentsSubscription=this.files$.subscribe(e=>this.messageAttachments=e),this.allChatMembers$=this.datastore.collection("users",this.attributes.thread$.pipe(Object(L.a)(e=>[...e.inactiveMembers.map(e=>e.toString()),...e.members.map(e=>e.toString())]))).valueChanges().pipe(Object(z.a)(1),Object(E.a)(),Object(o.a)()),this.onlineOfflineStatuses$=this.datastore.collection("onlineOffline",this.attributes.thread$.pipe(Object(L.a)(e=>e.members))).valueChanges(),this.members$=A.a([this.allChatMembers$,this.attributes.thread$]).pipe(Object(L.a)(([e,t])=>e.filter(e=>t.members.includes(e.id)))),this.nonGroupChat$=this.members$.pipe(Object(L.a)(e=>2===e.length)),this.currentUser$=A.a([this.members$,this.currentUserId$]).pipe(Object(L.a)(([e,t])=>e.find(e=>e.id===Object(M.r)(t))),Object(j.a)(M.g)),this.otherMembers$=A.a([this.members$,this.currentUserId$]).pipe(Object(L.a)(([e,t])=>e.filter(e=>e.id!==Object(M.r)(t)))),this.otherUserId$=this.otherMembers$.pipe(Object(L.a)(e=>e[0]),Object(j.a)(M.g),Object(L.a)(e=>e.id));const e=this.datastore.document("projectViewUsers",this.otherUserId$).valueChanges();this.onlineOffline$=this.datastore.document("onlineOffline",this.otherUserId$).valueChanges().pipe(Object(L.a)(e=>e.status===l.OnlineOfflineStatusApi.ONLINE)),this.isThreadOwner$=A.a([this.attributes.thread$,this.currentUserId$]).pipe(Object(L.a)(([e,t])=>!e.isFake&&e.owner===Object(M.r)(t))),this.agentSession$=this.datastore.collection("agentSessions",e=>e.where("sessionId","==",this.attributes.thread$.pipe(Object(L.a)(({context:e})=>e),Object(L.a)(e=>e&&e.type===S.ContextTypeApi.SUPPORT_SESSION?e.id:void 0),Object(j.a)(M.g)))).valueChanges().pipe(Object(L.a)(e=>e[0]),Object(j.a)(M.g)),this.supportAgentMembers$=this.datastore.collection("agents",e=>e.where("userId","in",this.members$.pipe(Object(L.a)(e=>e.map(e=>e.id)))).where("state","in",[T.AgentStateApi.AVAILABLE,T.AgentStateApi.AWAY,T.AgentStateApi.UNAVAILABLE])).valueChanges(),this.isUserSupportAgent$=A.a([this.currentUserId$.pipe(Object(L.a)(M.r),Object(j.a)(M.g)),this.supportAgentMembers$]).pipe(Object(L.a)(([e,t])=>t.some(t=>t.userId===e))),this.messagesCollection=this.datastore.collection("messages",e=>this.attributes.thread$.pipe(Object(j.a)(e=>!e.isFake&&e.id>0),Object(L.a)(e=>e.id),Object(_.a)(),Object(P.a)(()=>{this.currentLimit=this.defaultLimit,this.messagesLimitSubject$.next(this.currentLimit)}),Object(L.a)(t=>e.where("threadId","==",t).limit(this.messagesLimitSubject$.asObservable())))),this.messagesLoadingMore$=this.messagesCollection.status$.pipe(Object(L.a)(e=>!e.ready)),this.canLoadMore$=this.messagesCollection.valueChanges().pipe(Object(L.a)(e=>this.currentLimit<this.maxLimit&&e.length>=this.currentLimit)),this.sortedMessages$=A.a([A.a([this.messagesCollection.valueChanges(),this.messageError$,this.threadId$]).pipe(Object(L.a)(([e,t,i])=>{const n=t.filter(e=>e.threadId===i),a=new Set(e.map(e=>e.clientMessageId)),[s,o]=Object(M.p)(n,e=>a.has(e.clientMessageId));s.length>0&&(this.messageErrorQueue=[...o],this.messageErrorQueueSubject$.next(this.messageErrorQueue));const r=[...e,...o].sort((e,t)=>e.timeCreated===t.timeCreated?e.id-t.id:e.timeCreated-t.timeCreated),c={};return r.reduceRight((e,t)=>{const i=JSON.parse(JSON.stringify(t));return i.richMessage&&(c[i.richMessage.category]&&(i.richMessage.disabled=!0),c[i.richMessage.category]=!0),[i,...e]},[])})),this.messageSend$]).pipe(Object(L.a)(([e,t])=>{const i=new Set(e.map(e=>e.clientMessageId)),n=t.filter(e=>!i.has(e.clientMessageId));return e.concat(n)})),this.typingSubscription=this.webSocketService.fromServerStream$.pipe(Object(j.a)(r.a),Object(R.a)(this.threadId$),Object(j.a)(([e,t])=>"messages"===e.body.parent_type&&"typing"===e.body.type&&e.body.data.thread===t)).subscribe(([e,t])=>{this.usersTyping[e.body.data.from_user]=A.a([this.timeUtils.rxTimer(5e3).pipe(Object(B.a)(!1),Object($.a)(!0)),this.sortedMessages$.pipe(Object(L.a)(e=>e.filter(e=>e.sendStatus===d.a.SENT))),this.attributes.thread$.pipe(Object(L.a)(e=>e.userReadTimes))]).pipe(Object(L.a)(([t,i,n])=>{const a=e.body.data.from_user,s=i.pop();return t&&!!s&&n[a]>=s.timeCreated&&(s.fromUser!==a||1e3*e.body.timestamp>s.timeCreated)}))}),this.autochatTracking=this.sortedMessages$.subscribe(e=>{const t=e[e.length-1];t&&("autochat"===t.messageSource||t.richMessage&&t.richMessage.category&&t.richMessage.category.startsWith("AUTOCHAT"))&&"project"===this.attributes.threadIdentifier.context.type&&t.fromUser!==Object(M.r)(this.currentUserIdValue)&&this.tracking.track("user_action",{reference:"project_id",reference_id:this.attributes.threadIdentifier.context.id,section:"ProjectViewPage",subsection:"AutoChat",label:"ShowChatBox",name:"user_id",value:t.fromUser})}),this.contacts$=A.a([this.allContacts$,this.attributes.thread$]).pipe(Object(L.a)(([e,t])=>e.filter(e=>!t.members.includes(e.id)))),this.isDeloitteUser$=this.datastore.document("users",this.auth.getUserId()).valueChanges().pipe(Object(L.a)(e=>!!e.isDeloitteDcUser));const t=w.a(this.attributes.thread$.pipe(Object(L.a)(({context:e})=>e),Object(L.a)(e=>e&&e.type===S.ContextTypeApi.PROJECT?e.id:void 0),Object(j.a)(M.g)),this.agentSession$.pipe(Object(j.a)(e=>e.sessionSourceType===T.SourceTypeApi.PROJECT),Object(L.a)(e=>e.sessionSourceId)));this.projectDoc=this.datastore.document("threadProjects",t);const i=this.projectDoc.valueChanges().pipe(Object(L.a)(e=>e.ownerId)),n=A.a([i,this.otherUserId$,this.currentUser$.pipe(Object(L.a)(e=>Object(M.r)(e.id)))]).pipe(Object(L.a)(([e,t,i])=>e===i?t:i),Object(_.a)());this.userAwardedBidCollection=this.datastore.collection("bids",e=>e.where("projectId","==",t).where("awardStatus","==",y.BidAwardStatusApi.AWARDED).where("bidderId","==",n)),this.contestDoc=this.datastore.document("contests",this.attributes.thread$.pipe(Object(L.a)(({context:e})=>e),Object(j.a)(M.g),Object(j.a)(e=>"contest"===e.type),Object(L.a)(e=>"contest"===e.type&&e.id||void 0),Object(j.a)(M.g)));const a=this.datastore.collection("bids",e=>e.where("projectId","==",this.projectDoc.valueChanges().pipe(Object(L.a)(e=>e.id)))),g=A.a([a.valueChanges(),this.attributes.thread$]).pipe(Object(L.a)(([e,t])=>e.map(e=>e.bidderId).filter(e=>!t.members.includes(e)).filter(e=>void 0!==e)),Object(j.a)(e=>e.length>0)),u=this.datastore.collection("milestones",e=>A.a([this.projectDoc.valueChanges(),this.currentUserId$]).pipe(Object(L.a)(([i,n])=>i.ownerId===Object(M.r)(n)?e.where("projectId","==",t):e.where("projectId","==",t).where("bidderId","==",Object(M.r)(n))))),b=this.datastore.collection("milestoneRequests",e=>A.a([this.projectDoc.valueChanges(),this.currentUserId$]).pipe(Object(L.a)(([i,n])=>i.ownerId===Object(M.r)(n)?e.where("projectId","==",t):e.where("projectId","==",t).where("bidderId","==",Object(M.r)(n))))),f=this.datastore.collection("hourlyContracts",e=>e.where("projectId","==",this.projectDoc.valueChanges().pipe(Object(j.a)(M.g),Object(j.a)(e=>e.type===y.ProjectTypeApi.HOURLY),Object(L.a)(e=>e.id))).where("bidderId","==",n));this.hourlyContracts$=f.valueChanges();const p=this.datastore.collection("bids",e=>e.where("projectId","==",t).where("bidderId","==",n)),m=this.datastore.collection("invoices",e=>e.where("projectId","==",t).where("freelancerId","==",n).where("milestoneLinkedStatus","==",x.ProjectInvoiceMilestoneLinkedStatusesApi.UNLINKED).limit(1)),C=this.currentUserId$.pipe(Object(L.a)(e=>this.environment===s.d.PROD?this.PROD_RECRUITER_USER_IDS_WHITELIST.includes(Object(M.r)(e)):this.environment===s.d.DEV&&this.DEV_RECRUITER_USER_IDS_WHITELIST.includes(Object(M.r)(e))));this.stateManagerSubscription=C.subscribe(e=>{this.stateManager=new N.b(this.auth,this.attributes.thread$,this.members$,this.projectDoc.valueChanges(),this.contestDoc.valueChanges(),p.valueChanges(),u.valueChanges(),b.valueChanges(),this.hourlyContracts$,this.agentSession$,this.team$,m.valueChanges(),e?this.tracking:void 0)}),this.contextBoxState$=this.stateManager.getState(),this.bidders$=this.datastore.collection("users",g).valueChanges().pipe(Object(z.a)(1),Object(E.a)(),Object(o.a)());const O=A.a([this.projectDoc.valueChanges(),this.attributes.thread$]).pipe(Object(L.a)(([e,t])=>(e.projectCollaborations||[]).map(e=>e.userId||-1).filter(e=>e>0&&!t.members.includes(e))),Object(j.a)(e=>e.length>0));this.collaborators$=this.datastore.collection("users",O).valueChanges().pipe(Object(z.a)(1),Object(E.a)(),Object(o.a)());const v=this.userAwardedBidCollection.valueChanges().pipe(Object(L.a)(e=>e.length>0),Object($.a)(!1)),k=A.a([v,i,this.currentUserId$,e,this.preAwardAudioCallFeatureEnabled$]).pipe(Object(L.a)(([e,t,i,n,a])=>{const s=parseInt(i,10)===t;return!e&&s&&(n.preferredFreelancer&&n.status.freelancerVerifiedUser||a)}),Object($.a)(!1)),U=this.projectDoc.valueChanges().pipe(Object(L.a)(e=>!e.skills.map(e=>e.id).includes(this.XXX_SKILL_ID)),Object($.a)(!1)),G=this.datastore.document("membershipBenefits","free_pre_awarded_voip").valueChanges().pipe(Object(L.a)(e=>0!==e.value));this.callsEnabled$=Object(c.a)([v,this.nonGroupChat$,this.onlineOffline$,this.inCall$,this.isUserSupportAgent$,this.attributes.thread$,U,k,G,i,this.currentUserId$]).pipe(Object(L.a)(([e,t,i,n,a,s,o,r,c,l,d])=>{const h=this.attributes.threadIdentifier.isFake;let g="";if(t?a?g="":"none"===s.writePrivacy?g="Thread is blocked":e?i?this.isCallSupportedBrowser()?n?g="Already in a call":o?h&&(g="Start chatting to enable calls"):g="Not allowed for this project":g="Your browser is unsupported":g="The user is offline":g="Awarded and accepted projects only":g="Private chats only",a&&t)return{audio:{enabled:!0,recorded:!1},video:{enabled:!0,recorded:!1},reason:g};const u=t&&i&&this.isCallSupportedBrowser()&&!n&&"none"!==s.writePrivacy&&o&&!h,b=Object(M.r)(d)===l,f=u&&c&&b,p=("admin_preferred_chat"===s.threadType||!a)&&u;return{audio:{enabled:(e||r)&&p||f,recorded:r&&p},video:{enabled:!a&&"admin_preferred_chat"!==s.threadType&&e&&u||f,recorded:!1},reason:g}}),Object($.a)({audio:{enabled:!1,recorded:!1},video:{enabled:!1,recorded:!1}}),Object(z.a)(1),Object(E.a)()),this.candidatesExist$=A.a([this.contacts$,this.collaborators$,this.bidders$]).pipe(Object(L.a)(e=>e.some(e=>e.length>0))),this.showOnboardingOverlay$=A.a([this.projectOverlayClosedSubject$,a.valueChanges(),this.currentUserId$,this.attributes.thread$,this.localStorage.get("projectOverlayThreadComplete"),this.isDeloitteUser$]).pipe(Object(L.a)(([e,t,i,n,a,s])=>this.chatBoxMode&&!e&&"project"===n.context.type&&"private_chat"===n.threadType&&!(a&&a[n.id])&&void 0!==t.find(e=>e.bidderId===Object(M.r)(i))&&!s)),this.showAddPeopleOption$=A.a([this.attributes.thread$,this.team$.pipe(Object($.a)(void 0)),this.isThreadOwner$,this.isUserSupportAgent$,this.candidatesExist$]).pipe(Object(L.a)(([e,t,i,n,a])=>e.context.type!==S.ContextTypeApi.NONE&&(!!(e.context.type===S.ContextTypeApi.TEAM&&e.threadType!==S.ThreadTypeApi.TEAM_OFFICIAL||e.threadType===S.ThreadTypeApi.TEAM&&t)||e.threadType!==S.ThreadTypeApi.TEAM_OFFICIAL&&(i&&a||n))))}ngOnDestroy(){this.autochatTracking&&this.autochatTracking.unsubscribe(),this.threadCloseSubscription&&this.threadCloseSubscription.unsubscribe(),this.messageAttachmentsSubscription&&this.messageAttachmentsSubscription.unsubscribe(),this.typingSubscription&&this.typingSubscription.unsubscribe(),this.stateManagerSubscription&&this.stateManagerSubscription.unsubscribe()}onClick(){this.focusChatbox(),this.onboardingOverlay||this.markAsRead()}escCloseChat(e){"Escape"!==e.key||this.attributes.focus!==g.a.Header&&this.attributes.focus!==g.a.HeaderAndTypingBox||setTimeout(()=>this.close())}passMakingCallState(e){this.makingCall.emit(e)}closeOnboardingOverlay(){this.projectOverlayClosedSubject$.next(!0)}toggleMinimised(){this.minimiseChat.emit(this.attributes.threadIdentifier)}ngAfterViewInit(){this.attributes.focus&&this.focusTypingBox()}ngOnChanges(e){var t,i,n;"attributes"in e&&(this.isMinimised=e.attributes.currentValue.minimised,(null===(t=this.attributes)||void 0===t?void 0:t.focus)!==g.a.Neither&&(this.chatBoxMode&&(null===(i=e.attributes.previousValue)||void 0===i?void 0:i.focus)!==e.attributes.currentValue.focus||!this.chatBoxMode&&(null===(n=e.attributes.previousValue)||void 0===n?void 0:n.threadIdentifier)!==e.attributes.currentValue.threadIdentifier)&&this.markAsRead(),this.chatBoxMode||this.clearThreadError(),e.attributes.previousValue&&e.attributes.previousValue.threadIdentifier&&e.attributes.previousValue.threadIdentifier===e.attributes.currentValue.threadIdentifier||(this.threadIdentifierKey=Object(I.d)(e.attributes.currentValue.threadIdentifier),this.loadReportCta(e.attributes.currentValue.threadIdentifier)))}loadReportCta(e){e.context.type===S.ContextTypeApi.PROJECT?this.datastore.document("projectViewProjects",e.context.id).valueChanges().pipe(Object(L.a)(e=>{const t=e.projectCollaborations.some(e=>e.status===y.ProjectCollaborationStatusApi.ACTIVE&&e.userId===Object(M.r)(this.currentUserIdValue));return!(e.ownerId===Object(M.r)(this.currentUserIdValue)||t)}),Object(U.a)(1)).toPromise().then(e=>this._showReportCta$.next(e)):this._showReportCta$.next(!1)}handleMessageResend(e){const t=this.messageErrorQueue.findIndex(t=>t.clientMessageId===e.clientMessageId);t>=0&&(this.messageErrorQueue=[...this.messageErrorQueue.slice(0,t),...this.messageErrorQueue.slice(t+1)],this.messageErrorQueueSubject$.next(this.messageErrorQueue),this.enqueueMessage(e.message))}enqueueMessage(e){const t=Date.now(),i=this.attributes.threadIdentifier.isFake,n=void 0===e||0===e.trim().length;if(!i){const e=this.attributes.threadIdentifier.id.toString();this.fileUploadSession.send({endpoint:`messages/0.1/threads/${e}/messages/`,extraParams:{thread_id:e,client_message_id:t.toString()}})}i&&n&&this.messageAttachments.length>0?this.error={code:Ae.MESSAGE_REQUIRED,operation:ve.SEND_MESSAGE}:n||(this.messageSendQueue=[...this.messageSendQueue,{attachments:[],clientMessageId:t,fromUser:Object(M.r)(this.currentUserIdValue),id:t,message:e,messageSource:S.SourceTypeApi.CHAT_BOX,threadId:this.attributes.threadIdentifier.id,timeCreated:Date.now(),sendStatus:d.a.SENDING}],this.messageSendQueueSubject$.next(this.messageSendQueue),1===this.messageSendQueue.length&&this.sendQueuedMessage())}sendQueuedMessage(){if(0===this.messageSendQueue.length)return;const e=this.messageSendQueue[0];this.messageSendQueueSubject$.next(this.messageSendQueue),this.sendMessage(e).then(()=>{this.messageSendQueue=this.messageSendQueue.slice(1),this.messageSendQueueSubject$.next(this.messageSendQueue),this.sendQueuedMessage()}).catch(t=>{this.messageErrorQueue=[...this.messageErrorQueue,Object.assign(Object.assign({},e),{timeCreated:Date.now(),sendStatus:d.a.FAILED})],this.messageErrorQueueSubject$.next(this.messageErrorQueue),this.messageSendQueue=this.messageSendQueue.slice(1),this.messageSendQueueSubject$.next(this.messageSendQueue),this.sendQueuedMessage()})}sendMessage(e){return k.a(e).pipe(Object(R.a)(this.auth.getUserId(),this.attributes.thread$),Object(G.b)(([e,t,i])=>{if(!i.isFake)return this.messagesCollection.push(e).then(e=>{if("success"!==e.status)throw this.error={code:e.errorCode,operation:"send-message"},new Error(e.errorCode);this.error&&this.clearThreadError()});const n=Object(I.b)(i,e.message,Object(M.r)(t));return this.attributes.threadCollection.push(n).then(e=>{if("success"!==e.status)throw this.error={code:e.errorCode,operation:"send-message"},new Error(e.errorCode);return this.error&&this.clearThreadError(),e.id}).then(e=>{this.fileUploadSession.send({endpoint:`messages/0.1/threads/${e}/messages/`,extraParams:{thread_id:e.toString(),client_message_id:Date.now().toString()}})})})).toPromise()}focusChatbox(){this.focusClick.emit(this.attributes.threadIdentifier),this.focusTypingBox()}focusTypingBox(){this.isMinimised||!this.typingBox||this.attributes.focus!==g.a.Header&&this.attributes.focus!==g.a.HeaderAndTypingBox||this.typingBox.focus()}close(){this.closeChat.emit(this.attributes.threadIdentifier)}toggleOverlay(e){e===we.SETTINGS&&this.isMinimised&&this.toggleMinimised(),this.activeOverlay=this.chatBoxMode&&this.activeOverlay!==e?e:void 0}markAsRead(){k.a(this.attributes.threadIdentifier.isFake).pipe(Object(R.a)(this.attributes.thread$),Object(L.a)(([e,t])=>!(e||t.isRead&&0===t.messageUnreadCount)&&this.attributes.threadCollection.update(t.id,{isRead:!0,messageUnreadCount:0}))).toPromise()}muteChatToggle(){k.a(this.attributes.threadIdentifier.isFake).pipe(Object(R.a)(this.attributes.thread$),Object(L.a)(([e,t])=>!e&&this.attributes.threadCollection.update(t.id,{isMuted:!t.isMuted}).then(e=>{"success"!==e.status&&(this.error={code:e.errorCode,operation:"mute-chat"})}))).toPromise()}blockChatToggle(){k.a(this.attributes.threadIdentifier.isFake).pipe(Object(R.a)(this.attributes.thread$),Object(L.a)(([e,t])=>!e&&this.attributes.threadCollection.update(t.id,{isBlocked:!t.isBlocked}).then(e=>{"success"!==e.status&&(this.error={code:e.errorCode,operation:"block-chat"})}))).toPromise()}archiveChatToggle(){k.a(this.attributes.threadIdentifier.isFake).pipe(Object(R.a)(this.attributes.thread$),Object(L.a)(([e,t])=>!e&&this.attributes.threadCollection.update(t.id,{folder:t.folder===S.FolderApi.INBOX?S.FolderApi.ARCHIVED:S.FolderApi.INBOX}).then(e=>{"success"!==e.status&&(this.error={code:e.errorCode,operation:"archive-chat"})}))).toPromise()}handleTypingEvent(e){this.markAsRead(),!this.attributes.threadIdentifier.isFake&&Date.now()>this.lastSentTyping+5e3&&(this.lastSentTyping=Date.now(),this.attributes.threadCollection.update(this.attributes.threadIdentifier.id,{typing:!0})),this.threadIdentifierKey&&(e&&e.length>0?this.saveDraftMessage(this.threadIdentifierKey,e):this.clearDraftMessage(this.threadIdentifierKey))}clearThreadError(){this.error=void 0}modifyMembers(e){k.a(e).pipe(Object(R.a)(this.attributes.thread$,this.currentUserId$),Object(L.a)(([t,i,n])=>{if(i.isFake)return;const a="add"===t.action?[...i.members,...t.userIds]:i.members.filter(e=>!t.userIds.includes(e)),s=a.filter(e=>e!==Object(M.r)(n)),o="add"===t.action?i.inactiveMembers.filter(e=>!t.userIds.includes(e)):[...i.inactiveMembers,...t.userIds];return this.attributes.threadCollection.update(i.id,{inactiveMembers:o,members:a,otherMembers:s}).then(t=>{"success"===t.status&&"remove"===e.action&&e.userIds.includes(Object(M.r)(n))&&this.close()})})).toPromise()}handleUserRemoved(e){this.modifyMembers({action:"remove",userIds:[e.id]})}popManagementModal(){this.modalService.open("GroupchatManagementModal",{inputs:{bidders$:this.bidders$,contacts$:this.contacts$,collaborators$:this.collaborators$,isRecruiter$:this.isUserSupportAgent$,thread$:this.attributes.thread$,team$:this.team$},size:f.a.SMALL}).afterClosed().toPromise().then(e=>{e&&e instanceof Array&&e.length>0&&this.modifyMembers({action:"add",userIds:e})})}isCallSupportedBrowser(){const e=this.userAgent.getUserAgent(),{name:t}=e.getBrowser();return"Chrome"===t||"Firefox"===t}handleAddAttachment(e){this.fileUploadSession.addFile(e),this.focusChatbox()}handleRemoveAttachment(e){this.fileUploadSession.removeFile(e.name)}handleRemoveUpload(e){this.fileUploadSession.removeUpload(e)}handleLoadMessages(){this.currentLimit=Math.min(this.currentLimit+this.limitIncreaseStep,this.maxLimit),this.messagesLimitSubject$.next(this.currentLimit)}handleChatOptionsDrawerToggle(e){e?this.chatOptionsDrawer.open():this.chatOptionsDrawer.close()}saveDraftMessage(e,t){const i={text:t,lastUpdated:Date.now()};this.localStorage.get("webappChatDraftMessages").pipe(Object(U.a)(1)).toPromise().then((t={})=>Object(n.a)(this,void 0,void 0,function*(){if(e){const n=Object.assign(Object.assign({},t),{[e]:i});yield this.localStorage.set("webappChatDraftMessages",n)}}))}clearDraftMessage(e){this.localStorage.get("webappChatDraftMessages").pipe(Object(U.a)(1)).toPromise().then(t=>Object(n.a)(this,void 0,void 0,function*(){if(t&&e){const i=t,a=e,s=Object(n.d)(i,["symbol"==typeof a?a:a+""]);yield this.localStorage.set("webappChatDraftMessages",s)}}))}}return e.\u0275fac=function(t){return new(t||e)(a.Sb(s.c),a.Sb(F.a),a.Sb(X.a),a.Sb(Y.a),a.Sb(H.a),a.Sb(D.a),a.Sb(V.a),a.Sb(Q.b),a.Sb(W.a),a.Sb(q.a),a.Sb(K.a),a.Sb(Z.a))},e.\u0275cmp=a.Mb({type:e,selectors:[["app-chat-box"]],viewQuery:function(e,t){if(1&e&&(a.jd(J,1),a.jd(ee,1),a.jd(te,1)),2&e){let e;a.Mc(e=a.oc())&&(t.typingBox=e.first),a.Mc(e=a.oc())&&(t.onboardingOverlay=e.first),a.Mc(e=a.oc())&&(t.chatOptionsDrawer=e.first)}},hostVars:4,hostBindings:function(e,t){1&e&&a.nc("click",function(){return t.onClick()})("keydown",function(e){return t.escCloseChat(e)},!1,a.Oc),2&e&&a.Kb("IsChatboxMode",t.chatBoxMode)("IsMinimised",t.isMinimised)},inputs:{attributes:"attributes",inCall$:"inCall$",allContacts$:"allContacts$",currentUserIdValue:"currentUserIdValue",team$:"team$",chatBoxMode:"chatBoxMode"},outputs:{closeChat:"closeChat",minimiseChat:"minimiseChat",makingCall:"makingCall",emojiPickedSubject$:"emojiPickedSubject$",blurClick:"blurClick",focusClick:"focusClick"},features:[a.Eb],decls:13,vars:8,consts:function(){let e,t,i,n;return e="Chat Details",t="" + "\ufffd#2\ufffd" + "" + "\ufffd*3:1\ufffd\ufffd#1:1\ufffd" + " Unfortunately, you are not allowed to send a message to this thread. " + "[\ufffd/#1:1\ufffd\ufffd/*3:1\ufffd|\ufffd/#1:2\ufffd\ufffd/*4:2\ufffd|\ufffd/#1:3\ufffd\ufffd/*5:3\ufffd|\ufffd/#2\ufffd]" + "" + "\ufffd*4:2\ufffd\ufffd#1:2\ufffd" + " Please enter a message. " + "[\ufffd/#1:1\ufffd\ufffd/*3:1\ufffd|\ufffd/#1:2\ufffd\ufffd/*4:2\ufffd|\ufffd/#1:3\ufffd\ufffd/*5:3\ufffd|\ufffd/#2\ufffd]" + "" + "\ufffd*5:3\ufffd\ufffd#1:3\ufffd" + " Message sending failed. Please try again or " + "\ufffd#2:3\ufffd" + " contact support " + "\ufffd/#2:3\ufffd" + " if issue persists. " + "[\ufffd/#1:1\ufffd\ufffd/*3:1\ufffd|\ufffd/#1:2\ufffd\ufffd/*4:2\ufffd|\ufffd/#1:3\ufffd\ufffd/*5:3\ufffd|\ufffd/#2\ufffd]" + "" + "[\ufffd/#1:1\ufffd\ufffd/*3:1\ufffd|\ufffd/#1:2\ufffd\ufffd/*4:2\ufffd|\ufffd/#1:3\ufffd\ufffd/*5:3\ufffd|\ufffd/#2\ufffd]" + "",t=a.hc(t),i="" + "\ufffd#2\ufffd" + "" + "\ufffd*3:1\ufffd\ufffd#1:1\ufffd" + " Unfortunately, you are not allowed to perform the requested operation. " + "[\ufffd/#1:1\ufffd\ufffd/*3:1\ufffd|\ufffd/#1:2\ufffd\ufffd/*4:2\ufffd|\ufffd/#2\ufffd]" + "" + "\ufffd*4:2\ufffd\ufffd#1:2\ufffd" + " Attempting to perform requested operation failed. Please try again or " + "\ufffd#2:2\ufffd" + " contact support. " + "\ufffd/#2:2\ufffd" + "" + "[\ufffd/#1:1\ufffd\ufffd/*3:1\ufffd|\ufffd/#1:2\ufffd\ufffd/*4:2\ufffd|\ufffd/#2\ufffd]" + "" + "[\ufffd/#1:1\ufffd\ufffd/*3:1\ufffd|\ufffd/#1:2\ufffd\ufffd/*4:2\ufffd|\ufffd/#2\ufffd]" + "",i=a.hc(i),n=" You cannot chat with this user ",[[1,"ChatBox",3,"flTrackingSection"],["data-uitest-target","chatbox-header",3,"callsEnabled","isMinimised","thread","project","contest","agentSession","currentUserId","currentUser","otherMembers","onlineOfflineStatuses$","focusState","isThreadOwner","candidatesExist","team","isUserSupportAgent","supportAgentMembers","click","closeChat","handleSettingsHeaderClick","handleGroupchatHeaderClick","makingCall",4,"ngIf"],["class","ChatBox-inboxHeader","flTrackingSection","inboxheader",3,"emptyState","isOnline","contextBoxState","isGroupChatThread","otherMembers","flHideDesktop","chatOptionsDrawerToggle",4,"ngIf"],[1,"ChatBox-main"],[1,"ChatBox-content"],["class","ChatBox-fileSelect","data-uitest-target","chatbox-window",3,"multiple","active","onFileDropped",4,"ngIf"],[4,"ngIf"],["class","Inbox-sidebar",3,"candidatesExist","contextBoxState","currentUser","isRecruiter","isThreadOwner","onlineOfflineStatuses$","showReportCta","thread","threadId$","members","team","showAddPeopleOption","flHideTablet","flHideMobile","archiveChatToggle","blockChatToggle","muteChatToggle","userAdd","userRemove",4,"ngIf"],["mobileHeaderTitle",e],["chatOptionsDrawer",""],["drawerTemplate",""],["data-uitest-target","chatbox-header",3,"callsEnabled","isMinimised","thread","project","contest","agentSession","currentUserId","currentUser","otherMembers","onlineOfflineStatuses$","focusState","isThreadOwner","candidatesExist","team","isUserSupportAgent","supportAgentMembers","click","closeChat","handleSettingsHeaderClick","handleGroupchatHeaderClick","makingCall"],["flTrackingSection","inboxheader",1,"ChatBox-inboxHeader",3,"emptyState","isOnline","contextBoxState","isGroupChatThread","otherMembers","flHideDesktop","chatOptionsDrawerToggle"],["data-uitest-target","chatbox-window",1,"ChatBox-fileSelect",3,"multiple","active","onFileDropped"],[3,"currentUserId","usersTyping","members","messages","otherMembers","thread","chatBoxMode","canLoadMore","showLoadingMoreSpinner","useThumbnailService","previewModalClose","previewModalOpen","resendMessage","loadMoreMessages"],[3,"ngClass"],[3,"thread","attachments","uploads","removeAttachment","removeUpload"],[3,"ngSwitch",4,"ngIf"],["class","ChatBox-typingBox",3,"ngClass","isChatBoxMode","hasAttachments","thread","threadIdentifierKey","flMarginBottom","flSticky","flStickyBehaviour","flStickyPosition","sendMessage","typingEvent","focusTypingBox","addAttachment",4,"ngIf"],[3,"type","closeable","flMarginBottom",4,"ngIf"],[1,"ChatBox-context",3,"chatBoxMode","state"],[3,"ngSwitch"],[3,"close",4,"ngSwitchCase"],[3,"close",4,"ngSwitchDefault"],[3,"close"],t,[4,"ngSwitchCase"],[4,"ngSwitchDefault"],["flTrackingLabel","ChatSupportLink",3,"link"],i,[1,"ChatBox-typingBox",3,"ngClass","isChatBoxMode","hasAttachments","thread","threadIdentifierKey","flMarginBottom","flSticky","flStickyBehaviour","flStickyPosition","sendMessage","typingEvent","focusTypingBox","addAttachment"],["typingBox",""],[3,"type","closeable","flMarginBottom"],n,[3,"hourlyContracts","thread","otherMembers","project","closeOverlay",4,"ngIf"],[3,"participants","isThreadOwner","isRecruiter","candidatesExist","currentUser","candidateBidders","candidateContacts","candidateCollaborators","onlineOfflineStatuses$","thread","team","showAddPeopleOption","hideGroupchatOverlay","modifyMembers",4,"ngIf"],[3,"showReportCta","thread","archiveChatToggle","blockChatToggle","muteChatToggle","hideSettingsOverlay",4,"ngIf"],[3,"hourlyContracts","thread","otherMembers","project","closeOverlay"],["onboardingOverlay",""],[3,"participants","isThreadOwner","isRecruiter","candidatesExist","currentUser","candidateBidders","candidateContacts","candidateCollaborators","onlineOfflineStatuses$","thread","team","showAddPeopleOption","hideGroupchatOverlay","modifyMembers"],[3,"showReportCta","thread","archiveChatToggle","blockChatToggle","muteChatToggle","hideSettingsOverlay"],[1,"Inbox-sidebar",3,"candidatesExist","contextBoxState","currentUser","isRecruiter","isThreadOwner","onlineOfflineStatuses$","showReportCta","thread","threadId$","members","team","showAddPeopleOption","flHideTablet","flHideMobile","archiveChatToggle","blockChatToggle","muteChatToggle","userAdd","userRemove"],["class","Inbox-chatOptions",3,"candidatesExist","contextBoxState","currentUser","isRecruiter","isThreadOwner","onlineOfflineStatuses$","showReportCta","thread","threadId$","members","team","showAddPeopleOption","archiveChatToggle","blockChatToggle","muteChatToggle","userAdd","userRemove",4,"ngIf"],[1,"Inbox-chatOptions",3,"candidatesExist","contextBoxState","currentUser","isRecruiter","isThreadOwner","onlineOfflineStatuses$","showReportCta","thread","threadId$","members","team","showAddPeopleOption","archiveChatToggle","blockChatToggle","muteChatToggle","userAdd","userRemove"]]},template:function(e,t){1&e&&(a.Yb(0,"fl-bit",0),a.ad(1,ie,14,42,"app-header",1),a.ad(2,ne,5,14,"app-messaging-inbox-header",2),a.Yb(3,"fl-bit",3),a.Yb(4,"fl-bit",4),a.ad(5,Ce,23,52,"fl-file-select",5),a.sc(6,"flAsync"),a.ad(7,ye,7,9,"ng-container",6),a.Xb(),a.ad(8,Te,11,34,"app-messaging-sidebar",7),a.Yb(9,"fl-drawer",8,9),a.ad(11,Oe,1,1,"ng-template",null,10,a.bd),a.Xb(),a.Xb(),a.Xb()),2&e&&(a.Ac("flTrackingSection",t.chatBoxMode?"chatbox":"inbox"),a.Gb(1),a.zc("ngIf",t.chatBoxMode),a.Gb(1),a.zc("ngIf",!t.chatBoxMode),a.Gb(3),a.zc("ngIf",!t.activeOverlay&&!a.tc(6,6,t.showOnboardingOverlay$)),a.Gb(2),a.zc("ngIf",t.chatBoxMode),a.Gb(1),a.zc("ngIf",!t.chatBoxMode))},styles:["[_nghost-%COMP%]{display:flex;height:100%;position:relative}.IsMinimised[_nghost-%COMP%]{bottom:-344px;height:380px!important;width:260px!important}.IsChatboxMode[_nghost-%COMP%]{border-left:2px solid transparent;border-top:2px solid transparent;height:380px;margin-right:8px;width:260px}.IsChatboxMode[_nghost-%COMP%]   .ChatBox-main[_ngcontent-%COMP%]{flex:1 1 100%;flex-direction:column}.IsChatboxMode[_nghost-%COMP%]   .ChatBox-content[_ngcontent-%COMP%]{flex:1 0 100%}[hidden][_ngcontent-%COMP%]{display:none!important}.ChatBox[_ngcontent-%COMP%]{background:#fff;border-radius:0 0 0 0;display:flex;flex-direction:column;width:100%}.ChatBox-context[_ngcontent-%COMP%]{align-items:center;background:#f7f7f7;border-bottom:1px solid #dedede;display:flex;flex:0 0 40px;height:40px;justify-content:space-between;padding:8px;width:100%}.ChatBox-main[_ngcontent-%COMP%]{display:flex;flex:1;max-height:100%;width:100%}.ChatBox-content[_ngcontent-%COMP%], .ChatBox-inboxHeader[_ngcontent-%COMP%]{border-left:1px solid #dedede}.ChatBox-content[_ngcontent-%COMP%]{border-right:1px solid #dedede;display:flex;flex:1 1 100%;flex-direction:column;width:100%}.ChatBox-fileSelect[_ngcontent-%COMP%]{flex:1 0 100%}.ChatBox-typingBox[_ngcontent-%COMP%]{display:block;min-width:100%}@media (min-width:768px){.ChatBox-typingBox[_ngcontent-%COMP%]{min-width:unset}}.Inbox-sidebar[_ngcontent-%COMP%]{flex:1 0 300px;max-width:30%;position:relative}.Inbox-chatOptions[_ngcontent-%COMP%]{min-height:calc(100vh - 86px);position:relative}.Inbox-wrapper[_ngcontent-%COMP%]{margin:0 auto;width:100%}@media (min-width:768px){.Inbox-wrapper[_ngcontent-%COMP%]{min-width:440px;width:75%}}.Inbox-typingBox[_ngcontent-%COMP%]{background:#fff;border-radius:0;box-shadow:0 0 4px 0 rgba(0,0,0,.08),0 2px 4px 0 rgba(0,0,0,.12)}@media (min-width:768px){.Inbox-typingBox[_ngcontent-%COMP%]{border:1px solid #dedede}}"],changeDetection:0}),e})()},sGoS:function(e,t,i){"use strict";i.d(t,"a",function(){return r}),i.d(t,"b",function(){return c});var n=i("OpNG"),a=i("cUs2"),s=i("f6cb"),o=i("n0rP");function r(){return{defaultOrder:{field:"createTime",direction:n.a.DESC},fetch:(e,t,i,n)=>({endpoint:"support/0.1/agent_sessions/",isGaf:!1,params:c(t,i,n)}),push:void 0,set:void 0,update:(e,t,i)=>{if(Object(s.m)(t.agentId)&&i.state===o.AgentSessionStateApi.UNASSIGNED)return{endpoint:`support/0.1/agent_sessions/${i.id}/assign`,method:"POST",payload:{agent_id:t.agentId}};if(t.resolvedReason&&"string"==typeof t.resolvedReason.description&&i.state!==o.AgentSessionStateApi.RESOLVED)return{endpoint:`support/0.1/agent_sessions/${i.id}/resolve`,method:"POST",payload:{resolve_description:t.resolvedReason.description}};if(!1===t.starred)return{endpoint:`support/0.1/agent_sessions/${i.id}/unstar`,method:"POST",payload:{}};if(!0===t.starred)return{endpoint:`support/0.1/agent_sessions/${i.id}/star`,method:"POST",payload:{}};throw new Error(`Agent Sessions update not supported for delta ${t}`)},remove:void 0}}function c(e,t,i){return{agent_sessions:e,sessions:Object(a.h)(t,"sessionId"),agents:Object(a.h)(t,"agentId"),agent_session_states:Object(a.h)(t,"state"),starred:l(t,"starred"),latest:l(t,"latest"),source_type:Object(a.h)(t,"sessionSourceType")[0],sources:Object(a.h)(t,"sessionSourceId"),support_type:d(t),order_by:h(i),push:void 0,set:void 0,update:void 0,remove:void 0}}function l(e,t){return Object(a.h)(e,t,e=>{return"=="!==e.condition||"true"!==(t=e.value).toString()&&"false"!==t.toString()?void 0:e.value;var t})[0]}function d(e){return Object(a.h)(e,"type",e=>"=="===e.condition?e.value:void 0)[0]}function h(e){if(!e)return o.AgentSessionOrderByApi.AGENT_SESSION_CREATE_TIME_DSC;if(e.length>1)throw Error("Only single field orderings are supported by this collection");const t=e[0];if("createTime"===t.field&&t.direction===n.a.ASC)return o.AgentSessionOrderByApi.AGENT_SESSION_CREATE_TIME_ASC;if("createTime"===t.field&&t.direction===n.a.DESC)return o.AgentSessionOrderByApi.AGENT_SESSION_CREATE_TIME_DSC;if("sessionCreateTime"===t.field&&t.direction===n.a.ASC)return o.AgentSessionOrderByApi.SESSION_CREATE_TIME_ASC;if("sessionCreateTime"===t.field&&t.direction===n.a.DESC)return o.AgentSessionOrderByApi.SESSION_CREATE_TIME_DSC;throw Error(`Unexpected agent session ordering ${t.field}_${t.direction} given`)}},tbiQ:function(e,t,i){"use strict";i.d(t,"a",function(){return r}),i.d(t,"b",function(){return c});var n=i("SVse"),a=i("8Y7J"),s=i("CqXF"),o=i("90vB"),r=function(e){return e.AUDIO="Audio",e.VIDEO="Video",e.NONE="NoCall",e}({});let c=(()=>{class e{constructor(e,t){this.platformId=e,this.freelancerHttp=t}notifyAction(e,t){return this.freelancerHttp.put(`messages/0.1/videochat/${t}?action=${e}`,void 0).pipe(Object(s.a)(void 0)).toPromise()}openCallWindow({action:e,threadId:t,accepting:i,recorded:a=!1}){if(Object(n.E)(this.platformId))throw new Error("Cannot open videochat on page rendering. Please check code logic.");"NoCall"!==e&&window.open(`/users/messages/videochat.php?audioOnly=${"Audio"===e}&threadId=${t}&accepting=${i}&recorded=${a}`,"Freelancer Videochat",`width=${"Video"===e?880:400},height=575`)}}return e.\u0275fac=function(t){return new(t||e)(a.jc(a.D),a.jc(o.a))},e.\u0275prov=a.Ob({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},tlTr:function(e,t,i){"use strict";i.d(t,"a",function(){return n});var n=function(e){return e[e.Header=0]="Header",e[e.HeaderAndTypingBox=1]="HeaderAndTypingBox",e[e.Neither=2]="Neither",e}({})},u4EQ:function(e,t,i){"use strict";i.d(t,"a",function(){return s});var n=i("8Y7J"),a=i("wCWs");let s=(()=>{class e{constructor(e){this.assets=e,this.storageKey="sound_service_0.0.1",this.notificationWaitPeriod=1e3,this.millisecondsInADay=864e5,this.tabId=Date.now()+window.performance.now(),this.lastNotified=0,window.addEventListener("focus",e=>this.handleEvent(e)),window.addEventListener("unload",e=>this.handleEvent(e)),this.initialiseAsMaster(),this.messageSound=new Audio(this.assets.getUrl("sounds/message.mp3")),this.messageSound&&this.messageSound.load()}initialiseAsMaster(){const e=this.getState();e.master&&void 0!==e.master&&!document.hasFocus()||(e.master=this.tabId),e.registeredTabs=e.registeredTabs.filter(e=>e>this.tabId-this.millisecondsInADay),e.registeredTabs=[...e.registeredTabs,this.tabId],this.setState(e)}handleEvent(e){if("focus"===e.type){const e=this.getState();e.master=this.tabId,this.setState(e)}else if("unload"===e.type){const e=this.getState();e.registeredTabs=e.registeredTabs.filter(e=>e!==this.tabId),e.master===this.tabId&&(e.master=void 0),this.setState(e)}}handleNotification(e){const t=this.getState();void 0===t.master&&(t.master=this.tabId,this.setState(t)),this.lastNotified>Date.now()-this.notificationWaitPeriod||t.master!==this.tabId||"message"===e&&this.messageSound&&this.messageSound.play().then(()=>{this.lastNotified=Date.now()}).catch(e=>{console.warn(e)})}getState(){const e=localStorage.getItem(this.storageKey),t={master:void 0,registeredTabs:[]};try{return e?JSON.parse(e):t}catch(i){return t}}setState(e){localStorage&&localStorage.setItem(this.storageKey,JSON.stringify(e))}isAudioCapable(){return!!window.AudioContext||!!window.webkitAudioContext}}return e.\u0275fac=function(t){return new(t||e)(n.jc(a.a))},e.\u0275prov=n.Ob({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},v01h:function(e,t,i){"use strict";i.d(t,"a",function(){return b});var n=i("HsDr"),a=i("9Aot"),s=i("jASZ"),o=i("Rnop"),r=i("o9eT"),c=i("8Y7J"),l=i("w13q"),d=i("SVse");function h(e,t){if(1&e&&(c.Yb(0,"fl-bit",5),c.Tb(1,"fl-icon",6),c.Xb()),2&e){const e=c.rc();c.zc("flMarginRight",e.Margin.XXXSMALL),c.Gb(1),c.zc("name",e.icon)("color",e.IconColor.LIGHT)("size",e.IconSize.SMALL)}}function g(e,t){if(1&e&&c.Tb(0,"fl-spinner",7),2&e){const e=c.rc();c.zc("size",e.SpinnerSize.SMALL)("color",e.SpinnerColor.LIGHT)}}const u=function(e){return{"FloatingAction--withIcon":e}};let b=(()=>{class e{constructor(){this.FontColor=o.a,this.TextSize=r.f,this.FontWeight=r.c,this.IconColor=n.c,this.IconSize=n.e,this.Margin=a.a,this.TextTransform=r.g,this.SpinnerColor=s.b,this.SpinnerSize=s.d,this.role="button",this.ariaLive="assertive"}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=c.Mb({type:e,selectors:[["fl-floating-action"]],hostVars:3,hostBindings:function(e,t){2&e&&c.Hb("data-busy",t.busy)("role",t.role)("aria-live",t.ariaLive)},inputs:{icon:"icon",text:"text",busy:"busy"},decls:6,vars:11,consts:[[1,"FloatingAction",3,"ngClass"],[1,"FloatingAction-inner"],["class","FloatingAction-icon",3,"flMarginRight",4,"ngIf"],[1,"FloatingAction-text",3,"color","size","textTransform","weight"],["class","FloatingAction-spinner",3,"size","color",4,"ngIf"],[1,"FloatingAction-icon",3,"flMarginRight"],[3,"name","color","size"],[1,"FloatingAction-spinner",3,"size","color"]],template:function(e,t){1&e&&(c.Yb(0,"fl-bit",0),c.Yb(1,"fl-bit",1),c.ad(2,h,2,4,"fl-bit",2),c.Yb(3,"fl-text",3),c.cd(4),c.Xb(),c.Xb(),c.ad(5,g,1,2,"fl-spinner",4),c.Xb()),2&e&&(c.zc("ngClass",c.Ec(9,u,t.icon)),c.Hb("disabled",t.busy),c.Gb(2),c.zc("ngIf",t.icon),c.Gb(1),c.zc("color",t.FontColor.LIGHT)("size",t.TextSize.XXXSMALL)("textTransform",t.TextTransform.UPPERCASE)("weight",t.FontWeight.BOLD),c.Gb(1),c.ed(" ",t.text," "),c.Gb(1),c.zc("ngIf",t.busy))},directives:[l.a,d.o,d.q,r.e,a.b,n.d,s.c],styles:["[_nghost-%COMP%]{left:50%;position:absolute;transform:translateX(-50%);bottom:24px}[data-busy=true][_nghost-%COMP%]{pointer-events:none}[data-busy=true][_nghost-%COMP%]   .FloatingAction[_ngcontent-%COMP%]{max-width:32px;padding:0 4px;transform:translateY(-2px)}[data-busy=true][_nghost-%COMP%]   .FloatingAction-inner[_ngcontent-%COMP%]{opacity:0;visibility:hidden}.FloatingAction[_ngcontent-%COMP%]{background-color:#164188;border:0;border-radius:16px;box-shadow:0 0 6px 0 rgba(0,0,0,.12),0 4px 10px 0 rgba(0,0,0,.16);cursor:pointer;display:flex;font-family:inherit;height:32px;line-height:0;max-width:500px;padding:0 24px;position:relative;transition:box-shadow .3s ease-in-out,transform .3s ease-in-out,padding .5s linear,max-width .5s ease}.FloatingAction[_ngcontent-%COMP%]:focus{outline:none}.FloatingAction[_ngcontent-%COMP%]:hover{box-shadow:0 0 8px 0 rgba(0,0,0,.16),0 10px 18px 0 rgba(0,0,0,.2);transform:translateY(-2px)}.FloatingAction-inner[_ngcontent-%COMP%]{align-items:center;display:flex;justify-content:center}.FloatingAction-text[_ngcontent-%COMP%]{white-space:nowrap}.FloatingAction-spinner[_ngcontent-%COMP%]{left:50%;position:absolute;top:50%;transform:translate(-50%,-50%)}.FloatingAction--withIcon[_ngcontent-%COMP%]{padding-left:16px}"],changeDetection:0}),e})()},yotz:function(e,t,i){"use strict";i.d(t,"a",function(){return k}),i.d(t,"b",function(){return E});var n=i("SVse"),a=i("8Y7J"),s=i("XNiG"),o=i("VRyK"),r=i("EY2u"),c=i("HDdC"),l=(i("xgIS"),i("vkgz")),d=i("w1tV"),h=i("JX91"),g=i("lJxs"),u=i("eIep"),b=i("3UWI"),f=i("1G5W"),p=i("5+tZ"),m=i("IzEk"),C=i("Zy1z"),M=i("pLZG");const S="undefined"!=typeof window&&("ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0);function x(e,t,i=3){return Math.abs(e-t)<i}function y(e,t,i,n){const a={top:e.top,bottom:e.bottom,left:e.left,right:e.right};return t.top&&(a.top+=n),t.bottom&&(a.bottom+=n),t.left&&(a.left+=i),t.right&&(a.right+=i),a.height=a.bottom-a.top,a.width=a.right-a.left,a}function T({clientY:e,rect:t}){return e>=t.top&&e<=t.bottom}function I({clientX:e,rect:t}){return e>=t.left&&e<=t.right}function O({clientX:e,clientY:t,elm:i,allowedEdges:n,cursorPrecision:a}){const s=i.nativeElement.getBoundingClientRect(),o={};return n.left&&x(e,s.left,a)&&T({clientY:t,rect:s})&&(o.left=!0),n.right&&x(e,s.right,a)&&T({clientY:t,rect:s})&&(o.right=!0),n.top&&x(t,s.top,a)&&I({clientX:e,rect:s})&&(o.top=!0),n.bottom&&x(t,s.bottom,a)&&I({clientX:e,rect:s})&&(o.bottom=!0),o}const v=Object.freeze({topLeft:"nw-resize",topRight:"ne-resize",bottomLeft:"sw-resize",bottomRight:"se-resize",leftOrRight:"col-resize",topOrBottom:"row-resize"});function A(e,t){return e.left&&e.top?t.topLeft:e.right&&e.top?t.topRight:e.left&&e.bottom?t.bottomLeft:e.right&&e.bottom?t.bottomRight:e.left||e.right?t.leftOrRight:e.top||e.bottom?t.topOrBottom:""}function w({edges:e,initialRectangle:t,newRectangle:i}){const n={};return Object.keys(e).forEach(e=>{n[e]=(i[e]||0)-(t[e]||0)}),n}let k=(()=>{class e{constructor(e,t,i,n){this.platformId=e,this.renderer=t,this.elm=i,this.zone=n,this.resizeEdges={},this.enableGhostResize=!1,this.resizeSnapGrid={},this.resizeCursors=v,this.resizeCursorPrecision=3,this.ghostElementPositioning="fixed",this.allowNegativeResizes=!1,this.mouseMoveThrottleMS=50,this.resizeStart=new a.n,this.resizing=new a.n,this.resizeEnd=new a.n,this.mouseup=new s.a,this.mousedown=new s.a,this.mousemove=new s.a,this.destroy$=new s.a,this.resizeEdges$=new s.a,this.pointerEventListeners=z.getInstance(t,n)}ngOnInit(){const e=Object(o.a)(this.pointerEventListeners.pointerDown,this.mousedown),t=Object(o.a)(this.pointerEventListeners.pointerMove,this.mousemove).pipe(Object(l.a)(({event:e})=>{n&&e.preventDefault()}),Object(d.a)()),i=Object(o.a)(this.pointerEventListeners.pointerUp,this.mouseup);let n;const a=()=>{n&&n.clonedNode&&(this.elm.nativeElement.parentElement.removeChild(n.clonedNode),this.renderer.setStyle(this.elm.nativeElement,"visibility","inherit"))},s=()=>Object.assign({},v,this.resizeCursors);this.resizeEdges$.pipe(Object(h.a)(this.resizeEdges),Object(g.a)(()=>this.resizeEdges&&Object.keys(this.resizeEdges).some(e=>!!this.resizeEdges[e])),Object(u.a)(e=>e?t:r.a),Object(b.a)(this.mouseMoveThrottleMS),Object(f.a)(this.destroy$)).subscribe(({clientX:e,clientY:t})=>{const i=O({clientX:e,clientY:t,elm:this.elm,allowedEdges:this.resizeEdges,cursorPrecision:this.resizeCursorPrecision}),a=s();if(!n){const e=A(i,a);this.renderer.setStyle(this.elm.nativeElement,"cursor",e)}this.setElementClass(this.elm,"resize-left-hover",!0===i.left),this.setElementClass(this.elm,"resize-right-hover",!0===i.right),this.setElementClass(this.elm,"resize-top-hover",!0===i.top),this.setElementClass(this.elm,"resize-bottom-hover",!0===i.bottom)}),e.pipe(Object(p.b)(a=>{function s(e){return{clientX:e.clientX-a.clientX,clientY:e.clientY-a.clientY}}const r=()=>{const e={x:1,y:1};return n&&(this.resizeSnapGrid.left&&n.edges.left?e.x=+this.resizeSnapGrid.left:this.resizeSnapGrid.right&&n.edges.right&&(e.x=+this.resizeSnapGrid.right),this.resizeSnapGrid.top&&n.edges.top?e.y=+this.resizeSnapGrid.top:this.resizeSnapGrid.bottom&&n.edges.bottom&&(e.y=+this.resizeSnapGrid.bottom)),e};function c(e,t){return{x:Math.ceil(e.clientX/t.x),y:Math.ceil(e.clientY/t.y)}}return Object(o.a)(t.pipe(Object(m.a)(1)).pipe(Object(g.a)(e=>[,e])),t.pipe(Object(C.a)())).pipe(Object(g.a)(([e,t])=>[e?s(e):e,s(t)])).pipe(Object(M.a)(([e,t])=>{if(!e)return!0;const i=r(),n=c(e,i),a=c(t,i);return n.x!==a.x||n.y!==a.y})).pipe(Object(g.a)(([,e])=>{const t=r();return{clientX:Math.round(e.clientX/t.x)*t.x,clientY:Math.round(e.clientY/t.y)*t.y}})).pipe(Object(f.a)(Object(o.a)(i,e)))})).pipe(Object(M.a)(()=>!!n)).pipe(Object(g.a)(({clientX:e,clientY:t})=>y(n.startingRect,n.edges,e,t))).pipe(Object(M.a)(e=>this.allowNegativeResizes||!!(e.height&&e.width&&e.height>0&&e.width>0))).pipe(Object(M.a)(e=>!this.validateResize||this.validateResize({rectangle:e,edges:w({edges:n.edges,initialRectangle:n.startingRect,newRectangle:e})})),Object(f.a)(this.destroy$)).subscribe(e=>{n&&n.clonedNode&&(this.renderer.setStyle(n.clonedNode,"height",`${e.height}px`),this.renderer.setStyle(n.clonedNode,"width",`${e.width}px`),this.renderer.setStyle(n.clonedNode,"top",`${e.top}px`),this.renderer.setStyle(n.clonedNode,"left",`${e.left}px`)),this.resizing.observers.length>0&&this.zone.run(()=>{this.resizing.emit({edges:w({edges:n.edges,initialRectangle:n.startingRect,newRectangle:e}),rectangle:e})}),n.currentRect=e}),e.pipe(Object(g.a)(({clientX:e,clientY:t,edges:i})=>i||O({clientX:e,clientY:t,elm:this.elm,allowedEdges:this.resizeEdges,cursorPrecision:this.resizeCursorPrecision}))).pipe(Object(M.a)(e=>Object.keys(e).length>0),Object(f.a)(this.destroy$)).subscribe(e=>{n&&a();const t=function(e,t){let i=0,n=0;const a=e.nativeElement.style,s=["transform","-ms-transform","-moz-transform","-o-transform"].map(e=>a[e]).find(e=>!!e);if(s&&s.includes("translate")&&(i=s.replace(/.*translate3?d?\((-?[0-9]*)px, (-?[0-9]*)px.*/,"$1"),n=s.replace(/.*translate3?d?\((-?[0-9]*)px, (-?[0-9]*)px.*/,"$2")),"absolute"===t)return{height:e.nativeElement.offsetHeight,width:e.nativeElement.offsetWidth,top:e.nativeElement.offsetTop-n,bottom:e.nativeElement.offsetHeight+e.nativeElement.offsetTop-n,left:e.nativeElement.offsetLeft-i,right:e.nativeElement.offsetWidth+e.nativeElement.offsetLeft-i};{const t=e.nativeElement.getBoundingClientRect();return{height:t.height,width:t.width,top:t.top-n,bottom:t.bottom-n,left:t.left-i,right:t.right-i,scrollTop:e.nativeElement.scrollTop,scrollLeft:e.nativeElement.scrollLeft}}}(this.elm,this.ghostElementPositioning);n={edges:e,startingRect:t,currentRect:t};const i=s(),o=A(n.edges,i);this.renderer.setStyle(document.body,"cursor",o),this.setElementClass(this.elm,"resize-active",!0),this.enableGhostResize&&(n.clonedNode=this.elm.nativeElement.cloneNode(!0),this.elm.nativeElement.parentElement.appendChild(n.clonedNode),this.renderer.setStyle(this.elm.nativeElement,"visibility","hidden"),this.renderer.setStyle(n.clonedNode,"position",this.ghostElementPositioning),this.renderer.setStyle(n.clonedNode,"left",`${n.startingRect.left}px`),this.renderer.setStyle(n.clonedNode,"top",`${n.startingRect.top}px`),this.renderer.setStyle(n.clonedNode,"height",`${n.startingRect.height}px`),this.renderer.setStyle(n.clonedNode,"width",`${n.startingRect.width}px`),this.renderer.setStyle(n.clonedNode,"cursor",A(n.edges,i)),this.renderer.addClass(n.clonedNode,"resize-ghost-element"),n.clonedNode.scrollTop=n.startingRect.scrollTop,n.clonedNode.scrollLeft=n.startingRect.scrollLeft),this.resizeStart.observers.length>0&&this.zone.run(()=>{this.resizeStart.emit({edges:w({edges:e,initialRectangle:t,newRectangle:t}),rectangle:y(t,{},0,0)})})}),i.pipe(Object(f.a)(this.destroy$)).subscribe(()=>{n&&(this.renderer.removeClass(this.elm.nativeElement,"resize-active"),this.renderer.setStyle(document.body,"cursor",""),this.renderer.setStyle(this.elm.nativeElement,"cursor",""),this.resizeEnd.observers.length>0&&this.zone.run(()=>{this.resizeEnd.emit({edges:w({edges:n.edges,initialRectangle:n.startingRect,newRectangle:n.currentRect}),rectangle:n.currentRect})}),a(),n=null)})}ngOnChanges(e){e.resizeEdges&&this.resizeEdges$.next(this.resizeEdges)}ngOnDestroy(){Object(n.D)(this.platformId)&&this.renderer.setStyle(document.body,"cursor",""),this.mousedown.complete(),this.mouseup.complete(),this.mousemove.complete(),this.resizeEdges$.complete(),this.destroy$.next()}setElementClass(e,t,i){i?this.renderer.addClass(e.nativeElement,t):this.renderer.removeClass(e.nativeElement,t)}}return e.\u0275fac=function(t){return new(t||e)(a.Sb(a.D),a.Sb(a.G),a.Sb(a.l),a.Sb(a.B))},e.\u0275dir=a.Nb({type:e,selectors:[["","mwlResizable",""]],inputs:{resizeEdges:"resizeEdges",enableGhostResize:"enableGhostResize",resizeSnapGrid:"resizeSnapGrid",resizeCursors:"resizeCursors",resizeCursorPrecision:"resizeCursorPrecision",ghostElementPositioning:"ghostElementPositioning",allowNegativeResizes:"allowNegativeResizes",mouseMoveThrottleMS:"mouseMoveThrottleMS",validateResize:"validateResize"},outputs:{resizeStart:"resizeStart",resizing:"resizing",resizeEnd:"resizeEnd"},features:[a.Eb]}),e})();class z{static getInstance(e,t){return z.instance||(z.instance=new z(e,t)),z.instance}constructor(e,t){this.pointerDown=new c.a(i=>{let n,a;return t.runOutsideAngular(()=>{n=e.listen("document","mousedown",e=>{i.next({clientX:e.clientX,clientY:e.clientY,event:e})}),S&&(a=e.listen("document","touchstart",e=>{i.next({clientX:e.touches[0].clientX,clientY:e.touches[0].clientY,event:e})}))}),()=>{n(),S&&a()}}).pipe(Object(d.a)()),this.pointerMove=new c.a(i=>{let n,a;return t.runOutsideAngular(()=>{n=e.listen("document","mousemove",e=>{i.next({clientX:e.clientX,clientY:e.clientY,event:e})}),S&&(a=e.listen("document","touchmove",e=>{i.next({clientX:e.targetTouches[0].clientX,clientY:e.targetTouches[0].clientY,event:e})}))}),()=>{n(),S&&a()}}).pipe(Object(d.a)()),this.pointerUp=new c.a(i=>{let n,a,s;return t.runOutsideAngular(()=>{n=e.listen("document","mouseup",e=>{i.next({clientX:e.clientX,clientY:e.clientY,event:e})}),S&&(a=e.listen("document","touchend",e=>{i.next({clientX:e.changedTouches[0].clientX,clientY:e.changedTouches[0].clientY,event:e})}),s=e.listen("document","touchcancel",e=>{i.next({clientX:e.changedTouches[0].clientX,clientY:e.changedTouches[0].clientY,event:e})}))}),()=>{n(),S&&(a(),s())}}).pipe(Object(d.a)())}}let E=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=a.Qb({type:e}),e.\u0275inj=a.Pb({}),e})()},yvyY:function(e,t,i){"use strict";i.d(t,"b",function(){return r}),i.d(t,"a",function(){return c});var n=i("f3kX"),a=i("8Y7J"),s=i("AvnH"),o=i("HeVh"),r=function(e){return e.MOBILE_ONLY="mobile_only",e.SHOW_ALL="show_all",e}({});let c=(()=>{class e{constructor(e,t,i,n){this.viewContainerRef=e,this.templateRef=t,this.viewHeaderTemplate=i,this.breakpointObserver=n,this.flViewHeaderTemplateFullReplacement=!1}get flViewHeaderTemplate(){return this._flViewHeaderTemplate}set flViewHeaderTemplate(e){this._flViewHeaderTemplate=""===e?r.MOBILE_ONLY:e}ngOnInit(){this.config={fullReplacement:this.flViewHeaderTemplateFullReplacement,templateRef:this.templateRef};const e=this.viewContainerRef.createEmbeddedView(this.templateRef);this.mobileRegistrationSubscription=this.breakpointObserver.observe(n.a.TABLET).subscribe(t=>{this.viewContainerRef.detach(),this.viewHeaderTemplate.deregisterHeader(this.config),t.matches&&this.flViewHeaderTemplate===r.SHOW_ALL?this.viewContainerRef.insert(e):this.viewHeaderTemplate.registerHeader(this.config)})}ngOnDestroy(){this.config&&this.viewHeaderTemplate.deregisterHeader(this.config),this.mobileRegistrationSubscription&&this.mobileRegistrationSubscription.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(a.Sb(a.U),a.Sb(a.P),a.Sb(s.a),a.Sb(o.a))},e.\u0275dir=a.Nb({type:e,selectors:[["","flViewHeaderTemplate",""]],inputs:{flViewHeaderTemplate:"flViewHeaderTemplate",flViewHeaderTemplateFullReplacement:"flViewHeaderTemplateFullReplacement"}}),e})()}}]);
//# sourceMappingURL=default~app-app-shell-logged-in-routing-module~app-messaging-messaging-chat-groupchat-management-mod~39785f8e-es2015.e5a18e3c0d70c53940be.js.map